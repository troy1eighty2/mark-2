/*! For license information please see bg.js.LICENSE.txt */
var source;(()=>{var e,t,n={80614:(e,t)=>{(()=>{var e={"./src/MessagingSDK.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{AppType:()=>b,INSTALLATION_ID_LOCAL_STORAGE_KEY:()=>E,MessagingSDK:()=>_});var r=n("./node_modules/uuid/dist/esm-browser/v4.js"),i=n("./node_modules/throttle-debounce/esm/index.js"),s=n("./node_modules/ua-parser-js/src/ua-parser.js"),o=n("./src/utils.ts"),a=n("./src/Store.ts"),c=["server_session_id"];function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function f(){f=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var s=t&&t.prototype instanceof g?t:g,o=Object.create(s.prototype),a=new k(i||[]);return r(o,"_invoke",{value:E(e,n,a)}),o}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var h={};function g(){}function p(){}function m(){}var v={};c(v,s,(function(){return this}));var y=Object.getPrototypeOf,b=y&&y(y(C([])));b&&b!==t&&n.call(b,s)&&(v=b);var w=m.prototype=g.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function i(r,s,o,a){var c=d(e[r],e,s);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==u(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){i("next",e,o,a)}),(function(e){i("throw",e,o,a)})):t.resolve(h).then((function(e){l.value=e,o(l)}),(function(e){return i("throw",e,o,a)}))}a(c.arg)}var s;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return s=s?s.then(r,r):r()}})}function E(e,t,n){var r="suspendedStart";return function(i,s){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw s;return I()}for(n.method=i,n.arg=s;;){var o=n.delegate;if(o){var a=S(o,n);if(a){if(a===h)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function S(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,h;var s=i.arg;return s?s.done?(t[e.resultName]=s.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):s:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function C(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:I}}function I(){return{value:void 0,done:!0}}return p.prototype=m,r(w,"constructor",{value:m,configurable:!0}),r(m,"constructor",{value:p,configurable:!0}),p.displayName=c(m,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,c(e,a,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},A(x.prototype),c(x.prototype,o,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,r,i,s){void 0===s&&(s=Promise);var o=new x(l(t,n,r,i),s);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},A(w),c(w,a,"Generator"),c(w,s,(function(){return this})),c(w,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=C,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var a=n.call(s,"catchLoc"),c=n.call(s,"finallyLoc");if(a&&c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),_(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;_(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:C(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},e}function g(e,t,n,r,i,s,o){try{var a=e[s](o),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,i)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var s=e.apply(t,n);function o(e){g(s,r,i,o,a,"next",e)}function a(e){g(s,r,i,o,a,"throw",e)}o(void 0)}))}}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,y(r.key),r)}}function v(e,t,n){return(t=y(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e){var t=function(e,t){if("object"!==u(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===u(t)?t:String(t)}var b=function(e){return e.Web="WEB",e.Extension="BROWSER_EXTENSION",e.Lib="LIB",e}({}),w=[408,429,500,502,503,504,507],A="messaging-sdk",x="msgError",E="RAKUTEN_INSTALLATION_ID",S="{regionId}";function T(e){return e.startsWith(A)}var _=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),v(this,"config",void 0),v(this,"member",void 0),v(this,"timer",void 0),v(this,"uaParser",void 0),v(this,"isFlushInProgress",void 0),v(this,"isRetrying",void 0),v(this,"isFlushingTempStore",void 0),v(this,"throttleFlush",void 0),v(this,"started",!1),v(this,"window",void 0),v(this,"serverSessionId",void 0),v(this,"store",void 0),v(this,"tempMessageStore",[]),v(this,"clientAgent",void 0),v(this,"isPrivateBrowserSession",void 0),v(this,"errorLogger",(function(e){var n,r,i,s,o,a,c,u;null!==(n=t.window)&&void 0!==n&&null!==(r=n.DD_LOGS)&&void 0!==r&&null!==(i=r.logger)&&void 0!==i&&i.error?null===(s=t.window)||void 0===s||null===(o=s.DD_LOGS)||void 0===o||null===(a=o.logger)||void 0===a||null===(c=a.error)||void 0===c||c.call(a,x,{error:e},e):null===(u=console)||void 0===u||u.error(x,e)})),this.store=new a.default("rakuten",A),this.sendMessagesToMessageGateway=this.sendMessagesToMessageGateway.bind(this),this.flush=this.flush.bind(this),this.throttleFlush=(0,i.throttle)(1e3,this.flush)}var t,n,u,l,g,y,_,k,C,I,P,M,D;return t=e,n=[{key:"init",value:(D=p(f().mark((function e(t){var n,r;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setConfig(t),this.clientAgent="".concat(this.config.hostApp.name,"/").concat(this.config.hostApp.version," (").concat(this.config.hostApp.type,") ").concat("messaging-sdk-js","/").concat("1.5.0"," (").concat(b.Lib,")"),this.window=(0,o.getWindow)(),this.uaParser=new s.UAParser(null===(n=this.window)||void 0===n||null===(r=n.navigator)||void 0===r?void 0:r.userAgent),e.next=6,(0,o.detectPrivateBrowserSession)();case 6:return this.isPrivateBrowserSession=e.sent,this.started=!0,e.next=10,this.flushTempStore();case 10:this.throttleFlush(),this.restartTimer();case 12:case"end":return e.stop()}}),e,this)}))),function(e){return D.apply(this,arguments)})},{key:"setRegion",value:function(e){this.config&&(this.config.regionId=e)}},{key:"setMember",value:function(e){if(e){var t=e.server_session_id,n=h(e,c);this.member=d({},n),this.serverSessionId=t}}},{key:"setConfig",value:function(e){if(!e)throw new Error("Config missing when initializing MessagingSdk. Please `messagingSdkInstance.init(config)` with a valid Config");if(!e.invalidMessagesHandler)throw new Error("invalidMessagesHandler callback for rendering message failures must be supplied in the Config when `messagingSdkInstance.init(config)`");e.errorMessageLogger&&(this.errorLogger=e.errorMessageLogger),this.config=e}},{key:"apiUri",get:function(){var e,t=this.config,n=t.regionId,r=t.networkConfig,i=r[n].messageGatewayBaseURL,s=r.genericRegionApiPath;return e=null!=s&&s.includes(S)?s.replace(S,n):"/message/v2/regions/{regionId}/messages/batch".replace(S,n),"".concat(i).concat(e)}},{key:"getDefaultPageProperties",value:function(){var e,t,n,r=new URL(null!==(e=null===(t=this.window)||void 0===t?void 0:t.location.href)&&void 0!==e?e:""),i=(0,o.getParentPath)(r.pathname),s=(0,o.getSearchParams)(),a=Object.fromEntries(s);return{url:r.href,host:r.host,path:r.pathname,title:null===(n=document)||void 0===n?void 0:n.title,parent_path:i,query_params:a}}},{key:"createMessage",value:function(e){var t,n,i=(0,r.default)(),s=null!==(t=e.visit_id)&&void 0!==t?t:this.getVisitID(),o=this.member,a=e.serverContext,c=this.started?this.getClientContext(e):null,u=e.schema_id,l=e.type,h=e.data,f=e.parentMessageId,g=Intl.DateTimeFormat().resolvedOptions().timeZone,p=(new Date).getTime(),m=null!==(n=null==e?void 0:e.sourceTimestampMillis)&&void 0!==n?n:p,v=this.started?this.config.hostApp:void 0,y=this.started?this.config.regionId:void 0;return s||this.errorLogger("Visit ID is not found"),d({id:i,visit_id:s,member:o,server_context:a,client_context:c,schema_id:u,type:l,data:h,parentMessageId:f,source_time_zone:g,source_created_at_millis:p,source_timestamp_millis:m,issuer:v,region_id:y},!this.started&&{partialMessage:e})}},{key:"getClientContext",value:function(e){var t,n,r,i,s={device:this.getDevice(),experiments:null==e?void 0:e.experiments,locale:null===(t=this.window)||void 0===t||null===(n=t.navigator)||void 0===n?void 0:n.language,server_session_id:null==this?void 0:this.serverSessionId,origin:this.getOrigin(e),referrer:null===(r=document)||void 0===r?void 0:r.referrer,installation_id:null!==(i=e.installation_id)&&void 0!==i?i:this.installationId};return(0,o.mergeWith)(s,e.clientContext)}},{key:"getOrigin",value:function(e){var t,n,r,i=this.config.hostApp,s=(0,o.getOS)(this.uaParser),a=null===(t=this.window)||void 0===t||null===(n=t.navigator)||void 0===n?void 0:n.userAgent,c=null!==(r=null==e?void 0:e.page)&&void 0!==r?r:{};return{app:i,os:s,user_agent:a,page:d(d({},this.getDefaultPageProperties()),{},{type:this.config.page_type},c),screen:null==e?void 0:e.screen,component:null==e?void 0:e.component,is_private_browsing_enabled:this.isPrivateBrowserSession}}},{key:"getDevice",value:function(){var e=this.uaParser.getDevice();return{model:e.model,manufacturer:e.vendor,form_factor:(0,o.getDeviceType)(e.type)}}},{key:"flushIfBatchSizeReached",value:(M=p(f().mark((function e(){var t;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCurrentValidMessageCount();case 2:t=e.sent,this.config&&t>=this.getBatchSize()&&this.started&&!this.isFlushingTempStore&&this.throttleFlush();case 4:case"end":return e.stop()}}),e,this)}))),function(){return M.apply(this,arguments)})},{key:"flushMessage",value:(P=p(f().mark((function e(t){var n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendMessagesToMessageGateway([t]);case 2:if(null==(n=e.sent)||!n.ok){e.next=11;break}return e.prev=4,e.next=7,this.removeMessagesFromStorageByKeys([t.id]);case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(4);case 11:this.restartTimer();case 12:case"end":return e.stop()}}),e,this,[[4,9]])}))),function(e){return P.apply(this,arguments)})},{key:"send",value:(I=p(f().mark((function e(t){var n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.createMessage(t),this.started)try{this.store.set((r=n.id,"".concat(A,"-").concat(r)),n),this.flushIfBatchSizeReached()}catch(e){this.flushMessage(n)}else this.tempMessageStore.push(n);case 2:case"end":return e.stop()}var r}),e,this)}))),function(e){return I.apply(this,arguments)})},{key:"sendMessagesToMessageGateway",value:(C=p(f().mark((function e(t){var n,r,i,s,a,c,u,l,d,h,g,p,m,v,y=this,b=arguments;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=b.length>1&&void 0!==b[1]?b[1]:0,e.prev=1,this.stopTimer(),e.next=5,(0,o.postData)(this.apiUri,{messages:t},this.clientAgent);case 5:if(i=e.sent,null===(r=i)||void 0===r||!r.ok){e.next=27;break}if(!(a=null===(s=i.headers.get("content-type"))||void 0===s?void 0:s.includes("application/json"))){e.next=25;break}if(e.prev=9,!a){e.next=16;break}return e.next=13,i.json();case 13:e.t0=e.sent,e.next=17;break;case 16:e.t0=null;case 17:u=e.t0,l=null===(c=u.data)||void 0===c?void 0:c.map((function(e){var n,r,i=t.find((function(t){return t.id===(null==e?void 0:e.message_id)}));return y.config.invalidMessagesHandler||null===(n=(r=y.config).invalidMessageHandler)||void 0===n||n.call(r,i,e),{message:i,messageValidationError:e}})),this.config.invalidMessagesHandler(l),e.next=25;break;case 22:e.prev=22,e.t1=e.catch(9),this.errorLogger(e.t1);case 25:e.next=38;break;case 27:if(p=null===(d=i)||void 0===d?void 0:d.status,m=null===(h=i)||void 0===h||null===(g=h.headers)||void 0===g?void 0:g.get("retry-after"),!(w.includes(p)&&n<10)){e.next=37;break}return this.isRetrying=!0,this.stopTimer(),v=m?parseInt(m,10):5,e.next=36,new Promise((function(e,r){setTimeout((function(){y.sendMessagesToMessageGateway(t,n+1).then((function(t){e(t)})).catch((function(e){return r(e)}))}),Math.pow(2,n)*v*1e3)}));case 36:i=e.sent;case 37:this.errorLogger(i);case 38:return e.abrupt("return",i);case 41:return e.prev=41,e.t2=e.catch(1),this.errorLogger(e.t2),e.abrupt("return",void 0);case 45:return e.prev=45,0===n&&(this.isRetrying=!1),e.finish(45);case 48:case"end":return e.stop()}}),e,this,[[1,41,45,48],[9,22]])}))),function(e){return C.apply(this,arguments)})},{key:"restartTimer",value:function(){var e=this;this.stopTimer(),this.timer=setInterval((function(){e.throttleFlush()}),this.regionNetworkConfig.lingerDuration)}},{key:"stopTimer",value:function(){this.timer&&clearInterval(this.timer)}},{key:"flushTempStore",value:(k=p(f().mark((function e(){var t,n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.tempMessageStore.length>0)){e.next=13;break}return this.isFlushingTempStore=!0,t=this.updateMessages(this.tempMessageStore),e.prev=3,e.next=6,this.sendMessagesToMessageGateway(t);case 6:null!=(n=e.sent)&&n.ok&&(this.tempMessageStore=[]),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(3);case 12:this.isFlushingTempStore=!1;case 13:case"end":return e.stop()}}),e,this,[[3,10]])}))),function(){return k.apply(this,arguments)})},{key:"flush",value:(_=p(f().mark((function e(){var t,n,r;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.started){e.next=21;break}if(this.isFlushInProgress||this.isRetrying){e.next=20;break}return this.isFlushInProgress=!0,e.next=6,this.flushTempStore();case 6:return e.next=8,this.getBatchedValidMessageKeys();case 8:if(!((t=e.sent).length>0)){e.next=20;break}return e.next=12,this.store.getMany(t);case 12:return n=e.sent,e.next=15,this.sendMessagesToMessageGateway(n);case 15:if(!(null!=(r=e.sent)&&r.ok||r&&!w.includes(r.status))){e.next=19;break}return e.next=19,this.removeMessagesFromStorageByKeys(t);case 19:this.restartTimer();case 20:this.isFlushInProgress=!1;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(0),this.errorLogger(e.t0);case 26:case"end":return e.stop()}}),e,this,[[0,23]])}))),function(){return _.apply(this,arguments)})},{key:"updateMessages",value:function(e){var t=this,n=[];return e.forEach((function(e){var r=d(d({},e),{},{issuer:t.config.hostApp,member:t.member,region_id:t.config.regionId});if(!r.client_context){var i=t.getClientContext(e.partialMessage);delete r.partialMessage,r.client_context=i}n.push(r)})),n}},{key:"removeMessagesFromStorageByKeys",value:function(e){return this.store.delMany(e)}},{key:"getCurrentValidMessages",value:(y=p(f().mark((function e(){var t,n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.store.keys();case 2:return t=e.sent,n=t.filter(T),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"getCurrentValidMessageCount",value:(g=p(f().mark((function e(){var t;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCurrentValidMessages();case 2:return t=e.sent,e.abrupt("return",t.length);case 4:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"getBatchSize",value:function(){var e;return null!==(e=this.regionNetworkConfig.batchSize)&&void 0!==e?e:25}},{key:"getBatchedValidMessageKeys",value:(l=p(f().mark((function e(){var t;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCurrentValidMessages();case 2:return t=e.sent,e.abrupt("return",t.slice(0,this.getBatchSize()));case 4:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"regionNetworkConfig",get:function(){return this.config.networkConfig[this.config.regionId]}},{key:"installationId",get:function(){if(!(0,o.isBrowser)())return null;try{var e=localStorage.getItem(E);if(e)return e;var t=(0,r.default)();return this.installationId=t,t}catch(e){return this.errorLogger(e),null}},set:function(e){if((0,o.isBrowser)())try{localStorage.setItem(E,e||"")}catch(e){this.errorLogger(e)}}},{key:"getVisitID",value:function(){if(!(0,o.isBrowser)())return null;try{return localStorage.getItem("RAKUTEN_VISIT_ID")}catch(e){return this.errorLogger(e),null}}}],n&&m(t.prototype,n),u&&m(t,u),Object.defineProperty(t,"prototype",{writable:!1}),e}();v(_,"pipeline","holistic")},"./src/Store.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c});var r=n("./node_modules/idb-keyval/dist/index.js"),i=n("./src/utils.ts");function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!==s(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===s(t)?t:String(t)}var c=function(){function e(t,n){var s,o,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s=this,c=void 0,(o=a(o="idbStore"))in s?Object.defineProperty(s,o,{value:c,enumerable:!0,configurable:!0,writable:!0}):s[o]=c;var u=(0,i.getWindow)();u&&"indexedDB"in u&&(this.idbStore=r.createStore(t,n))}var t,n,s;return t=e,(n=[{key:"set",value:function(e,t){return r.set(e,t,this.idbStore)}},{key:"values",value:function(){return r.values(this.idbStore)}},{key:"keys",value:function(){return r.keys(this.idbStore)}},{key:"getMany",value:function(e){return r.getMany(e,this.idbStore)}},{key:"delMany",value:function(e){return r.delMany(e,this.idbStore)}}])&&o(t.prototype,n),s&&o(t,s),Object.defineProperty(t,"prototype",{writable:!1}),e}()},"./src/utils.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{DeviceType:()=>d,detectPrivateBrowserSession:()=>A,getDeviceType:()=>b,getOS:()=>w,getParentPath:()=>f,getSearchParams:()=>v,getWindow:()=>y,isArray:()=>E,isBrowser:()=>h,isObject:()=>S,mergeWith:()=>_,postData:()=>p});var r=n("./node_modules/detectincognitojs/dist/detectIncognito.js");function i(){i=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},a=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function d(e,t,n,i){var s=t&&t.prototype instanceof g?t:g,o=Object.create(s.prototype),a=new k(i||[]);return r(o,"_invoke",{value:E(e,n,a)}),o}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=d;var f={};function g(){}function p(){}function m(){}var v={};l(v,a,(function(){return this}));var y=Object.getPrototypeOf,b=y&&y(y(C([])));b&&b!==t&&n.call(b,a)&&(v=b);var w=m.prototype=g.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function i(r,s,a,c){var u=h(e[r],e,s);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==o(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,a,c)}),(function(e){i("throw",e,a,c)})):t.resolve(d).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,c)}))}c(u.arg)}var s;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return s=s?s.then(r,r):r()}})}function E(e,t,n){var r="suspendedStart";return function(i,s){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw s;return I()}for(n.method=i,n.arg=s;;){var o=n.delegate;if(o){var a=S(o,n);if(a){if(a===f)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=h(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function S(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=h(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,f;var s=i.arg;return s?s.done?(t[e.resultName]=s.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):s:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function C(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:I}}function I(){return{value:void 0,done:!0}}return p.prototype=m,r(w,"constructor",{value:m,configurable:!0}),r(m,"constructor",{value:p,configurable:!0}),p.displayName=l(m,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,l(e,u,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},A(x.prototype),l(x.prototype,c,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,r,i,s){void 0===s&&(s=Promise);var o=new x(d(t,n,r,i),s);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},A(w),l(w,u,"Generator"),l(w,a,(function(){return this})),l(w,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=C,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var a=n.call(s,"catchLoc"),c=n.call(s,"finallyLoc");if(a&&c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),_(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;_(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:C(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},e}function s(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===o(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t,n,r,i,s,o){try{var a=e[s](o),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,i)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var s=e.apply(t,n);function o(e){a(s,r,i,o,c,"next",e)}function c(e){a(s,r,i,o,c,"throw",e)}o(void 0)}))}}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,s,o,a=[],c=!0,u=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=s.call(n)).done)&&(a.push(r.value),a.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return a}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var d=function(e){return e.Mobile="mobile",e.Desktop="desktop",e.Tablet="tablet",e}({});function h(){return"undefined"!=typeof window}function f(e){var t=function(e){return e.replace(/\/+$/,"").substring(0,e.lastIndexOf("/"))}(e),n=u(t.split("/"),2)[1];return n?"/".concat(n,"/"):void 0}function g(e){throw new Error("Parameter ".concat(e," is required"))}function p(){return m.apply(this,arguments)}function m(){return m=c(i().mark((function e(){var t,n,r,s,o,a,c,u,l,d=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=d.length,n=new Array(t),r=0;r<t;r++)n[r]=d[r];return s=n[0],o=void 0===s?g("url"):s,a=n[1],c=void 0===a?g("data"):a,u=n[2],l=void 0===u?g("clientAgent"):u,e.abrupt("return",fetch(o,{method:"POST",mode:"cors",referrerPolicy:"no-referrer",headers:{"Content-Type":"application/json","client-ts":(new Date).getTime().toString(),"client-agent":l},body:JSON.stringify(c)}));case 3:case"end":return e.stop()}}),e)}))),m.apply(this,arguments)}function v(){var e=new URL(decodeURIComponent(window.location.href));return new URLSearchParams(e.search)}function y(){return"undefined"!=typeof self?self:void 0}function b(e){return e===d.Mobile||e===d.Tablet?e:d.Desktop}function w(e){var t=e.getOS();return null==t||!t.name||null!=t&&t.version?t.name&&t.version?{name:t.name,version:t.version}:void 0:{name:t.name,version:"UNKNOWN"}}function A(){return x.apply(this,arguments)}function x(){return(x=c(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,r.detectIncognito)().then((function(e){return e.isPrivate}));case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}function E(e){return Array.isArray(e)}function S(e){var t=o(e);return null!=e&&("object"===t||"function"===t)&&!E(e)}function T(e,t){if(null==t)return e;for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];if(void 0!==t[i]&&"__proto__"!==i)if(!S(e[i])&&S(t[i]))Object.assign(e,s({},i,t[i]));else if(e[i]&&S(t[i]))T(e[i],t[i]);else if(Array.isArray(t[i])&&Array.isArray(e[i]))for(var o=0;o<t[i].length;o++)S(e[i][o])&&S(t[i][o])?T(e[i][o],t[i][o]):e[i][o]=t[i][o];else Object.assign(e,s({},i,t[i]))}return e}function _(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=0,s=n;i<s.length;i++){T(e,s[i])}return e}},"./node_modules/detectincognitojs/dist/detectIncognito.js":(e,t)=>{"use strict";t.__esModule=!0,t.detectIncognito=void 0;t.detectIncognito=function(){return new Promise((function(e,t){var n,r,i="Unknown";function s(t){e({isPrivate:t,browserName:i})}function o(e){return e===eval.toString().length}function a(){void 0!==navigator.maxTouchPoints?function(){var e=String(Math.random());try{window.indexedDB.open(e,1).onupgradeneeded=function(t){var n,r,i=null===(n=t.target)||void 0===n?void 0:n.result;try{i.createObjectStore("test",{autoIncrement:!0}).put(new Blob),s(!1)}catch(e){var o=e;return e instanceof Error&&(o=null!==(r=e.message)&&void 0!==r?r:e),s("string"==typeof o&&/BlobURLs are not yet supported/.test(o))}finally{i.close(),window.indexedDB.deleteDatabase(e)}}}catch(e){return s(!1)}}():function(){var e=window.openDatabase,t=window.localStorage;try{e(null,null,null,null)}catch(e){return s(!0)}try{t.setItem("test","1"),t.removeItem("test")}catch(e){return s(!0)}s(!1)}()}function c(){navigator.webkitTemporaryStorage.queryUsageAndQuota((function(e,t){var n;s(Math.round(t/1048576)<2*Math.round((void 0!==(n=window).performance&&void 0!==n.performance.memory&&void 0!==n.performance.memory.jsHeapSizeLimit?performance.memory.jsHeapSizeLimit:1073741824)/1048576))}),(function(e){t(new Error("detectIncognito somehow failed to query storage quota: "+e.message))}))}function u(){void 0!==self.Promise&&void 0!==self.Promise.allSettled?c():(0,window.webkitRequestFileSystem)(0,1,(function(){s(!1)}),(function(){s(!0)}))}void 0!==(r=navigator.vendor)&&0===r.indexOf("Apple")&&o(37)?(i="Safari",a()):function(){var e=navigator.vendor;return void 0!==e&&0===e.indexOf("Google")&&o(33)}()?(n=navigator.userAgent,i=n.match(/Chrome/)?void 0!==navigator.brave?"Brave":n.match(/Edg/)?"Edge":n.match(/OPR/)?"Opera":"Chrome":"Chromium",u()):void 0!==document.documentElement&&void 0!==document.documentElement.style.MozAppearance&&o(37)?(i="Firefox",s(void 0===navigator.serviceWorker)):void 0!==navigator.msSaveBlob&&o(39)?(i="Internet Explorer",s(void 0===window.indexedDB)):t(new Error("detectIncognito cannot determine the browser"))}))}},"./node_modules/ua-parser-js/src/ua-parser.js":function(e,t,n){var r;!function(i,s){"use strict";var o="function",a="undefined",c="object",u="string",l="major",d="model",h="name",f="type",g="vendor",p="version",m="architecture",v="console",y="mobile",b="tablet",w="smarttv",A="wearable",x="embedded",E="Amazon",S="Apple",T="ASUS",_="BlackBerry",k="Browser",C="Chrome",I="Firefox",P="Google",M="Huawei",D="LG",R="Microsoft",L="Motorola",O="Opera",B="Samsung",N="Sharp",j="Sony",U="Xiaomi",F="Zebra",$="Facebook",q="Chromium OS",H="Mac OS",W=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toUpperCase()]=e[n];return t},G=function(e,t){return typeof e===u&&-1!==V(t).indexOf(V(e))},V=function(e){return e.toLowerCase()},z=function(e,t){if(typeof e===u)return e=e.replace(/^\s\s*/,""),typeof t===a?e:e.substring(0,350)},J=function(e,t){for(var n,r,i,a,u,l,d=0;d<t.length&&!u;){var h=t[d],f=t[d+1];for(n=r=0;n<h.length&&!u&&h[n];)if(u=h[n++].exec(e))for(i=0;i<f.length;i++)l=u[++r],typeof(a=f[i])===c&&a.length>0?2===a.length?typeof a[1]==o?this[a[0]]=a[1].call(this,l):this[a[0]]=a[1]:3===a.length?typeof a[1]!==o||a[1].exec&&a[1].test?this[a[0]]=l?l.replace(a[1],a[2]):s:this[a[0]]=l?a[1].call(this,l,a[2]):s:4===a.length&&(this[a[0]]=l?a[3].call(this,l.replace(a[1],a[2])):s):this[a]=l||s;d+=2}},K=function(e,t){for(var n in t)if(typeof t[n]===c&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(G(t[n][r],e))return"?"===n?s:n}else if(G(t[n],e))return"?"===n?s:n;return e},Y={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},X={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[p,[h,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[p,[h,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[h,p],[/opios[\/ ]+([\w\.]+)/i],[p,[h,O+" Mini"]],[/\bopr\/([\w\.]+)/i],[p,[h,O]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[h,p],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[p,[h,"UC"+k]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[p,[h,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[p,[h,"WeChat"]],[/konqueror\/([\w\.]+)/i],[p,[h,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[p,[h,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[p,[h,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[h,/(.+)/,"$1 Secure "+k],p],[/\bfocus\/([\w\.]+)/i],[p,[h,I+" Focus"]],[/\bopt\/([\w\.]+)/i],[p,[h,O+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[p,[h,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[p,[h,"Dolphin"]],[/coast\/([\w\.]+)/i],[p,[h,O+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[p,[h,"MIUI "+k]],[/fxios\/([-\w\.]+)/i],[p,[h,I]],[/\bqihu|(qi?ho?o?|360)browser/i],[[h,"360 "+k]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[h,/(.+)/,"$1 "+k],p],[/(comodo_dragon)\/([\w\.]+)/i],[[h,/_/g," "],p],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[h,p],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[h],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[h,$],p],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[h,p],[/\bgsa\/([\w\.]+) .*safari\//i],[p,[h,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[p,[h,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[p,[h,C+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[h,C+" WebView"],p],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[p,[h,"Android "+k]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[h,p],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[p,[h,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[p,h],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[h,[p,K,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[h,p],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[h,"Netscape"],p],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[p,[h,I+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[h,p],[/(cobalt)\/([\w\.]+)/i],[h,[p,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[m,"amd64"]],[/(ia32(?=;))/i],[[m,V]],[/((?:i[346]|x)86)[;\)]/i],[[m,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[m,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[m,"armhf"]],[/windows (ce|mobile); ppc;/i],[[m,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[m,/ower/,"",V]],[/(sun4\w)[;\)]/i],[[m,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[m,V]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[d,[g,B],[f,b]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[d,[g,B],[f,y]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[d,[g,S],[f,y]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[d,[g,S],[f,b]],[/(macintosh);/i],[d,[g,S]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[d,[g,N],[f,y]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[d,[g,M],[f,b]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[d,[g,M],[f,y]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[d,/_/g," "],[g,U],[f,y]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[d,/_/g," "],[g,U],[f,b]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[d,[g,"OPPO"],[f,y]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[d,[g,"Vivo"],[f,y]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[d,[g,"Realme"],[f,y]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[d,[g,L],[f,y]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[d,[g,L],[f,b]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[d,[g,D],[f,b]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[d,[g,D],[f,y]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[d,[g,"Lenovo"],[f,b]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[d,/_/g," "],[g,"Nokia"],[f,y]],[/(pixel c)\b/i],[d,[g,P],[f,b]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[d,[g,P],[f,y]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[d,[g,j],[f,y]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[d,"Xperia Tablet"],[g,j],[f,b]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[d,[g,"OnePlus"],[f,y]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[d,[g,E],[f,b]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[d,/(.+)/g,"Fire Phone $1"],[g,E],[f,y]],[/(playbook);[-\w\),; ]+(rim)/i],[d,g,[f,b]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[d,[g,_],[f,y]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[d,[g,T],[f,b]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[d,[g,T],[f,y]],[/(nexus 9)/i],[d,[g,"HTC"],[f,b]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[g,[d,/_/g," "],[f,y]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[d,[g,"Acer"],[f,b]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[d,[g,"Meizu"],[f,y]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[g,d,[f,y]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[g,d,[f,b]],[/(surface duo)/i],[d,[g,R],[f,b]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[d,[g,"Fairphone"],[f,y]],[/(u304aa)/i],[d,[g,"AT&T"],[f,y]],[/\bsie-(\w*)/i],[d,[g,"Siemens"],[f,y]],[/\b(rct\w+) b/i],[d,[g,"RCA"],[f,b]],[/\b(venue[\d ]{2,7}) b/i],[d,[g,"Dell"],[f,b]],[/\b(q(?:mv|ta)\w+) b/i],[d,[g,"Verizon"],[f,b]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[d,[g,"Barnes & Noble"],[f,b]],[/\b(tm\d{3}\w+) b/i],[d,[g,"NuVision"],[f,b]],[/\b(k88) b/i],[d,[g,"ZTE"],[f,b]],[/\b(nx\d{3}j) b/i],[d,[g,"ZTE"],[f,y]],[/\b(gen\d{3}) b.+49h/i],[d,[g,"Swiss"],[f,y]],[/\b(zur\d{3}) b/i],[d,[g,"Swiss"],[f,b]],[/\b((zeki)?tb.*\b) b/i],[d,[g,"Zeki"],[f,b]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[g,"Dragon Touch"],d,[f,b]],[/\b(ns-?\w{0,9}) b/i],[d,[g,"Insignia"],[f,b]],[/\b((nxa|next)-?\w{0,9}) b/i],[d,[g,"NextBook"],[f,b]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[g,"Voice"],d,[f,y]],[/\b(lvtel\-)?(v1[12]) b/i],[[g,"LvTel"],d,[f,y]],[/\b(ph-1) /i],[d,[g,"Essential"],[f,y]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[d,[g,"Envizen"],[f,b]],[/\b(trio[-\w\. ]+) b/i],[d,[g,"MachSpeed"],[f,b]],[/\btu_(1491) b/i],[d,[g,"Rotor"],[f,b]],[/(shield[\w ]+) b/i],[d,[g,"Nvidia"],[f,b]],[/(sprint) (\w+)/i],[g,d,[f,y]],[/(kin\.[onetw]{3})/i],[[d,/\./g," "],[g,R],[f,y]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[d,[g,F],[f,b]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[d,[g,F],[f,y]],[/smart-tv.+(samsung)/i],[g,[f,w]],[/hbbtv.+maple;(\d+)/i],[[d,/^/,"SmartTV"],[g,B],[f,w]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[g,D],[f,w]],[/(apple) ?tv/i],[g,[d,S+" TV"],[f,w]],[/crkey/i],[[d,C+"cast"],[g,P],[f,w]],[/droid.+aft(\w)( bui|\))/i],[d,[g,E],[f,w]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[d,[g,N],[f,w]],[/(bravia[\w ]+)( bui|\))/i],[d,[g,j],[f,w]],[/(mitv-\w{5}) bui/i],[d,[g,U],[f,w]],[/Hbbtv.*(technisat) (.*);/i],[g,d,[f,w]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[g,z],[d,z],[f,w]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[f,w]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[g,d,[f,v]],[/droid.+; (shield) bui/i],[d,[g,"Nvidia"],[f,v]],[/(playstation [345portablevi]+)/i],[d,[g,j],[f,v]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[d,[g,R],[f,v]],[/((pebble))app/i],[g,d,[f,A]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[d,[g,S],[f,A]],[/droid.+; (glass) \d/i],[d,[g,P],[f,A]],[/droid.+; (wt63?0{2,3})\)/i],[d,[g,F],[f,A]],[/(quest( 2| pro)?)/i],[d,[g,$],[f,A]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[g,[f,x]],[/(aeobc)\b/i],[d,[g,E],[f,x]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[d,[f,y]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[d,[f,b]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[f,b]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[f,y]],[/(android[-\w\. ]{0,9});.+buil/i],[d,[g,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[p,[h,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[p,[h,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[h,p],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[p,h]],os:[[/microsoft (windows) (vista|xp)/i],[h,p],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[h,[p,K,Y]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[h,"Windows"],[p,K,Y]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/ios;fbsv\/([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[p,/_/g,"."],[h,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[h,H],[p,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[p,h],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[h,p],[/\(bb(10);/i],[p,[h,_]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[p,[h,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[p,[h,I+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[p,[h,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[p,[h,"watchOS"]],[/crkey\/([\d\.]+)/i],[p,[h,C+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[h,q],p],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[h,p],[/(sunos) ?([\w\.\d]*)/i],[[h,"Solaris"],p],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[h,p]]},Z=function(e,t){if(typeof e===c&&(t=e,e=s),!(this instanceof Z))return new Z(e,t).getResult();var n=typeof i!==a&&i.navigator?i.navigator:s,r=e||(n&&n.userAgent?n.userAgent:""),v=n&&n.userAgentData?n.userAgentData:s,w=t?function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n}(X,t):X,A=n&&n.userAgent==r;return this.getBrowser=function(){var e,t={};return t[h]=s,t[p]=s,J.call(t,r,w.browser),t[l]=typeof(e=t[p])===u?e.replace(/[^\d\.]/g,"").split(".")[0]:s,A&&n&&n.brave&&typeof n.brave.isBrave==o&&(t[h]="Brave"),t},this.getCPU=function(){var e={};return e[m]=s,J.call(e,r,w.cpu),e},this.getDevice=function(){var e={};return e[g]=s,e[d]=s,e[f]=s,J.call(e,r,w.device),A&&!e[f]&&v&&v.mobile&&(e[f]=y),A&&"Macintosh"==e[d]&&n&&typeof n.standalone!==a&&n.maxTouchPoints&&n.maxTouchPoints>2&&(e[d]="iPad",e[f]=b),e},this.getEngine=function(){var e={};return e[h]=s,e[p]=s,J.call(e,r,w.engine),e},this.getOS=function(){var e={};return e[h]=s,e[p]=s,J.call(e,r,w.os),A&&!e[h]&&v&&"Unknown"!=v.platform&&(e[h]=v.platform.replace(/chrome os/i,q).replace(/macos/i,H)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(e){return r=typeof e===u&&e.length>350?z(e,350):e,this},this.setUA(r),this};Z.VERSION="1.0.35",Z.BROWSER=W([h,p,l]),Z.CPU=W([m]),Z.DEVICE=W([d,g,f,v,y,w,b,A,x]),Z.ENGINE=Z.OS=W([h,p]),typeof t!==a?(e.exports&&(t=e.exports=Z),t.UAParser=Z):n.amdO?(r=function(){return Z}.call(t,n,t,e))===s||(e.exports=r):typeof i!==a&&(i.UAParser=Z);var Q=typeof i!==a&&(i.jQuery||i.Zepto);if(Q&&!Q.ua){var ee=new Z;Q.ua=ee.getResult(),Q.ua.get=function(){return ee.getUA()},Q.ua.set=function(e){ee.setUA(e);var t=ee.getResult();for(var n in t)Q.ua[n]=t[n]}}}("object"==typeof window?window:this)},"./node_modules/uuid/dist/esm-browser/native.js":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)}},"./node_modules/uuid/dist/esm-browser/regex.js":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},"./node_modules/uuid/dist/esm-browser/rng.js":(e,t,n)=>{"use strict";let r;n.r(t),n.d(t,{default:()=>s});const i=new Uint8Array(16);function s(){if(!r&&(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!r))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(i)}},"./node_modules/uuid/dist/esm-browser/stringify.js":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o,unsafeStringify:()=>s});var r=n("./node_modules/uuid/dist/esm-browser/validate.js");const i=[];for(let e=0;e<256;++e)i.push((e+256).toString(16).slice(1));function s(e,t=0){return(i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]).toLowerCase()}const o=function(e,t=0){const n=s(e,t);if(!(0,r.default)(n))throw TypeError("Stringified UUID is invalid");return n}},"./node_modules/uuid/dist/esm-browser/v4.js":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});var r=n("./node_modules/uuid/dist/esm-browser/native.js"),i=n("./node_modules/uuid/dist/esm-browser/rng.js"),s=n("./node_modules/uuid/dist/esm-browser/stringify.js");const o=function(e,t,n){if(r.default.randomUUID&&!t&&!e)return r.default.randomUUID();const o=(e=e||{}).random||(e.rng||i.default)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=o[e];return t}return(0,s.unsafeStringify)(o)}},"./node_modules/uuid/dist/esm-browser/validate.js":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});var r=n("./node_modules/uuid/dist/esm-browser/regex.js");const i=function(e){return"string"==typeof e&&r.default.test(e)}},"./node_modules/idb-keyval/dist/index.js":(e,t,n)=>{"use strict";function r(e){return new Promise(((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)}))}function i(e,t){const n=indexedDB.open(e);n.onupgradeneeded=()=>n.result.createObjectStore(t);const i=r(n);return(e,n)=>i.then((r=>n(r.transaction(t,e).objectStore(t))))}let s;function o(){return s||(s=i("keyval-store","keyval")),s}function a(e,t=o()){return t("readonly",(t=>r(t.get(e))))}function c(e,t,n=o()){return n("readwrite",(n=>(n.put(t,e),r(n.transaction))))}function u(e,t=o()){return t("readwrite",(t=>(e.forEach((e=>t.put(e[1],e[0]))),r(t.transaction))))}function l(e,t=o()){return t("readonly",(t=>Promise.all(e.map((e=>r(t.get(e)))))))}function d(e,t,n=o()){return n("readwrite",(n=>new Promise(((i,s)=>{n.get(e).onsuccess=function(){try{n.put(t(this.result),e),i(r(n.transaction))}catch(e){s(e)}}}))))}function h(e,t=o()){return t("readwrite",(t=>(t.delete(e),r(t.transaction))))}function f(e,t=o()){return t("readwrite",(t=>(e.forEach((e=>t.delete(e))),r(t.transaction))))}function g(e=o()){return e("readwrite",(e=>(e.clear(),r(e.transaction))))}function p(e,t){return e.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},r(e.transaction)}function m(e=o()){return e("readonly",(e=>{if(e.getAllKeys)return r(e.getAllKeys());const t=[];return p(e,(e=>t.push(e.key))).then((()=>t))}))}function v(e=o()){return e("readonly",(e=>{if(e.getAll)return r(e.getAll());const t=[];return p(e,(e=>t.push(e.value))).then((()=>t))}))}function y(e=o()){return e("readonly",(t=>{if(t.getAll&&t.getAllKeys)return Promise.all([r(t.getAllKeys()),r(t.getAll())]).then((([e,t])=>e.map(((e,n)=>[e,t[n]]))));const n=[];return e("readonly",(e=>p(e,(e=>n.push([e.key,e.value]))).then((()=>n))))}))}n.r(t),n.d(t,{clear:()=>g,createStore:()=>i,del:()=>h,delMany:()=>f,entries:()=>y,get:()=>a,getMany:()=>l,keys:()=>m,promisifyRequest:()=>r,set:()=>c,setMany:()=>u,update:()=>d,values:()=>v})},"./node_modules/throttle-debounce/esm/index.js":(e,t,n)=>{"use strict";function r(e,t,n){var r,i=n||{},s=i.noTrailing,o=void 0!==s&&s,a=i.noLeading,c=void 0!==a&&a,u=i.debounceMode,l=void 0===u?void 0:u,d=!1,h=0;function f(){r&&clearTimeout(r)}function g(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];var a=this,u=Date.now()-h;function g(){h=Date.now(),t.apply(a,i)}function p(){r=void 0}d||(c||!l||r||g(),f(),void 0===l&&u>e?c?(h=Date.now(),o||(r=setTimeout(l?p:g,e))):g():!0!==o&&(r=setTimeout(l?p:g,void 0===l?e-u:e)))}return g.cancel=function(e){var t=(e||{}).upcomingOnly,n=void 0!==t&&t;f(),d=!n},g}function i(e,t,n){var i=(n||{}).atBegin;return r(e,t,{debounceMode:!1!==(void 0!==i&&i)})}n.r(t),n.d(t,{debounce:()=>i,throttle:()=>r})}},n={};function r(t){var i=n[t];if(void 0!==i)return i.exports;var s=n[t]={exports:{}};return e[t].call(s.exports,s,s.exports,r),s.exports}r.amdO={},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};(()=>{"use strict";r.r(i),r.d(i,{AppType:()=>e.AppType,INSTALLATION_ID_LOCAL_STORAGE_KEY:()=>e.INSTALLATION_ID_LOCAL_STORAGE_KEY,MessagingSDK:()=>e.MessagingSDK});var e=r("./src/MessagingSDK.ts")})();var s=t;for(var o in i)s[o]=i[o];i.__esModule&&Object.defineProperty(s,"__esModule",{value:!0})})()},22073:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BLANK_URL=t.relativeFirstCharacters=t.whitespaceEscapeCharsRegex=t.urlSchemeRegex=t.ctrlCharactersRegex=t.htmlCtrlEntityRegex=t.htmlEntitiesRegex=t.invalidProtocolRegex=void 0,t.invalidProtocolRegex=/^([^\w]*)(javascript|data|vbscript)/im,t.htmlEntitiesRegex=/&#(\w+)(^\w|;)?/g,t.htmlCtrlEntityRegex=/&(newline|tab);/gi,t.ctrlCharactersRegex=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,t.urlSchemeRegex=/^.+(:|&colon;)/gim,t.whitespaceEscapeCharsRegex=/(\\|%5[cC])((%(6[eE]|72|74))|[nrt])/g,t.relativeFirstCharacters=[".","/"],t.BLANK_URL="about:blank"},21812:(e,t,n)=>{"use strict";t.J=void 0;var r=n(22073);function i(e){try{return decodeURIComponent(e)}catch(t){return e}}t.J=function(e){if(!e)return r.BLANK_URL;var t,n,s=i(e);do{t=(s=i(s=(n=s,n.replace(r.ctrlCharactersRegex,"").replace(r.htmlEntitiesRegex,(function(e,t){return String.fromCharCode(t)}))).replace(r.htmlCtrlEntityRegex,"").replace(r.ctrlCharactersRegex,"").replace(r.whitespaceEscapeCharsRegex,"").trim())).match(r.ctrlCharactersRegex)||s.match(r.htmlEntitiesRegex)||s.match(r.htmlCtrlEntityRegex)||s.match(r.whitespaceEscapeCharsRegex)}while(t&&t.length>0);var o=s;if(!o)return r.BLANK_URL;if(function(e){return r.relativeFirstCharacters.indexOf(e[0])>-1}(o))return o;var a=o.match(r.urlSchemeRegex);if(!a)return o;var c=a[0];return r.invalidProtocolRegex.test(c)?r.BLANK_URL:o}},29058:function(e,t){var n,r,i;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,r=[e],n=function(e){"use strict";if(!globalThis.chrome?.runtime?.id)throw new Error("This script should only be loaded in a browser extension.");if(void 0===globalThis.browser||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const t="The message port closed before a response was received.",n=e=>{const n={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(n).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class r extends WeakMap{constructor(e,t=void 0){super(t),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const i=e=>e&&"object"==typeof e&&"function"==typeof e.then,s=(t,n)=>(...r)=>{e.runtime.lastError?t.reject(new Error(e.runtime.lastError.message)):n.singleCallbackArg||r.length<=1&&!1!==n.singleCallbackArg?t.resolve(r[0]):t.resolve(r)},o=e=>1==e?"argument":"arguments",a=(e,t)=>function(n,...r){if(r.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${o(t.minArgs)} for ${e}(), got ${r.length}`);if(r.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${o(t.maxArgs)} for ${e}(), got ${r.length}`);return new Promise(((i,o)=>{if(t.fallbackToNoCallback)try{n[e](...r,s({resolve:i,reject:o},t))}catch(s){n[e](...r),t.fallbackToNoCallback=!1,t.noCallback=!0,i()}else t.noCallback?(n[e](...r),i()):n[e](...r,s({resolve:i,reject:o},t))}))},c=(e,t,n)=>new Proxy(t,{apply:(t,r,i)=>n.call(r,e,...i)});let u=Function.call.bind(Object.prototype.hasOwnProperty);const l=(e,t={},n={})=>{let r=Object.create(null),i={has:(t,n)=>n in e||n in r,get(i,s,o){if(s in r)return r[s];if(!(s in e))return;let d=e[s];if("function"==typeof d)if("function"==typeof t[s])d=c(e,e[s],t[s]);else if(u(n,s)){let t=a(s,n[s]);d=c(e,e[s],t)}else d=d.bind(e);else if("object"==typeof d&&null!==d&&(u(t,s)||u(n,s)))d=l(d,t[s],n[s]);else{if(!u(n,"*"))return Object.defineProperty(r,s,{configurable:!0,enumerable:!0,get:()=>e[s],set(t){e[s]=t}}),d;d=l(d,t[s],n["*"])}return r[s]=d,d},set:(t,n,i,s)=>(n in r?r[n]=i:e[n]=i,!0),defineProperty:(e,t,n)=>Reflect.defineProperty(r,t,n),deleteProperty:(e,t)=>Reflect.deleteProperty(r,t)},s=Object.create(e);return new Proxy(s,i)},d=e=>({addListener(t,n,...r){t.addListener(e.get(n),...r)},hasListener:(t,n)=>t.hasListener(e.get(n)),removeListener(t,n){t.removeListener(e.get(n))}}),h=new r((e=>"function"!=typeof e?e:function(t){const n=l(t,{},{getContent:{minArgs:0,maxArgs:0}});e(n)})),f=new r((e=>"function"!=typeof e?e:function(t,n,r){let s,o,a=!1,c=new Promise((e=>{s=function(t){a=!0,e(t)}}));try{o=e(t,n,s)}catch(e){o=Promise.reject(e)}const u=!0!==o&&i(o);if(!0!==o&&!u&&!a)return!1;const l=e=>{e.then((e=>{r(e)}),(e=>{let t;t=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",r({__mozWebExtensionPolyfillReject__:!0,message:t})})).catch((e=>{}))};return l(u?o:c),!0})),g=({reject:n,resolve:r},i)=>{e.runtime.lastError?e.runtime.lastError.message===t?r():n(new Error(e.runtime.lastError.message)):i&&i.__mozWebExtensionPolyfillReject__?n(new Error(i.message)):r(i)},p=(e,t,n,...r)=>{if(r.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${o(t.minArgs)} for ${e}(), got ${r.length}`);if(r.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${o(t.maxArgs)} for ${e}(), got ${r.length}`);return new Promise(((e,t)=>{const i=g.bind(null,{resolve:e,reject:t});r.push(i),n.sendMessage(...r)}))},m={devtools:{network:{onRequestFinished:d(h)}},runtime:{onMessage:d(f),onMessageExternal:d(f),sendMessage:p.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:p.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},v={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return n.privacy={network:{"*":v},services:{"*":v},websites:{"*":v}},l(e,m,n)};e.exports=n(chrome)}else e.exports=globalThis.browser},void 0===(i="function"==typeof n?n.apply(t,r):n)||(e.exports=i)},85030:function(e,t){var n,r,i;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,r=[e],n=function(e){"use strict";if(!globalThis.chrome?.runtime?.id)throw new Error("This script should only be loaded in a browser extension.");if(void 0===globalThis.browser||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const t="The message port closed before a response was received.",n=e=>{const n={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(n).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class r extends WeakMap{constructor(e,t=void 0){super(t),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const i=e=>e&&"object"==typeof e&&"function"==typeof e.then,s=(t,n)=>(...r)=>{e.runtime.lastError?t.reject(new Error(e.runtime.lastError.message)):n.singleCallbackArg||r.length<=1&&!1!==n.singleCallbackArg?t.resolve(r[0]):t.resolve(r)},o=e=>1==e?"argument":"arguments",a=(e,t)=>function(n,...r){if(r.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${o(t.minArgs)} for ${e}(), got ${r.length}`);if(r.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${o(t.maxArgs)} for ${e}(), got ${r.length}`);return new Promise(((i,o)=>{if(t.fallbackToNoCallback)try{n[e](...r,s({resolve:i,reject:o},t))}catch(s){n[e](...r),t.fallbackToNoCallback=!1,t.noCallback=!0,i()}else t.noCallback?(n[e](...r),i()):n[e](...r,s({resolve:i,reject:o},t))}))},c=(e,t,n)=>new Proxy(t,{apply:(t,r,i)=>n.call(r,e,...i)});let u=Function.call.bind(Object.prototype.hasOwnProperty);const l=(e,t={},n={})=>{let r=Object.create(null),i={has:(t,n)=>n in e||n in r,get(i,s,o){if(s in r)return r[s];if(!(s in e))return;let d=e[s];if("function"==typeof d)if("function"==typeof t[s])d=c(e,e[s],t[s]);else if(u(n,s)){let t=a(s,n[s]);d=c(e,e[s],t)}else d=d.bind(e);else if("object"==typeof d&&null!==d&&(u(t,s)||u(n,s)))d=l(d,t[s],n[s]);else{if(!u(n,"*"))return Object.defineProperty(r,s,{configurable:!0,enumerable:!0,get:()=>e[s],set(t){e[s]=t}}),d;d=l(d,t[s],n["*"])}return r[s]=d,d},set:(t,n,i,s)=>(n in r?r[n]=i:e[n]=i,!0),defineProperty:(e,t,n)=>Reflect.defineProperty(r,t,n),deleteProperty:(e,t)=>Reflect.deleteProperty(r,t)},s=Object.create(e);return new Proxy(s,i)},d=e=>({addListener(t,n,...r){t.addListener(e.get(n),...r)},hasListener:(t,n)=>t.hasListener(e.get(n)),removeListener(t,n){t.removeListener(e.get(n))}}),h=new r((e=>"function"!=typeof e?e:function(t){const n=l(t,{},{getContent:{minArgs:0,maxArgs:0}});e(n)})),f=new r((e=>"function"!=typeof e?e:function(t,n,r){let s,o,a=!1,c=new Promise((e=>{s=function(t){a=!0,e(t)}}));try{o=e(t,n,s)}catch(e){o=Promise.reject(e)}const u=!0!==o&&i(o);if(!0!==o&&!u&&!a)return!1;const l=e=>{e.then((e=>{r(e)}),(e=>{let t;t=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",r({__mozWebExtensionPolyfillReject__:!0,message:t})})).catch((e=>{}))};return l(u?o:c),!0})),g=({reject:n,resolve:r},i)=>{e.runtime.lastError?e.runtime.lastError.message===t?r():n(new Error(e.runtime.lastError.message)):i&&i.__mozWebExtensionPolyfillReject__?n(new Error(i.message)):r(i)},p=(e,t,n,...r)=>{if(r.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${o(t.minArgs)} for ${e}(), got ${r.length}`);if(r.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${o(t.maxArgs)} for ${e}(), got ${r.length}`);return new Promise(((e,t)=>{const i=g.bind(null,{resolve:e,reject:t});r.push(i),n.sendMessage(...r)}))},m={devtools:{network:{onRequestFinished:d(h)}},runtime:{onMessage:d(f),onMessageExternal:d(f),sendMessage:p.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:p.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},v={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return n.privacy={network:{"*":v},services:{"*":v},websites:{"*":v}},l(e,m,n)};e.exports=n(chrome)}else e.exports=globalThis.browser},void 0===(i="function"==typeof n?n.apply(t,r):n)||(e.exports=i)},38761:function(e,t){!function(){var n={version:"0.4.1",settings:{currency:{symbol:"$",format:"%s%v",decimal:".",thousand:",",precision:2,grouping:3},number:{precision:0,grouping:3,thousand:",",decimal:"."}}},r=Array.prototype.map,i=Array.isArray,s=Object.prototype.toString;function o(e){return!!(""===e||e&&e.charCodeAt&&e.substr)}function a(e){return i?i(e):"[object Array]"===s.call(e)}function c(e){return e&&"[object Object]"===s.call(e)}function u(e,t){var n;for(n in e=e||{},t=t||{})t.hasOwnProperty(n)&&null==e[n]&&(e[n]=t[n]);return e}function l(e,t,n){var i,s,o=[];if(!e)return o;if(r&&e.map===r)return e.map(t,n);for(i=0,s=e.length;i<s;i++)o[i]=t.call(n,e[i],i,e);return o}function d(e,t){return e=Math.round(Math.abs(e)),isNaN(e)?t:e}function h(e){var t=n.settings.currency.format;return"function"==typeof e&&(e=e()),o(e)&&e.match("%v")?{pos:e,neg:e.replace("-","").replace("%v","-%v"),zero:e}:e&&e.pos&&e.pos.match("%v")?e:o(t)?n.settings.currency.format={pos:t,neg:t.replace("%v","-%v"),zero:t}:t}var f=n.unformat=n.parse=function(e,t){if(a(e))return l(e,(function(e){return f(e,t)}));if("number"==typeof(e=e||0))return e;t=t||n.settings.number.decimal;var r=new RegExp("[^0-9-"+t+"]",["g"]),i=parseFloat((""+e).replace(/\((.*)\)/,"-$1").replace(r,"").replace(t,"."));return isNaN(i)?0:i},g=n.toFixed=function(e,t){t=d(t,n.settings.number.precision);var r=Math.pow(10,t);return(Math.round(n.unformat(e)*r)/r).toFixed(t)},p=n.formatNumber=n.format=function(e,t,r,i){if(a(e))return l(e,(function(e){return p(e,t,r,i)}));e=f(e);var s=u(c(t)?t:{precision:t,thousand:r,decimal:i},n.settings.number),o=d(s.precision),h=e<0?"-":"",m=parseInt(g(Math.abs(e||0),o),10)+"",v=m.length>3?m.length%3:0;return h+(v?m.substr(0,v)+s.thousand:"")+m.substr(v).replace(/(\d{3})(?=\d)/g,"$1"+s.thousand)+(o?s.decimal+g(Math.abs(e),o).split(".")[1]:"")},m=n.formatMoney=function(e,t,r,i,s,o){if(a(e))return l(e,(function(e){return m(e,t,r,i,s,o)}));e=f(e);var g=u(c(t)?t:{symbol:t,precision:r,thousand:i,decimal:s,format:o},n.settings.currency),v=h(g.format);return(e>0?v.pos:e<0?v.neg:v.zero).replace("%s",g.symbol).replace("%v",p(Math.abs(e),d(g.precision),g.thousand,g.decimal))};n.formatColumn=function(e,t,r,i,s,g){if(!e)return[];var m=u(c(t)?t:{symbol:t,precision:r,thousand:i,decimal:s,format:g},n.settings.currency),v=h(m.format),y=v.pos.indexOf("%s")<v.pos.indexOf("%v"),b=0,w=l(e,(function(e,t){if(a(e))return n.formatColumn(e,m);var r=((e=f(e))>0?v.pos:e<0?v.neg:v.zero).replace("%s",m.symbol).replace("%v",p(Math.abs(e),d(m.precision),m.thousand,m.decimal));return r.length>b&&(b=r.length),r}));return l(w,(function(e,t){return o(e)&&e.length<b?y?e.replace(m.symbol,m.symbol+new Array(b-e.length+1).join(" ")):new Array(b-e.length+1).join(" ")+e:e}))},e.exports&&(t=e.exports=n),t.accounting=n}()},36337:(e,t,n)=>{var r,i,s;s="object"==typeof self&&self.self===self&&self||"object"==typeof n.g&&n.g.global===n.g&&n.g,r=[n(45091),n(79602),t],i=function(e,t,n){s.Backbone=function(e,t,n,r){var i=e.Backbone,s=Array.prototype.slice;t.VERSION="1.6.0",t.$=r,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var o,a=t.Events={},c=/\s+/,u=function(e,t,r,i,s){var o,a=0;if(r&&"object"==typeof r){void 0!==i&&"context"in s&&void 0===s.context&&(s.context=i);for(o=n.keys(r);a<o.length;a++)t=u(e,t,o[a],r[o[a]],s)}else if(r&&c.test(r))for(o=r.split(c);a<o.length;a++)t=e(t,o[a],i,s);else t=e(t,r,i,s);return t};a.on=function(e,t,n){return this._events=u(l,this._events||{},e,t,{context:n,ctx:this,listening:o}),o&&((this._listeners||(this._listeners={}))[o.id]=o,o.interop=!1),this},a.listenTo=function(e,t,r){if(!e)return this;var i=e._listenId||(e._listenId=n.uniqueId("l")),s=this._listeningTo||(this._listeningTo={}),a=o=s[i];a||(this._listenId||(this._listenId=n.uniqueId("l")),a=o=s[i]=new m(this,e));var c=d(e,t,r,this);if(o=void 0,c)throw c;return a.interop&&a.on(t,r),this};var l=function(e,t,n,r){if(n){var i=e[t]||(e[t]=[]),s=r.context,o=r.ctx,a=r.listening;a&&a.count++,i.push({callback:n,context:s,ctx:s||o,listening:a})}return e},d=function(e,t,n,r){try{e.on(t,n,r)}catch(e){return e}};a.off=function(e,t,n){return this._events?(this._events=u(h,this._events,e,t,{context:n,listeners:this._listeners}),this):this},a.stopListening=function(e,t,r){var i=this._listeningTo;if(!i)return this;for(var s=e?[e._listenId]:n.keys(i),o=0;o<s.length;o++){var a=i[s[o]];if(!a)break;a.obj.off(t,r,this),a.interop&&a.off(t,r)}return n.isEmpty(i)&&(this._listeningTo=void 0),this};var h=function(e,t,r,i){if(e){var s,o=i.context,a=i.listeners,c=0;if(t||o||r){for(s=t?[t]:n.keys(e);c<s.length;c++){var u=e[t=s[c]];if(!u)break;for(var l=[],d=0;d<u.length;d++){var h=u[d];if(r&&r!==h.callback&&r!==h.callback._callback||o&&o!==h.context)l.push(h);else{var f=h.listening;f&&f.off(t,r)}}l.length?e[t]=l:delete e[t]}return e}for(s=n.keys(a);c<s.length;c++)a[s[c]].cleanup()}};a.once=function(e,t,n){var r=u(f,{},e,t,this.off.bind(this));return"string"==typeof e&&null==n&&(t=void 0),this.on(r,t,n)},a.listenToOnce=function(e,t,n){var r=u(f,{},t,n,this.stopListening.bind(this,e));return this.listenTo(e,r)};var f=function(e,t,r,i){if(r){var s=e[t]=n.once((function(){i(t,s),r.apply(this,arguments)}));s._callback=r}return e};a.trigger=function(e){if(!this._events)return this;for(var t=Math.max(0,arguments.length-1),n=Array(t),r=0;r<t;r++)n[r]=arguments[r+1];return u(g,this._events,e,void 0,n),this};var g=function(e,t,n,r){if(e){var i=e[t],s=e.all;i&&s&&(s=s.slice()),i&&p(i,r),s&&p(s,[t].concat(r))}return e},p=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],a=t[2];switch(t.length){case 0:for(;++r<i;)(n=e[r]).callback.call(n.ctx);return;case 1:for(;++r<i;)(n=e[r]).callback.call(n.ctx,s);return;case 2:for(;++r<i;)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:for(;++r<i;)(n=e[r]).callback.call(n.ctx,s,o,a);return;default:for(;++r<i;)(n=e[r]).callback.apply(n.ctx,t);return}},m=function(e,t){this.id=e._listenId,this.listener=e,this.obj=t,this.interop=!0,this.count=0,this._events=void 0};m.prototype.on=a.on,m.prototype.off=function(e,t){var n;this.interop?(this._events=u(h,this._events,e,t,{context:void 0,listeners:void 0}),n=!this._events):(this.count--,n=0===this.count),n&&this.cleanup()},m.prototype.cleanup=function(){delete this.listener._listeningTo[this.obj._listenId],this.interop||delete this.obj._listeners[this.id]},a.bind=a.on,a.unbind=a.off,n.extend(t,a);var v=t.Model=function(e,t){var r=e||{};t||(t={}),this.preinitialize.apply(this,arguments),this.cid=n.uniqueId(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(r=this.parse(r,t)||{});var i=n.result(this,"defaults");r=n.defaults(n.extend({},i,r),i),this.set(r,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(v.prototype,a,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",preinitialize:function(){},initialize:function(){},toJSON:function(e){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return null!=this.get(e)},matches:function(e){return!!n.iteratee(e,this)(this.attributes)},set:function(e,t,r){if(null==e)return this;var i;if("object"==typeof e?(i=e,r=t):(i={})[e]=t,r||(r={}),!this._validate(i,r))return!1;var s=r.unset,o=r.silent,a=[],c=this._changing;this._changing=!0,c||(this._previousAttributes=n.clone(this.attributes),this.changed={});var u=this.attributes,l=this.changed,d=this._previousAttributes;for(var h in i)t=i[h],n.isEqual(u[h],t)||a.push(h),n.isEqual(d[h],t)?delete l[h]:l[h]=t,s?delete u[h]:u[h]=t;if(this.idAttribute in i){var f=this.id;this.id=this.get(this.idAttribute),this.trigger("changeId",this,f,r)}if(!o){a.length&&(this._pending=r);for(var g=0;g<a.length;g++)this.trigger("change:"+a[g],this,u[a[g]],r)}if(c)return this;if(!o)for(;this._pending;)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var r in this.attributes)t[r]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&n.clone(this.changed);var t,r=this._changing?this._previousAttributes:this.attributes,i={};for(var s in e){var o=e[s];n.isEqual(r[s],o)||(i[s]=o,t=!0)}return!!t&&i},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=n.extend({parse:!0},e);var t=this,r=e.success;return e.success=function(n){var i=e.parse?t.parse(n,e):n;if(!t.set(i,e))return!1;r&&r.call(e.context,t,n,e),t.trigger("sync",t,n,e)},J(this,e),this.sync("read",this,e)},save:function(e,t,r){var i;null==e||"object"==typeof e?(i=e,r=t):(i={})[e]=t;var s=(r=n.extend({validate:!0,parse:!0},r)).wait;if(i&&!s){if(!this.set(i,r))return!1}else if(!this._validate(i,r))return!1;var o=this,a=r.success,c=this.attributes;r.success=function(e){o.attributes=c;var t=r.parse?o.parse(e,r):e;if(s&&(t=n.extend({},i,t)),t&&!o.set(t,r))return!1;a&&a.call(r.context,o,e,r),o.trigger("sync",o,e,r)},J(this,r),i&&s&&(this.attributes=n.extend({},c,i));var u=this.isNew()?"create":r.patch?"patch":"update";"patch"!==u||r.attrs||(r.attrs=i);var l=this.sync(u,this,r);return this.attributes=c,l},destroy:function(e){e=e?n.clone(e):{};var t=this,r=e.success,i=e.wait,s=function(){t.stopListening(),t.trigger("destroy",t,t.collection,e)};e.success=function(n){i&&s(),r&&r.call(e.context,t,n,e),t.isNew()||t.trigger("sync",t,n,e)};var o=!1;return this.isNew()?n.defer(e.success):(J(this,e),o=this.sync("delete",this,e)),i||s(),o},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||z();if(this.isNew())return e;var t=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},n.extend({},e,{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var r=this.validationError=this.validate(e,t)||null;return!r||(this.trigger("invalid",this,r,n.extend(t,{validationError:r})),!1)}});var y=t.Collection=function(e,t){t||(t={}),this.preinitialize.apply(this,arguments),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},b={add:!0,remove:!0,merge:!0},w={add:!0,remove:!1},A=function(e,t,n){n=Math.min(Math.max(n,0),e.length);var r,i=Array(e.length-n),s=t.length;for(r=0;r<i.length;r++)i[r]=e[r+n];for(r=0;r<s;r++)e[r+n]=t[r];for(r=0;r<i.length;r++)e[r+s+n]=i[r]};n.extend(y.prototype,a,{model:v,preinitialize:function(){},initialize:function(){},toJSON:function(e){return this.map((function(t){return t.toJSON(e)}))},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,w))},remove:function(e,t){t=n.extend({},t);var r=!n.isArray(e);e=r?[e]:e.slice();var i=this._removeModels(e,t);return!t.silent&&i.length&&(t.changes={added:[],merged:[],removed:i},this.trigger("update",this,t)),r?i[0]:i},set:function(e,t){if(null!=e){(t=n.extend({},b,t)).parse&&!this._isModel(e)&&(e=this.parse(e,t)||[]);var r=!n.isArray(e);e=r?[e]:e.slice();var i=t.at;null!=i&&(i=+i),i>this.length&&(i=this.length),i<0&&(i+=this.length+1);var s,o,a=[],c=[],u=[],l=[],d={},h=t.add,f=t.merge,g=t.remove,p=!1,m=this.comparator&&null==i&&!1!==t.sort,v=n.isString(this.comparator)?this.comparator:null;for(o=0;o<e.length;o++){s=e[o];var y=this.get(s);if(y){if(f&&s!==y){var w=this._isModel(s)?s.attributes:s;t.parse&&(w=y.parse(w,t)),y.set(w,t),u.push(y),m&&!p&&(p=y.hasChanged(v))}d[y.cid]||(d[y.cid]=!0,a.push(y)),e[o]=y}else h&&(s=e[o]=this._prepareModel(s,t))&&(c.push(s),this._addReference(s,t),d[s.cid]=!0,a.push(s))}if(g){for(o=0;o<this.length;o++)d[(s=this.models[o]).cid]||l.push(s);l.length&&this._removeModels(l,t)}var x=!1,E=!m&&h&&g;if(a.length&&E?(x=this.length!==a.length||n.some(this.models,(function(e,t){return e!==a[t]})),this.models.length=0,A(this.models,a,0),this.length=this.models.length):c.length&&(m&&(p=!0),A(this.models,c,null==i?this.length:i),this.length=this.models.length),p&&this.sort({silent:!0}),!t.silent){for(o=0;o<c.length;o++)null!=i&&(t.index=i+o),(s=c[o]).trigger("add",s,this,t);(p||x)&&this.trigger("sort",this,t),(c.length||l.length||u.length)&&(t.changes={added:c,removed:l,merged:u},this.trigger("update",this,t))}return r?e[0]:e}},reset:function(e,t){t=t?n.clone(t):{};for(var r=0;r<this.models.length;r++)this._removeReference(this.models[r],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e)},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e)},slice:function(){return s.apply(this.models,arguments)},get:function(e){if(null!=e)return this._byId[e]||this._byId[this.modelId(this._isModel(e)?e.attributes:e,e.idAttribute)]||e.cid&&this._byId[e.cid]},has:function(e){return null!=this.get(e)},at:function(e){return e<0&&(e+=this.length),this.models[e]},where:function(e,t){return this[t?"find":"filter"](e)},findWhere:function(e){return this.where(e,!0)},sort:function(e){var t=this.comparator;if(!t)throw new Error("Cannot sort a set without a comparator");e||(e={});var r=t.length;return n.isFunction(t)&&(t=t.bind(this)),1===r||n.isString(t)?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return this.map(e+"")},fetch:function(e){var t=(e=n.extend({parse:!0},e)).success,r=this;return e.success=function(n){var i=e.reset?"reset":"set";r[i](n,e),t&&t.call(e.context,r,n,e),r.trigger("sync",r,n,e)},J(this,e),this.sync("read",this,e)},create:function(e,t){var r=(t=t?n.clone(t):{}).wait;if(!(e=this._prepareModel(e,t)))return!1;r||this.add(e,t);var i=this,s=t.success;return t.success=function(e,t,n){r&&(e.off("error",i._forwardPristineError,i),i.add(e,n)),s&&s.call(n.context,e,t,n)},r&&e.once("error",this._forwardPristineError,this),e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(e,t){return e[t||this.model.prototype.idAttribute||"id"]},values:function(){return new E(this,S)},keys:function(){return new E(this,T)},entries:function(){return new E(this,_)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){return this._isModel(e)?(e.collection||(e.collection=this),e):((t=t?n.clone(t):{}).collection=this,(r=this.model.prototype?new this.model(e,t):this.model(e,t)).validationError?(this.trigger("invalid",this,r.validationError,t),!1):r);var r},_removeModels:function(e,t){for(var n=[],r=0;r<e.length;r++){var i=this.get(e[r]);if(i){var s=this.indexOf(i);this.models.splice(s,1),this.length--,delete this._byId[i.cid];var o=this.modelId(i.attributes,i.idAttribute);null!=o&&delete this._byId[o],t.silent||(t.index=s,i.trigger("remove",i,this,t)),n.push(i),this._removeReference(i,t)}}return e.length>0&&!t.silent&&delete t.index,n},_isModel:function(e){return e instanceof v},_addReference:function(e,t){this._byId[e.cid]=e;var n=this.modelId(e.attributes,e.idAttribute);null!=n&&(this._byId[n]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){delete this._byId[e.cid];var n=this.modelId(e.attributes,e.idAttribute);null!=n&&delete this._byId[n],this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if(t){if(("add"===e||"remove"===e)&&n!==this)return;if("destroy"===e&&this.remove(t,r),"changeId"===e){var i=this.modelId(t.previousAttributes(),t.idAttribute),s=this.modelId(t.attributes,t.idAttribute);null!=i&&delete this._byId[i],null!=s&&(this._byId[s]=t)}}this.trigger.apply(this,arguments)},_forwardPristineError:function(e,t,n){this.has(e)||this._onModelEvent("error",e,t,n)}});var x="function"==typeof Symbol&&Symbol.iterator;x&&(y.prototype[x]=y.prototype.values);var E=function(e,t){this._collection=e,this._kind=t,this._index=0},S=1,T=2,_=3;x&&(E.prototype[x]=function(){return this}),E.prototype.next=function(){if(this._collection){if(this._index<this._collection.length){var e,t=this._collection.at(this._index);if(this._index++,this._kind===S)e=t;else{var n=this._collection.modelId(t.attributes,t.idAttribute);e=this._kind===T?n:[n,t]}return{value:e,done:!1}}this._collection=void 0}return{value:void 0,done:!0}};var k=t.View=function(e){this.cid=n.uniqueId("view"),this.preinitialize.apply(this,arguments),n.extend(this,n.pick(e,I)),this._ensureElement(),this.initialize.apply(this,arguments)},C=/^(\S+)\s*(.*)$/,I=["model","collection","el","id","attributes","className","tagName","events"];n.extend(k.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},preinitialize:function(){},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},_setElement:function(e){this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0]},delegateEvents:function(e){if(e||(e=n.result(this,"events")),!e)return this;for(var t in this.undelegateEvents(),e){var r=e[t];if(n.isFunction(r)||(r=this[r]),r){var i=t.match(C);this.delegate(i[1],i[2],r.bind(this))}}return this},delegate:function(e,t,n){return this.$el.on(e+".delegateEvents"+this.cid,t,n),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(e,t,n){return this.$el.off(e+".delegateEvents"+this.cid,t,n),this},_createElement:function(e){return document.createElement(e)},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"));else{var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e.class=n.result(this,"className")),this.setElement(this._createElement(n.result(this,"tagName"))),this._setAttributes(e)}},_setAttributes:function(e){this.$el.attr(e)}});var P=function(e,t,n,r){switch(t){case 1:return function(){return e[n](this[r])};case 2:return function(t){return e[n](this[r],t)};case 3:return function(t,i){return e[n](this[r],D(t,this),i)};case 4:return function(t,i,s){return e[n](this[r],D(t,this),i,s)};default:return function(){var t=s.call(arguments);return t.unshift(this[r]),e[n].apply(e,t)}}},M=function(e,t,r,i){n.each(r,(function(n,r){t[r]&&(e.prototype[r]=P(t,n,r,i))}))},D=function(e,t){return n.isFunction(e)?e:n.isObject(e)&&!t._isModel(e)?R(e):n.isString(e)?function(t){return t.get(e)}:e},R=function(e){var t=n.matches(e);return function(e){return t(e.attributes)}},L={forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3},O={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};n.each([[y,L,"models"],[v,O,"attributes"]],(function(e){var t=e[0],r=e[1],i=e[2];t.mixin=function(e){var r=n.reduce(n.functions(e),(function(e,t){return e[t]=0,e}),{});M(t,e,r,i)},M(t,n,r,i)})),t.sync=function(e,r,i){var s=B[e];n.defaults(i||(i={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:s,dataType:"json"};if(i.url||(o.url=n.result(r,"url")||z()),null!=i.data||!r||"create"!==e&&"update"!==e&&"patch"!==e||(o.contentType="application/json",o.data=JSON.stringify(i.attrs||r.toJSON(i))),i.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),i.emulateHTTP&&("PUT"===s||"DELETE"===s||"PATCH"===s)){o.type="POST",i.emulateJSON&&(o.data._method=s);var a=i.beforeSend;i.beforeSend=function(e){if(e.setRequestHeader("X-HTTP-Method-Override",s),a)return a.apply(this,arguments)}}"GET"===o.type||i.emulateJSON||(o.processData=!1);var c=i.error;i.error=function(e,t,n){i.textStatus=t,i.errorThrown=n,c&&c.call(i.context,e,t,n)};var u=i.xhr=t.ajax(n.extend(o,i));return r.trigger("request",r,u,i),u};var B={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var N=t.Router=function(e){e||(e={}),this.preinitialize.apply(this,arguments),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},j=/\((.*?)\)/g,U=/(\(\?)?:\w+/g,F=/\*\w+/g,$=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(N.prototype,a,{preinitialize:function(){},initialize:function(){},route:function(e,r,i){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(r)&&(i=r,r=""),i||(i=this[r]);var s=this;return t.history.route(e,(function(n){var o=s._extractParameters(e,n);!1!==s.execute(i,o,r)&&(s.trigger.apply(s,["route:"+r].concat(o)),s.trigger("route",r,o),t.history.trigger("route",s,r,o))})),this},execute:function(e,t,n){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var e,t=n.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace($,"\\$&").replace(j,"(?:$1)?").replace(U,(function(e,t){return t?e:"([^/?]+)"})).replace(F,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var r=e.exec(t).slice(1);return n.map(r,(function(e,t){return t===r.length-1?e||null:e?decodeURIComponent(e):null}))}});var q=t.History=function(){this.handlers=[],this.checkUrl=this.checkUrl.bind(this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},H=/^[#\/]|\s+$/g,W=/^\/+|\/+$/g,G=/#.*$/;q.started=!1,n.extend(q.prototype,a,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(e){return decodeURI(e.replace(/%25/g,"%2525"))},getSearch:function(){var e=this.location.href.replace(/#.*/,"").match(/\?.+/);return e?e[0]:""},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){var e=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===e.charAt(0)?e.slice(1):e},getFragment:function(e){return null==e&&(e=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),e.replace(H,"")},start:function(e){if(q.started)throw new Error("Backbone.history has already been started");if(q.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._trailingSlash=this.options.trailingSlash,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(W,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var t=this.root.slice(0,-1)||"/";return this.location.replace(t+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var r=document.body,i=r.insertBefore(this.iframe,r.firstChild).contentWindow;i.document.open(),i.document.close(),i.location.hash="#"+this.fragment}var s=window.addEventListener||function(e,t){return attachEvent("on"+e,t)};if(this._usePushState?s("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?s("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var e=window.removeEventListener||function(e,t){return detachEvent("on"+e,t)};this._usePushState?e("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&e("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),q.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();if(t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow)),t===this.fragment)return!this.matchRoot()&&this.notfound();this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return this.matchRoot()?(e=this.fragment=this.getFragment(e),n.some(this.handlers,(function(t){if(t.route.test(e))return t.callback(e),!0}))||this.notfound()):this.notfound()},notfound:function(){return this.trigger("notfound"),!1},navigate:function(e,t){if(!q.started)return!1;t&&!0!==t||(t={trigger:!!t}),e=this.getFragment(e||"");var n=this.root;this._trailingSlash||""!==e&&"?"!==e.charAt(0)||(n=n.slice(0,-1)||"/");var r=n+e;e=e.replace(G,"");var i=this.decodeFragment(e);if(this.fragment!==i){if(this.fragment=i,this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,r);else{if(!this._wantsHashChange)return this.location.assign(r);if(this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getHash(this.iframe.contentWindow)){var s=this.iframe.contentWindow;t.replace||(s.document.open(),s.document.close()),this._updateHash(s.location,e,t.replace)}}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),t.history=new q;var V=function(e,t){var r,i=this;return r=e&&n.has(e,"constructor")?e.constructor:function(){return i.apply(this,arguments)},n.extend(r,i,t),r.prototype=n.create(i.prototype,e),r.prototype.constructor=r,r.__super__=i.prototype,r};v.extend=y.extend=N.extend=k.extend=q.extend=V;var z=function(){throw new Error('A "url" property or function must be specified')},J=function(e,t){var n=t.error;t.error=function(r){n&&n.call(t.context,e,r,t),e.trigger("error",e,r,t)}};return t._debug=function(){return{root:e,_:n}},t}(s,n,e,t)}.apply(t,r),void 0===i||(e.exports=i)},31761:e=>{var t={utf8:{stringToBytes:function(e){return t.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(t.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t},bytesToString:function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}}};e.exports=t},59957:e=>{var t,n;t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&n.rotl(e,8)|4278255360&n.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=n.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],n=0,r=0;n<e.length;n++,r+=8)t[r>>>5]|=e[n]<<24-r%32;return t},wordsToBytes:function(e){for(var t=[],n=0;n<32*e.length;n+=8)t.push(e[n>>>5]>>>24-n%32&255);return t},bytesToHex:function(e){for(var t=[],n=0;n<e.length;n++)t.push((e[n]>>>4).toString(16)),t.push((15&e[n]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(parseInt(e.substr(n,2),16));return t},bytesToBase64:function(e){for(var n=[],r=0;r<e.length;r+=3)for(var i=e[r]<<16|e[r+1]<<8|e[r+2],s=0;s<4;s++)8*r+6*s<=8*e.length?n.push(t.charAt(i>>>6*(3-s)&63)):n.push("=");return n.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var n=[],r=0,i=0;r<e.length;i=++r%4)0!=i&&n.push((t.indexOf(e.charAt(r-1))&Math.pow(2,-2*i+8)-1)<<2*i|t.indexOf(e.charAt(r))>>>6-2*i);return n}},e.exports=n},7059:function(e){e.exports=function(){"use strict";var e=1e3,t=6e4,n=36e5,r="millisecond",i="second",s="minute",o="hour",a="day",c="week",u="month",l="quarter",d="year",h="date",f="Invalid Date",g=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,p=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,m={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},v=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},y={s:v,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),r=Math.floor(n/60),i=n%60;return(t<=0?"+":"-")+v(r,2,"0")+":"+v(i,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var r=12*(n.year()-t.year())+(n.month()-t.month()),i=t.clone().add(r,u),s=n-i<0,o=t.clone().add(r+(s?-1:1),u);return+(-(r+(n-i)/(s?i-o:o-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:u,y:d,w:c,d:a,D:h,h:o,m:s,s:i,ms:r,Q:l}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},b="en",w={};w[b]=m;var A="$isDayjsObject",x=function(e){return e instanceof _||!(!e||!e[A])},E=function e(t,n,r){var i;if(!t)return b;if("string"==typeof t){var s=t.toLowerCase();w[s]&&(i=s),n&&(w[s]=n,i=s);var o=t.split("-");if(!i&&o.length>1)return e(o[0])}else{var a=t.name;w[a]=t,i=a}return!r&&i&&(b=i),i||!r&&b},S=function(e,t){if(x(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new _(n)},T=y;T.l=E,T.i=x,T.w=function(e,t){return S(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var _=function(){function m(e){this.$L=E(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[A]=!0}var v=m.prototype;return v.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(T.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(g);if(r){var i=r[2]-1||0,s=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)}}return new Date(t)}(e),this.init()},v.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},v.$utils=function(){return T},v.isValid=function(){return!(this.$d.toString()===f)},v.isSame=function(e,t){var n=S(e);return this.startOf(t)<=n&&n<=this.endOf(t)},v.isAfter=function(e,t){return S(e)<this.startOf(t)},v.isBefore=function(e,t){return this.endOf(t)<S(e)},v.$g=function(e,t,n){return T.u(e)?this[t]:this.set(n,e)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(e,t){var n=this,r=!!T.u(t)||t,l=T.p(e),f=function(e,t){var i=T.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return r?i:i.endOf(a)},g=function(e,t){return T.w(n.toDate()[e].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},p=this.$W,m=this.$M,v=this.$D,y="set"+(this.$u?"UTC":"");switch(l){case d:return r?f(1,0):f(31,11);case u:return r?f(1,m):f(0,m+1);case c:var b=this.$locale().weekStart||0,w=(p<b?p+7:p)-b;return f(r?v-w:v+(6-w),m);case a:case h:return g(y+"Hours",0);case o:return g(y+"Minutes",1);case s:return g(y+"Seconds",2);case i:return g(y+"Milliseconds",3);default:return this.clone()}},v.endOf=function(e){return this.startOf(e,!1)},v.$set=function(e,t){var n,c=T.p(e),l="set"+(this.$u?"UTC":""),f=(n={},n[a]=l+"Date",n[h]=l+"Date",n[u]=l+"Month",n[d]=l+"FullYear",n[o]=l+"Hours",n[s]=l+"Minutes",n[i]=l+"Seconds",n[r]=l+"Milliseconds",n)[c],g=c===a?this.$D+(t-this.$W):t;if(c===u||c===d){var p=this.clone().set(h,1);p.$d[f](g),p.init(),this.$d=p.set(h,Math.min(this.$D,p.daysInMonth())).$d}else f&&this.$d[f](g);return this.init(),this},v.set=function(e,t){return this.clone().$set(e,t)},v.get=function(e){return this[T.p(e)]()},v.add=function(r,l){var h,f=this;r=Number(r);var g=T.p(l),p=function(e){var t=S(f);return T.w(t.date(t.date()+Math.round(e*r)),f)};if(g===u)return this.set(u,this.$M+r);if(g===d)return this.set(d,this.$y+r);if(g===a)return p(1);if(g===c)return p(7);var m=(h={},h[s]=t,h[o]=n,h[i]=e,h)[g]||1,v=this.$d.getTime()+r*m;return T.w(v,this)},v.subtract=function(e,t){return this.add(-1*e,t)},v.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||f;var r=e||"YYYY-MM-DDTHH:mm:ssZ",i=T.z(this),s=this.$H,o=this.$m,a=this.$M,c=n.weekdays,u=n.months,l=n.meridiem,d=function(e,n,i,s){return e&&(e[n]||e(t,r))||i[n].slice(0,s)},h=function(e){return T.s(s%12||12,e,"0")},g=l||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r};return r.replace(p,(function(e,r){return r||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return T.s(t.$y,4,"0");case"M":return a+1;case"MM":return T.s(a+1,2,"0");case"MMM":return d(n.monthsShort,a,u,3);case"MMMM":return d(u,a);case"D":return t.$D;case"DD":return T.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return d(n.weekdaysMin,t.$W,c,2);case"ddd":return d(n.weekdaysShort,t.$W,c,3);case"dddd":return c[t.$W];case"H":return String(s);case"HH":return T.s(s,2,"0");case"h":return h(1);case"hh":return h(2);case"a":return g(s,o,!0);case"A":return g(s,o,!1);case"m":return String(o);case"mm":return T.s(o,2,"0");case"s":return String(t.$s);case"ss":return T.s(t.$s,2,"0");case"SSS":return T.s(t.$ms,3,"0");case"Z":return i}return null}(e)||i.replace(":","")}))},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(r,h,f){var g,p=this,m=T.p(h),v=S(r),y=(v.utcOffset()-this.utcOffset())*t,b=this-v,w=function(){return T.m(p,v)};switch(m){case d:g=w()/12;break;case u:g=w();break;case l:g=w()/3;break;case c:g=(b-y)/6048e5;break;case a:g=(b-y)/864e5;break;case o:g=b/n;break;case s:g=b/t;break;case i:g=b/e;break;default:g=b}return f?g:T.a(g)},v.daysInMonth=function(){return this.endOf(u).$D},v.$locale=function(){return w[this.$L]},v.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=E(e,t,!0);return r&&(n.$L=r),n},v.clone=function(){return T.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},m}(),k=_.prototype;return S.prototype=k,[["$ms",r],["$s",i],["$m",s],["$H",o],["$W",a],["$M",u],["$y",d],["$D",h]].forEach((function(e){k[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),S.extend=function(e,t){return e.$i||(e(t,_,S),e.$i=!0),S},S.locale=E,S.isDayjs=x,S.unix=function(e){return S(1e3*e)},S.en=w[b],S.Ls=w,S.p={},S}()},64785:e=>{"use strict";var t,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,s),r(n)}function s(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}p(e,t,s,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&p(e,"error",t,n)}(e,i,{once:!0})}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var o=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function u(e,t,n,r){var i,s,o;if(a(n),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),o=s[t]),void 0===o)o=s[t]=n,++e._eventsCount;else if("function"==typeof o?o=s[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),(i=c(e))>0&&o.length>i&&!o.warned){o.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=o.length,console&&console.warn}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=l.bind(r);return i.listener=n,r.wrapFn=i,i}function h(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):g(i,i.length)}function f(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function g(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function p(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(s){r.once&&e.removeEventListener(t,i),n(s)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,s=this._events;if(void 0!==s)i=i&&void 0===s.error;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(void 0===c)return!1;if("function"==typeof c)r(c,this,t);else{var u=c.length,l=g(c,u);for(n=0;n<u;++n)r(l[n],this,t)}return!0},s.prototype.addListener=function(e,t){return u(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return u(this,e,t,!0)},s.prototype.once=function(e,t){return a(t),this.on(e,d(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,d(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,r,i,s,o;if(a(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){o=n[s].listener,i=s;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,s=Object.keys(n);for(r=0;r<s.length;++r)"removeListener"!==(i=s[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},s.prototype.listeners=function(e){return h(this,e,!0)},s.prototype.rawListeners=function(e){return h(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},s.prototype.listenerCount=f,s.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},68872:e=>{function t(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(t(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&t(e.slice(0,0))}(e)||!!e._isBuffer)}},79602:function(e,t){var n;!function(t,n){"use strict";"object"==typeof e.exports?e.exports=t.document?n(t,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return n(e)}:n(t)}("undefined"!=typeof window?window:this,(function(r,i){"use strict";var s=[],o=Object.getPrototypeOf,a=s.slice,c=s.flat?function(e){return s.flat.call(e)}:function(e){return s.concat.apply([],e)},u=s.push,l=s.indexOf,d={},h=d.toString,f=d.hasOwnProperty,g=f.toString,p=g.call(Object),m={},v=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},y=function(e){return null!=e&&e===e.window},b=r.document,w={type:!0,src:!0,nonce:!0,noModule:!0};function A(e,t,n){var r,i,s=(n=n||b).createElement("script");if(s.text=e,t)for(r in w)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&s.setAttribute(r,i);n.head.appendChild(s).parentNode.removeChild(s)}function x(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?d[h.call(e)]||"object":typeof e}var E="3.7.1",S=/HTML$/i,T=function(e,t){return new T.fn.init(e,t)};function _(e){var t=!!e&&"length"in e&&e.length,n=x(e);return!v(e)&&!y(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}function k(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}T.fn=T.prototype={jquery:E,constructor:T,length:0,toArray:function(){return a.call(this)},get:function(e){return null==e?a.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=T.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return T.each(this,e)},map:function(e){return this.pushStack(T.map(this,(function(t,n){return e.call(t,n,t)})))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(T.grep(this,(function(e,t){return(t+1)%2})))},odd:function(){return this.pushStack(T.grep(this,(function(e,t){return t%2})))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:s.sort,splice:s.splice},T.extend=T.fn.extend=function(){var e,t,n,r,i,s,o=arguments[0]||{},a=1,c=arguments.length,u=!1;for("boolean"==typeof o&&(u=o,o=arguments[a]||{},a++),"object"==typeof o||v(o)||(o={}),a===c&&(o=this,a--);a<c;a++)if(null!=(e=arguments[a]))for(t in e)r=e[t],"__proto__"!==t&&o!==r&&(u&&r&&(T.isPlainObject(r)||(i=Array.isArray(r)))?(n=o[t],s=i&&!Array.isArray(n)?[]:i||T.isPlainObject(n)?n:{},i=!1,o[t]=T.extend(u,s,r)):void 0!==r&&(o[t]=r));return o},T.extend({expando:"jQuery"+(E+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==h.call(e))&&(!(t=o(e))||"function"==typeof(n=f.call(t,"constructor")&&t.constructor)&&g.call(n)===p)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){A(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(_(e))for(n=e.length;r<n&&!1!==t.call(e[r],r,e[r]);r++);else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},text:function(e){var t,n="",r=0,i=e.nodeType;if(!i)for(;t=e[r++];)n+=T.text(t);return 1===i||11===i?e.textContent:9===i?e.documentElement.textContent:3===i||4===i?e.nodeValue:n},makeArray:function(e,t){var n=t||[];return null!=e&&(_(Object(e))?T.merge(n,"string"==typeof e?[e]:e):u.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:l.call(t,e,n)},isXMLDoc:function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!S.test(t||n&&n.nodeName||"HTML")},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,s=e.length,o=!n;i<s;i++)!t(e[i],i)!==o&&r.push(e[i]);return r},map:function(e,t,n){var r,i,s=0,o=[];if(_(e))for(r=e.length;s<r;s++)null!=(i=t(e[s],s,n))&&o.push(i);else for(s in e)null!=(i=t(e[s],s,n))&&o.push(i);return c(o)},guid:1,support:m}),"function"==typeof Symbol&&(T.fn[Symbol.iterator]=s[Symbol.iterator]),T.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(e,t){d["[object "+t+"]"]=t.toLowerCase()}));var C=s.pop,I=s.sort,P=s.splice,M="[\\x20\\t\\r\\n\\f]",D=new RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g");T.contains=function(e,t){var n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(e.contains?e.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))};var R=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function L(e,t){return t?"\0"===e?"\ufffd":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e}T.escapeSelector=function(e){return(e+"").replace(R,L)};var O=b,B=u;!function(){var e,t,n,i,o,c,u,d,h,g,p=B,v=T.expando,y=0,b=0,w=ee(),A=ee(),x=ee(),E=ee(),S=function(e,t){return e===t&&(o=!0),0},_="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",R="(?:\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",L="\\["+M+"*("+R+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+R+"))|)"+M+"*\\]",N=":("+R+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+L+")*)|.*)\\)|)",j=new RegExp(M+"+","g"),U=new RegExp("^"+M+"*,"+M+"*"),F=new RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),$=new RegExp(M+"|>"),q=new RegExp(N),H=new RegExp("^"+R+"$"),W={ID:new RegExp("^#("+R+")"),CLASS:new RegExp("^\\.("+R+")"),TAG:new RegExp("^("+R+"|[*])"),ATTR:new RegExp("^"+L),PSEUDO:new RegExp("^"+N),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:new RegExp("^(?:"+_+")$","i"),needsContext:new RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},G=/^(?:input|select|textarea|button)$/i,V=/^h\d$/i,z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,J=/[+~]/,K=new RegExp("\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\([^\\r\\n\\f])","g"),Y=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},X=function(){ce()},Z=he((function(e){return!0===e.disabled&&k(e,"fieldset")}),{dir:"parentNode",next:"legend"});try{p.apply(s=a.call(O.childNodes),O.childNodes),s[O.childNodes.length].nodeType}catch(e){p={apply:function(e,t){B.apply(e,a.call(t))},call:function(e){B.apply(e,a.call(arguments,1))}}}function Q(e,t,n,r){var i,s,o,a,u,l,f,g=t&&t.ownerDocument,y=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==y&&9!==y&&11!==y)return n;if(!r&&(ce(t),t=t||c,d)){if(11!==y&&(u=z.exec(e)))if(i=u[1]){if(9===y){if(!(o=t.getElementById(i)))return n;if(o.id===i)return p.call(n,o),n}else if(g&&(o=g.getElementById(i))&&Q.contains(t,o)&&o.id===i)return p.call(n,o),n}else{if(u[2])return p.apply(n,t.getElementsByTagName(e)),n;if((i=u[3])&&t.getElementsByClassName)return p.apply(n,t.getElementsByClassName(i)),n}if(!(E[e+" "]||h&&h.test(e))){if(f=e,g=t,1===y&&($.test(e)||F.test(e))){for((g=J.test(e)&&ae(t.parentNode)||t)==t&&m.scope||((a=t.getAttribute("id"))?a=T.escapeSelector(a):t.setAttribute("id",a=v)),s=(l=le(e)).length;s--;)l[s]=(a?"#"+a:":scope")+" "+de(l[s]);f=l.join(",")}try{return p.apply(n,g.querySelectorAll(f)),n}catch(t){E(e,!0)}finally{a===v&&t.removeAttribute("id")}}}return ye(e.replace(D,"$1"),t,n,r)}function ee(){var e=[];return function n(r,i){return e.push(r+" ")>t.cacheLength&&delete n[e.shift()],n[r+" "]=i}}function te(e){return e[v]=!0,e}function ne(e){var t=c.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function re(e){return function(t){return k(t,"input")&&t.type===e}}function ie(e){return function(t){return(k(t,"input")||k(t,"button"))&&t.type===e}}function se(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&Z(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function oe(e){return te((function(t){return t=+t,te((function(n,r){for(var i,s=e([],n.length,t),o=s.length;o--;)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))}))}))}function ae(e){return e&&void 0!==e.getElementsByTagName&&e}function ce(e){var n,r=e?e.ownerDocument||e:O;return r!=c&&9===r.nodeType&&r.documentElement?(u=(c=r).documentElement,d=!T.isXMLDoc(c),g=u.matches||u.webkitMatchesSelector||u.msMatchesSelector,u.msMatchesSelector&&O!=c&&(n=c.defaultView)&&n.top!==n&&n.addEventListener("unload",X),m.getById=ne((function(e){return u.appendChild(e).id=T.expando,!c.getElementsByName||!c.getElementsByName(T.expando).length})),m.disconnectedMatch=ne((function(e){return g.call(e,"*")})),m.scope=ne((function(){return c.querySelectorAll(":scope")})),m.cssHas=ne((function(){try{return c.querySelector(":has(*,:jqfake)"),!1}catch(e){return!0}})),m.getById?(t.filter.ID=function(e){var t=e.replace(K,Y);return function(e){return e.getAttribute("id")===t}},t.find.ID=function(e,t){if(void 0!==t.getElementById&&d){var n=t.getElementById(e);return n?[n]:[]}}):(t.filter.ID=function(e){var t=e.replace(K,Y);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},t.find.ID=function(e,t){if(void 0!==t.getElementById&&d){var n,r,i,s=t.getElementById(e);if(s){if((n=s.getAttributeNode("id"))&&n.value===e)return[s];for(i=t.getElementsByName(e),r=0;s=i[r++];)if((n=s.getAttributeNode("id"))&&n.value===e)return[s]}return[]}}),t.find.TAG=function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):t.querySelectorAll(e)},t.find.CLASS=function(e,t){if(void 0!==t.getElementsByClassName&&d)return t.getElementsByClassName(e)},h=[],ne((function(e){var t;u.appendChild(e).innerHTML="<a id='"+v+"' href='' disabled='disabled'></a><select id='"+v+"-\r\\' disabled='disabled'><option selected=''></option></select>",e.querySelectorAll("[selected]").length||h.push("\\["+M+"*(?:value|"+_+")"),e.querySelectorAll("[id~="+v+"-]").length||h.push("~="),e.querySelectorAll("a#"+v+"+*").length||h.push(".#.+[+~]"),e.querySelectorAll(":checked").length||h.push(":checked"),(t=c.createElement("input")).setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),u.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&h.push(":enabled",":disabled"),(t=c.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||h.push("\\["+M+"*name"+M+"*="+M+"*(?:''|\"\")")})),m.cssHas||h.push(":has"),h=h.length&&new RegExp(h.join("|")),S=function(e,t){if(e===t)return o=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!m.sortDetached&&t.compareDocumentPosition(e)===n?e===c||e.ownerDocument==O&&Q.contains(O,e)?-1:t===c||t.ownerDocument==O&&Q.contains(O,t)?1:i?l.call(i,e)-l.call(i,t):0:4&n?-1:1)},c):c}for(e in Q.matches=function(e,t){return Q(e,null,null,t)},Q.matchesSelector=function(e,t){if(ce(e),d&&!E[t+" "]&&(!h||!h.test(t)))try{var n=g.call(e,t);if(n||m.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){E(t,!0)}return Q(t,c,null,[e]).length>0},Q.contains=function(e,t){return(e.ownerDocument||e)!=c&&ce(e),T.contains(e,t)},Q.attr=function(e,n){(e.ownerDocument||e)!=c&&ce(e);var r=t.attrHandle[n.toLowerCase()],i=r&&f.call(t.attrHandle,n.toLowerCase())?r(e,n,!d):void 0;return void 0!==i?i:e.getAttribute(n)},Q.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},T.uniqueSort=function(e){var t,n=[],r=0,s=0;if(o=!m.sortStable,i=!m.sortStable&&a.call(e,0),I.call(e,S),o){for(;t=e[s++];)t===e[s]&&(r=n.push(s));for(;r--;)P.call(e,n[r],1)}return i=null,e},T.fn.uniqueSort=function(){return this.pushStack(T.uniqueSort(a.apply(this)))},t=T.expr={cacheLength:50,createPseudo:te,match:W,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(K,Y),e[3]=(e[3]||e[4]||e[5]||"").replace(K,Y),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||Q.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&Q.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return W.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&q.test(n)&&(t=le(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(K,Y).toLowerCase();return"*"===e?function(){return!0}:function(e){return k(e,t)}},CLASS:function(e){var t=w[e+" "];return t||(t=new RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&w(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,n){return function(r){var i=Q.attr(r,e);return null==i?"!="===t:!t||(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i.replace(j," ")+" ").indexOf(n)>-1:"|="===t&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,i){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),a="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,c){var u,l,d,h,f,g=s!==o?"nextSibling":"previousSibling",p=t.parentNode,m=a&&t.nodeName.toLowerCase(),b=!c&&!a,w=!1;if(p){if(s){for(;g;){for(d=t;d=d[g];)if(a?k(d,m):1===d.nodeType)return!1;f=g="only"===e&&!f&&"nextSibling"}return!0}if(f=[o?p.firstChild:p.lastChild],o&&b){for(w=(h=(u=(l=p[v]||(p[v]={}))[e]||[])[0]===y&&u[1])&&u[2],d=h&&p.childNodes[h];d=++h&&d&&d[g]||(w=h=0)||f.pop();)if(1===d.nodeType&&++w&&d===t){l[e]=[y,h,w];break}}else if(b&&(w=h=(u=(l=t[v]||(t[v]={}))[e]||[])[0]===y&&u[1]),!1===w)for(;(d=++h&&d&&d[g]||(w=h=0)||f.pop())&&(!(a?k(d,m):1===d.nodeType)||!++w||(b&&((l=d[v]||(d[v]={}))[e]=[y,w]),d!==t)););return(w-=i)===r||w%r==0&&w/r>=0}}},PSEUDO:function(e,n){var r,i=t.pseudos[e]||t.setFilters[e.toLowerCase()]||Q.error("unsupported pseudo: "+e);return i[v]?i(n):i.length>1?(r=[e,e,"",n],t.setFilters.hasOwnProperty(e.toLowerCase())?te((function(e,t){for(var r,s=i(e,n),o=s.length;o--;)e[r=l.call(e,s[o])]=!(t[r]=s[o])})):function(e){return i(e,0,r)}):i}},pseudos:{not:te((function(e){var t=[],n=[],r=ve(e.replace(D,"$1"));return r[v]?te((function(e,t,n,i){for(var s,o=r(e,null,i,[]),a=e.length;a--;)(s=o[a])&&(e[a]=!(t[a]=s))})):function(e,i,s){return t[0]=e,r(t,null,s,n),t[0]=null,!n.pop()}})),has:te((function(e){return function(t){return Q(e,t).length>0}})),contains:te((function(e){return e=e.replace(K,Y),function(t){return(t.textContent||T.text(t)).indexOf(e)>-1}})),lang:te((function(e){return H.test(e||"")||Q.error("unsupported lang: "+e),e=e.replace(K,Y).toLowerCase(),function(t){var n;do{if(n=d?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(e){var t=r.location&&r.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===u},focus:function(e){return e===function(){try{return c.activeElement}catch(e){}}()&&c.hasFocus()&&!!(e.type||e.href||~e.tabIndex)},enabled:se(!1),disabled:se(!0),checked:function(e){return k(e,"input")&&!!e.checked||k(e,"option")&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!t.pseudos.empty(e)},header:function(e){return V.test(e.nodeName)},input:function(e){return G.test(e.nodeName)},button:function(e){return k(e,"input")&&"button"===e.type||k(e,"button")},text:function(e){var t;return k(e,"input")&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:oe((function(){return[0]})),last:oe((function(e,t){return[t-1]})),eq:oe((function(e,t,n){return[n<0?n+t:n]})),even:oe((function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e})),odd:oe((function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e})),lt:oe((function(e,t,n){var r;for(r=n<0?n+t:n>t?t:n;--r>=0;)e.push(r);return e})),gt:oe((function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e}))}},t.pseudos.nth=t.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})t.pseudos[e]=re(e);for(e in{submit:!0,reset:!0})t.pseudos[e]=ie(e);function ue(){}function le(e,n){var r,i,s,o,a,c,u,l=A[e+" "];if(l)return n?0:l.slice(0);for(a=e,c=[],u=t.preFilter;a;){for(o in r&&!(i=U.exec(a))||(i&&(a=a.slice(i[0].length)||a),c.push(s=[])),r=!1,(i=F.exec(a))&&(r=i.shift(),s.push({value:r,type:i[0].replace(D," ")}),a=a.slice(r.length)),t.filter)!(i=W[o].exec(a))||u[o]&&!(i=u[o](i))||(r=i.shift(),s.push({value:r,type:o,matches:i}),a=a.slice(r.length));if(!r)break}return n?a.length:a?Q.error(e):A(e,c).slice(0)}function de(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function he(e,t,n){var r=t.dir,i=t.next,s=i||r,o=n&&"parentNode"===s,a=b++;return t.first?function(t,n,i){for(;t=t[r];)if(1===t.nodeType||o)return e(t,n,i);return!1}:function(t,n,c){var u,l,d=[y,a];if(c){for(;t=t[r];)if((1===t.nodeType||o)&&e(t,n,c))return!0}else for(;t=t[r];)if(1===t.nodeType||o)if(l=t[v]||(t[v]={}),i&&k(t,i))t=t[r]||t;else{if((u=l[s])&&u[0]===y&&u[1]===a)return d[2]=u[2];if(l[s]=d,d[2]=e(t,n,c))return!0}return!1}}function fe(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function ge(e,t,n,r,i){for(var s,o=[],a=0,c=e.length,u=null!=t;a<c;a++)(s=e[a])&&(n&&!n(s,r,i)||(o.push(s),u&&t.push(a)));return o}function pe(e,t,n,r,i,s){return r&&!r[v]&&(r=pe(r)),i&&!i[v]&&(i=pe(i,s)),te((function(s,o,a,c){var u,d,h,f,g=[],m=[],v=o.length,y=s||function(e,t,n){for(var r=0,i=t.length;r<i;r++)Q(e,t[r],n);return n}(t||"*",a.nodeType?[a]:a,[]),b=!e||!s&&t?y:ge(y,g,e,a,c);if(n?n(b,f=i||(s?e:v||r)?[]:o,a,c):f=b,r)for(u=ge(f,m),r(u,[],a,c),d=u.length;d--;)(h=u[d])&&(f[m[d]]=!(b[m[d]]=h));if(s){if(i||e){if(i){for(u=[],d=f.length;d--;)(h=f[d])&&u.push(b[d]=h);i(null,f=[],u,c)}for(d=f.length;d--;)(h=f[d])&&(u=i?l.call(s,h):g[d])>-1&&(s[u]=!(o[u]=h))}}else f=ge(f===o?f.splice(v,f.length):f),i?i(null,o,f,c):p.apply(o,f)}))}function me(e){for(var r,i,s,o=e.length,a=t.relative[e[0].type],c=a||t.relative[" "],u=a?1:0,d=he((function(e){return e===r}),c,!0),h=he((function(e){return l.call(r,e)>-1}),c,!0),f=[function(e,t,i){var s=!a&&(i||t!=n)||((r=t).nodeType?d(e,t,i):h(e,t,i));return r=null,s}];u<o;u++)if(i=t.relative[e[u].type])f=[he(fe(f),i)];else{if((i=t.filter[e[u].type].apply(null,e[u].matches))[v]){for(s=++u;s<o&&!t.relative[e[s].type];s++);return pe(u>1&&fe(f),u>1&&de(e.slice(0,u-1).concat({value:" "===e[u-2].type?"*":""})).replace(D,"$1"),i,u<s&&me(e.slice(u,s)),s<o&&me(e=e.slice(s)),s<o&&de(e))}f.push(i)}return fe(f)}function ve(e,r){var i,s=[],o=[],a=x[e+" "];if(!a){for(r||(r=le(e)),i=r.length;i--;)(a=me(r[i]))[v]?s.push(a):o.push(a);a=x(e,function(e,r){var i=r.length>0,s=e.length>0,o=function(o,a,u,l,h){var f,g,m,v=0,b="0",w=o&&[],A=[],x=n,E=o||s&&t.find.TAG("*",h),S=y+=null==x?1:Math.random()||.1,_=E.length;for(h&&(n=a==c||a||h);b!==_&&null!=(f=E[b]);b++){if(s&&f){for(g=0,a||f.ownerDocument==c||(ce(f),u=!d);m=e[g++];)if(m(f,a||c,u)){p.call(l,f);break}h&&(y=S)}i&&((f=!m&&f)&&v--,o&&w.push(f))}if(v+=b,i&&b!==v){for(g=0;m=r[g++];)m(w,A,a,u);if(o){if(v>0)for(;b--;)w[b]||A[b]||(A[b]=C.call(l));A=ge(A)}p.apply(l,A),h&&!o&&A.length>0&&v+r.length>1&&T.uniqueSort(l)}return h&&(y=S,n=x),w};return i?te(o):o}(o,s)),a.selector=e}return a}function ye(e,n,r,i){var s,o,a,c,u,l="function"==typeof e&&e,h=!i&&le(e=l.selector||e);if(r=r||[],1===h.length){if((o=h[0]=h[0].slice(0)).length>2&&"ID"===(a=o[0]).type&&9===n.nodeType&&d&&t.relative[o[1].type]){if(!(n=(t.find.ID(a.matches[0].replace(K,Y),n)||[])[0]))return r;l&&(n=n.parentNode),e=e.slice(o.shift().value.length)}for(s=W.needsContext.test(e)?0:o.length;s--&&(a=o[s],!t.relative[c=a.type]);)if((u=t.find[c])&&(i=u(a.matches[0].replace(K,Y),J.test(o[0].type)&&ae(n.parentNode)||n))){if(o.splice(s,1),!(e=i.length&&de(o)))return p.apply(r,i),r;break}}return(l||ve(e,h))(i,n,!d,r,!n||J.test(e)&&ae(n.parentNode)||n),r}ue.prototype=t.filters=t.pseudos,t.setFilters=new ue,m.sortStable=v.split("").sort(S).join("")===v,ce(),m.sortDetached=ne((function(e){return 1&e.compareDocumentPosition(c.createElement("fieldset"))})),T.find=Q,T.expr[":"]=T.expr.pseudos,T.unique=T.uniqueSort,Q.compile=ve,Q.select=ye,Q.setDocument=ce,Q.tokenize=le,Q.escape=T.escapeSelector,Q.getText=T.text,Q.isXML=T.isXMLDoc,Q.selectors=T.expr,Q.support=T.support,Q.uniqueSort=T.uniqueSort}();var N=function(e,t,n){for(var r=[],i=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&T(e).is(n))break;r.push(e)}return r},j=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},U=T.expr.match.needsContext,F=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function $(e,t,n){return v(t)?T.grep(e,(function(e,r){return!!t.call(e,r,e)!==n})):t.nodeType?T.grep(e,(function(e){return e===t!==n})):"string"!=typeof t?T.grep(e,(function(e){return l.call(t,e)>-1!==n})):T.filter(t,e,n)}T.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?T.find.matchesSelector(r,e)?[r]:[]:T.find.matches(e,T.grep(t,(function(e){return 1===e.nodeType})))},T.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(T(e).filter((function(){for(t=0;t<r;t++)if(T.contains(i[t],this))return!0})));for(n=this.pushStack([]),t=0;t<r;t++)T.find(e,i[t],n);return r>1?T.uniqueSort(n):n},filter:function(e){return this.pushStack($(this,e||[],!1))},not:function(e){return this.pushStack($(this,e||[],!0))},is:function(e){return!!$(this,"string"==typeof e&&U.test(e)?T(e):e||[],!1).length}});var q,H=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(T.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||q,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:H.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof T?t[0]:t,T.merge(this,T.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:b,!0)),F.test(r[1])&&T.isPlainObject(t))for(r in t)v(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=b.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):v(e)?void 0!==n.ready?n.ready(e):e(T):T.makeArray(e,this)}).prototype=T.fn,q=T(b);var W=/^(?:parents|prev(?:Until|All))/,G={children:!0,contents:!0,next:!0,prev:!0};function V(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}T.fn.extend({has:function(e){var t=T(e,this),n=t.length;return this.filter((function(){for(var e=0;e<n;e++)if(T.contains(this,t[e]))return!0}))},closest:function(e,t){var n,r=0,i=this.length,s=[],o="string"!=typeof e&&T(e);if(!U.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(o?o.index(n)>-1:1===n.nodeType&&T.find.matchesSelector(n,e))){s.push(n);break}return this.pushStack(s.length>1?T.uniqueSort(s):s)},index:function(e){return e?"string"==typeof e?l.call(T(e),this[0]):l.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(T.uniqueSort(T.merge(this.get(),T(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),T.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return N(e,"parentNode")},parentsUntil:function(e,t,n){return N(e,"parentNode",n)},next:function(e){return V(e,"nextSibling")},prev:function(e){return V(e,"previousSibling")},nextAll:function(e){return N(e,"nextSibling")},prevAll:function(e){return N(e,"previousSibling")},nextUntil:function(e,t,n){return N(e,"nextSibling",n)},prevUntil:function(e,t,n){return N(e,"previousSibling",n)},siblings:function(e){return j((e.parentNode||{}).firstChild,e)},children:function(e){return j(e.firstChild)},contents:function(e){return null!=e.contentDocument&&o(e.contentDocument)?e.contentDocument:(k(e,"template")&&(e=e.content||e),T.merge([],e.childNodes))}},(function(e,t){T.fn[e]=function(n,r){var i=T.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=T.filter(r,i)),this.length>1&&(G[e]||T.uniqueSort(i),W.test(e)&&i.reverse()),this.pushStack(i)}}));var z=/[^\x20\t\r\n\f]+/g;function J(e){return e}function K(e){throw e}function Y(e,t,n,r){var i;try{e&&v(i=e.promise)?i.call(e).done(t).fail(n):e&&v(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}T.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return T.each(e.match(z)||[],(function(e,n){t[n]=!0})),t}(e):T.extend({},e);var t,n,r,i,s=[],o=[],a=-1,c=function(){for(i=i||e.once,r=t=!0;o.length;a=-1)for(n=o.shift();++a<s.length;)!1===s[a].apply(n[0],n[1])&&e.stopOnFalse&&(a=s.length,n=!1);e.memory||(n=!1),t=!1,i&&(s=n?[]:"")},u={add:function(){return s&&(n&&!t&&(a=s.length-1,o.push(n)),function t(n){T.each(n,(function(n,r){v(r)?e.unique&&u.has(r)||s.push(r):r&&r.length&&"string"!==x(r)&&t(r)}))}(arguments),n&&!t&&c()),this},remove:function(){return T.each(arguments,(function(e,t){for(var n;(n=T.inArray(t,s,n))>-1;)s.splice(n,1),n<=a&&a--})),this},has:function(e){return e?T.inArray(e,s)>-1:s.length>0},empty:function(){return s&&(s=[]),this},disable:function(){return i=o=[],s=n="",this},disabled:function(){return!s},lock:function(){return i=o=[],n||t||(s=n=""),this},locked:function(){return!!i},fireWith:function(e,n){return i||(n=[e,(n=n||[]).slice?n.slice():n],o.push(n),t||c()),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!r}};return u},T.extend({Deferred:function(e){var t=[["notify","progress",T.Callbacks("memory"),T.Callbacks("memory"),2],["resolve","done",T.Callbacks("once memory"),T.Callbacks("once memory"),0,"resolved"],["reject","fail",T.Callbacks("once memory"),T.Callbacks("once memory"),1,"rejected"]],n="pending",i={state:function(){return n},always:function(){return s.done(arguments).fail(arguments),this},catch:function(e){return i.then(null,e)},pipe:function(){var e=arguments;return T.Deferred((function(n){T.each(t,(function(t,r){var i=v(e[r[4]])&&e[r[4]];s[r[1]]((function(){var e=i&&i.apply(this,arguments);e&&v(e.promise)?e.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[r[0]+"With"](this,i?[e]:arguments)}))})),e=null})).promise()},then:function(e,n,i){var s=0;function o(e,t,n,i){return function(){var a=this,c=arguments,u=function(){var r,u;if(!(e<s)){if((r=n.apply(a,c))===t.promise())throw new TypeError("Thenable self-resolution");u=r&&("object"==typeof r||"function"==typeof r)&&r.then,v(u)?i?u.call(r,o(s,t,J,i),o(s,t,K,i)):(s++,u.call(r,o(s,t,J,i),o(s,t,K,i),o(s,t,J,t.notifyWith))):(n!==J&&(a=void 0,c=[r]),(i||t.resolveWith)(a,c))}},l=i?u:function(){try{u()}catch(r){T.Deferred.exceptionHook&&T.Deferred.exceptionHook(r,l.error),e+1>=s&&(n!==K&&(a=void 0,c=[r]),t.rejectWith(a,c))}};e?l():(T.Deferred.getErrorHook?l.error=T.Deferred.getErrorHook():T.Deferred.getStackHook&&(l.error=T.Deferred.getStackHook()),r.setTimeout(l))}}return T.Deferred((function(r){t[0][3].add(o(0,r,v(i)?i:J,r.notifyWith)),t[1][3].add(o(0,r,v(e)?e:J)),t[2][3].add(o(0,r,v(n)?n:K))})).promise()},promise:function(e){return null!=e?T.extend(e,i):i}},s={};return T.each(t,(function(e,r){var o=r[2],a=r[5];i[r[1]]=o.add,a&&o.add((function(){n=a}),t[3-e][2].disable,t[3-e][3].disable,t[0][2].lock,t[0][3].lock),o.add(r[3].fire),s[r[0]]=function(){return s[r[0]+"With"](this===s?void 0:this,arguments),this},s[r[0]+"With"]=o.fireWith})),i.promise(s),e&&e.call(s,s),s},when:function(e){var t=arguments.length,n=t,r=Array(n),i=a.call(arguments),s=T.Deferred(),o=function(e){return function(n){r[e]=this,i[e]=arguments.length>1?a.call(arguments):n,--t||s.resolveWith(r,i)}};if(t<=1&&(Y(e,s.done(o(n)).resolve,s.reject,!t),"pending"===s.state()||v(i[n]&&i[n].then)))return s.then();for(;n--;)Y(i[n],o(n),s.reject);return s.promise()}});var X=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;T.Deferred.exceptionHook=function(e,t){r.console&&r.console.warn&&e&&X.test(e.name)&&r.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},T.readyException=function(e){r.setTimeout((function(){throw e}))};var Z=T.Deferred();function Q(){b.removeEventListener("DOMContentLoaded",Q),r.removeEventListener("load",Q),T.ready()}T.fn.ready=function(e){return Z.then(e).catch((function(e){T.readyException(e)})),this},T.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--T.readyWait:T.isReady)||(T.isReady=!0,!0!==e&&--T.readyWait>0||Z.resolveWith(b,[T]))}}),T.ready.then=Z.then,"complete"===b.readyState||"loading"!==b.readyState&&!b.documentElement.doScroll?r.setTimeout(T.ready):(b.addEventListener("DOMContentLoaded",Q),r.addEventListener("load",Q));var ee=function(e,t,n,r,i,s,o){var a=0,c=e.length,u=null==n;if("object"===x(n))for(a in i=!0,n)ee(e,t,a,n[a],!0,s,o);else if(void 0!==r&&(i=!0,v(r)||(o=!0),u&&(o?(t.call(e,r),t=null):(u=t,t=function(e,t,n){return u.call(T(e),n)})),t))for(;a<c;a++)t(e[a],n,o?r:r.call(e[a],a,t(e[a],n)));return i?e:u?t.call(e):c?t(e[0],n):s},te=/^-ms-/,ne=/-([a-z])/g;function re(e,t){return t.toUpperCase()}function ie(e){return e.replace(te,"ms-").replace(ne,re)}var se=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function oe(){this.expando=T.expando+oe.uid++}oe.uid=1,oe.prototype={cache:function(e){var t=e[this.expando];return t||(t={},se(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[ie(t)]=n;else for(r in t)i[ie(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][ie(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(ie):(t=ie(t))in r?[t]:t.match(z)||[]).length;for(;n--;)delete r[t[n]]}(void 0===t||T.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!T.isEmptyObject(t)}};var ae=new oe,ce=new oe,ue=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,le=/[A-Z]/g;function de(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(le,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:ue.test(e)?JSON.parse(e):e)}(n)}catch(e){}ce.set(e,t,n)}else n=void 0;return n}T.extend({hasData:function(e){return ce.hasData(e)||ae.hasData(e)},data:function(e,t,n){return ce.access(e,t,n)},removeData:function(e,t){ce.remove(e,t)},_data:function(e,t,n){return ae.access(e,t,n)},_removeData:function(e,t){ae.remove(e,t)}}),T.fn.extend({data:function(e,t){var n,r,i,s=this[0],o=s&&s.attributes;if(void 0===e){if(this.length&&(i=ce.get(s),1===s.nodeType&&!ae.get(s,"hasDataAttrs"))){for(n=o.length;n--;)o[n]&&0===(r=o[n].name).indexOf("data-")&&(r=ie(r.slice(5)),de(s,r,i[r]));ae.set(s,"hasDataAttrs",!0)}return i}return"object"==typeof e?this.each((function(){ce.set(this,e)})):ee(this,(function(t){var n;if(s&&void 0===t)return void 0!==(n=ce.get(s,e))||void 0!==(n=de(s,e))?n:void 0;this.each((function(){ce.set(this,e,t)}))}),null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each((function(){ce.remove(this,e)}))}}),T.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=ae.get(e,t),n&&(!r||Array.isArray(n)?r=ae.access(e,t,T.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=T.queue(e,t),r=n.length,i=n.shift(),s=T._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete s.stop,i.call(e,(function(){T.dequeue(e,t)}),s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return ae.get(e,n)||ae.access(e,n,{empty:T.Callbacks("once memory").add((function(){ae.remove(e,[t+"queue",n])}))})}}),T.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?T.queue(this[0],e):void 0===t?this:this.each((function(){var n=T.queue(this,e,t);T._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&T.dequeue(this,e)}))},dequeue:function(e){return this.each((function(){T.dequeue(this,e)}))},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=T.Deferred(),s=this,o=this.length,a=function(){--r||i.resolveWith(s,[s])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";o--;)(n=ae.get(s[o],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(a));return a(),i.promise(t)}});var he=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,fe=new RegExp("^(?:([+-])=|)("+he+")([a-z%]*)$","i"),ge=["Top","Right","Bottom","Left"],pe=b.documentElement,me=function(e){return T.contains(e.ownerDocument,e)},ve={composed:!0};pe.getRootNode&&(me=function(e){return T.contains(e.ownerDocument,e)||e.getRootNode(ve)===e.ownerDocument});var ye=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&me(e)&&"none"===T.css(e,"display")};function be(e,t,n,r){var i,s,o=20,a=r?function(){return r.cur()}:function(){return T.css(e,t,"")},c=a(),u=n&&n[3]||(T.cssNumber[t]?"":"px"),l=e.nodeType&&(T.cssNumber[t]||"px"!==u&&+c)&&fe.exec(T.css(e,t));if(l&&l[3]!==u){for(c/=2,u=u||l[3],l=+c||1;o--;)T.style(e,t,l+u),(1-s)*(1-(s=a()/c||.5))<=0&&(o=0),l/=s;l*=2,T.style(e,t,l+u),n=n||[]}return n&&(l=+l||+c||0,i=n[1]?l+(n[1]+1)*n[2]:+n[2],r&&(r.unit=u,r.start=l,r.end=i)),i}var we={};function Ae(e){var t,n=e.ownerDocument,r=e.nodeName,i=we[r];return i||(t=n.body.appendChild(n.createElement(r)),i=T.css(t,"display"),t.parentNode.removeChild(t),"none"===i&&(i="block"),we[r]=i,i)}function xe(e,t){for(var n,r,i=[],s=0,o=e.length;s<o;s++)(r=e[s]).style&&(n=r.style.display,t?("none"===n&&(i[s]=ae.get(r,"display")||null,i[s]||(r.style.display="")),""===r.style.display&&ye(r)&&(i[s]=Ae(r))):"none"!==n&&(i[s]="none",ae.set(r,"display",n)));for(s=0;s<o;s++)null!=i[s]&&(e[s].style.display=i[s]);return e}T.fn.extend({show:function(){return xe(this,!0)},hide:function(){return xe(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each((function(){ye(this)?T(this).show():T(this).hide()}))}});var Ee,Se,Te=/^(?:checkbox|radio)$/i,_e=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,ke=/^$|^module$|\/(?:java|ecma)script/i;Ee=b.createDocumentFragment().appendChild(b.createElement("div")),(Se=b.createElement("input")).setAttribute("type","radio"),Se.setAttribute("checked","checked"),Se.setAttribute("name","t"),Ee.appendChild(Se),m.checkClone=Ee.cloneNode(!0).cloneNode(!0).lastChild.checked,Ee.innerHTML="<textarea>x</textarea>",m.noCloneChecked=!!Ee.cloneNode(!0).lastChild.defaultValue,Ee.innerHTML="<option></option>",m.option=!!Ee.lastChild;var Ce={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Ie(e,t){var n;return n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&k(e,t)?T.merge([e],n):n}function Pe(e,t){for(var n=0,r=e.length;n<r;n++)ae.set(e[n],"globalEval",!t||ae.get(t[n],"globalEval"))}Ce.tbody=Ce.tfoot=Ce.colgroup=Ce.caption=Ce.thead,Ce.th=Ce.td,m.option||(Ce.optgroup=Ce.option=[1,"<select multiple='multiple'>","</select>"]);var Me=/<|&#?\w+;/;function De(e,t,n,r,i){for(var s,o,a,c,u,l,d=t.createDocumentFragment(),h=[],f=0,g=e.length;f<g;f++)if((s=e[f])||0===s)if("object"===x(s))T.merge(h,s.nodeType?[s]:s);else if(Me.test(s)){for(o=o||d.appendChild(t.createElement("div")),a=(_e.exec(s)||["",""])[1].toLowerCase(),c=Ce[a]||Ce._default,o.innerHTML=c[1]+T.htmlPrefilter(s)+c[2],l=c[0];l--;)o=o.lastChild;T.merge(h,o.childNodes),(o=d.firstChild).textContent=""}else h.push(t.createTextNode(s));for(d.textContent="",f=0;s=h[f++];)if(r&&T.inArray(s,r)>-1)i&&i.push(s);else if(u=me(s),o=Ie(d.appendChild(s),"script"),u&&Pe(o),n)for(l=0;s=o[l++];)ke.test(s.type||"")&&n.push(s);return d}var Re=/^([^.]*)(?:\.(.+)|)/;function Le(){return!0}function Oe(){return!1}function Be(e,t,n,r,i,s){var o,a;if("object"==typeof t){for(a in"string"!=typeof n&&(r=r||n,n=void 0),t)Be(e,a,n,r,t[a],s);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=Oe;else if(!i)return e;return 1===s&&(o=i,i=function(e){return T().off(e),o.apply(this,arguments)},i.guid=o.guid||(o.guid=T.guid++)),e.each((function(){T.event.add(this,t,i,r,n)}))}function Ne(e,t,n){n?(ae.set(e,t,!1),T.event.add(e,t,{namespace:!1,handler:function(e){var n,r=ae.get(this,t);if(1&e.isTrigger&&this[t]){if(r)(T.event.special[t]||{}).delegateType&&e.stopPropagation();else if(r=a.call(arguments),ae.set(this,t,r),this[t](),n=ae.get(this,t),ae.set(this,t,!1),r!==n)return e.stopImmediatePropagation(),e.preventDefault(),n}else r&&(ae.set(this,t,T.event.trigger(r[0],r.slice(1),this)),e.stopPropagation(),e.isImmediatePropagationStopped=Le)}})):void 0===ae.get(e,t)&&T.event.add(e,t,Le)}T.event={global:{},add:function(e,t,n,r,i){var s,o,a,c,u,l,d,h,f,g,p,m=ae.get(e);if(se(e))for(n.handler&&(n=(s=n).handler,i=s.selector),i&&T.find.matchesSelector(pe,i),n.guid||(n.guid=T.guid++),(c=m.events)||(c=m.events=Object.create(null)),(o=m.handle)||(o=m.handle=function(t){return void 0!==T&&T.event.triggered!==t.type?T.event.dispatch.apply(e,arguments):void 0}),u=(t=(t||"").match(z)||[""]).length;u--;)f=p=(a=Re.exec(t[u])||[])[1],g=(a[2]||"").split(".").sort(),f&&(d=T.event.special[f]||{},f=(i?d.delegateType:d.bindType)||f,d=T.event.special[f]||{},l=T.extend({type:f,origType:p,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&T.expr.match.needsContext.test(i),namespace:g.join(".")},s),(h=c[f])||((h=c[f]=[]).delegateCount=0,d.setup&&!1!==d.setup.call(e,r,g,o)||e.addEventListener&&e.addEventListener(f,o)),d.add&&(d.add.call(e,l),l.handler.guid||(l.handler.guid=n.guid)),i?h.splice(h.delegateCount++,0,l):h.push(l),T.event.global[f]=!0)},remove:function(e,t,n,r,i){var s,o,a,c,u,l,d,h,f,g,p,m=ae.hasData(e)&&ae.get(e);if(m&&(c=m.events)){for(u=(t=(t||"").match(z)||[""]).length;u--;)if(f=p=(a=Re.exec(t[u])||[])[1],g=(a[2]||"").split(".").sort(),f){for(d=T.event.special[f]||{},h=c[f=(r?d.delegateType:d.bindType)||f]||[],a=a[2]&&new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=h.length;s--;)l=h[s],!i&&p!==l.origType||n&&n.guid!==l.guid||a&&!a.test(l.namespace)||r&&r!==l.selector&&("**"!==r||!l.selector)||(h.splice(s,1),l.selector&&h.delegateCount--,d.remove&&d.remove.call(e,l));o&&!h.length&&(d.teardown&&!1!==d.teardown.call(e,g,m.handle)||T.removeEvent(e,f,m.handle),delete c[f])}else for(f in c)T.event.remove(e,f+t[u],n,r,!0);T.isEmptyObject(c)&&ae.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,s,o,a=new Array(arguments.length),c=T.event.fix(e),u=(ae.get(this,"events")||Object.create(null))[c.type]||[],l=T.event.special[c.type]||{};for(a[0]=c,t=1;t<arguments.length;t++)a[t]=arguments[t];if(c.delegateTarget=this,!l.preDispatch||!1!==l.preDispatch.call(this,c)){for(o=T.event.handlers.call(this,c,u),t=0;(i=o[t++])&&!c.isPropagationStopped();)for(c.currentTarget=i.elem,n=0;(s=i.handlers[n++])&&!c.isImmediatePropagationStopped();)c.rnamespace&&!1!==s.namespace&&!c.rnamespace.test(s.namespace)||(c.handleObj=s,c.data=s.data,void 0!==(r=((T.event.special[s.origType]||{}).handle||s.handler).apply(i.elem,a))&&!1===(c.result=r)&&(c.preventDefault(),c.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,c),c.result}},handlers:function(e,t){var n,r,i,s,o,a=[],c=t.delegateCount,u=e.target;if(c&&u.nodeType&&!("click"===e.type&&e.button>=1))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&("click"!==e.type||!0!==u.disabled)){for(s=[],o={},n=0;n<c;n++)void 0===o[i=(r=t[n]).selector+" "]&&(o[i]=r.needsContext?T(i,this).index(u)>-1:T.find(i,this,null,[u]).length),o[i]&&s.push(r);s.length&&a.push({elem:u,handlers:s})}return u=this,c<t.length&&a.push({elem:u,handlers:t.slice(c)}),a},addProp:function(e,t){Object.defineProperty(T.Event.prototype,e,{enumerable:!0,configurable:!0,get:v(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[T.expando]?e:new T.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return Te.test(t.type)&&t.click&&k(t,"input")&&Ne(t,"click",!0),!1},trigger:function(e){var t=this||e;return Te.test(t.type)&&t.click&&k(t,"input")&&Ne(t,"click"),!0},_default:function(e){var t=e.target;return Te.test(t.type)&&t.click&&k(t,"input")&&ae.get(t,"click")||k(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},T.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},T.Event=function(e,t){if(!(this instanceof T.Event))return new T.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Le:Oe,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&T.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[T.expando]=!0},T.Event.prototype={constructor:T.Event,isDefaultPrevented:Oe,isPropagationStopped:Oe,isImmediatePropagationStopped:Oe,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Le,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Le,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Le,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},T.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},T.event.addProp),T.each({focus:"focusin",blur:"focusout"},(function(e,t){function n(e){if(b.documentMode){var n=ae.get(this,"handle"),r=T.event.fix(e);r.type="focusin"===e.type?"focus":"blur",r.isSimulated=!0,n(e),r.target===r.currentTarget&&n(r)}else T.event.simulate(t,e.target,T.event.fix(e))}T.event.special[e]={setup:function(){var r;if(Ne(this,e,!0),!b.documentMode)return!1;(r=ae.get(this,t))||this.addEventListener(t,n),ae.set(this,t,(r||0)+1)},trigger:function(){return Ne(this,e),!0},teardown:function(){var e;if(!b.documentMode)return!1;(e=ae.get(this,t)-1)?ae.set(this,t,e):(this.removeEventListener(t,n),ae.remove(this,t))},_default:function(t){return ae.get(t.target,e)},delegateType:t},T.event.special[t]={setup:function(){var r=this.ownerDocument||this.document||this,i=b.documentMode?this:r,s=ae.get(i,t);s||(b.documentMode?this.addEventListener(t,n):r.addEventListener(e,n,!0)),ae.set(i,t,(s||0)+1)},teardown:function(){var r=this.ownerDocument||this.document||this,i=b.documentMode?this:r,s=ae.get(i,t)-1;s?ae.set(i,t,s):(b.documentMode?this.removeEventListener(t,n):r.removeEventListener(e,n,!0),ae.remove(i,t))}}})),T.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(e,t){T.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=e.relatedTarget,i=e.handleObj;return r&&(r===this||T.contains(this,r))||(e.type=i.origType,n=i.handler.apply(this,arguments),e.type=t),n}}})),T.fn.extend({on:function(e,t,n,r){return Be(this,e,t,n,r)},one:function(e,t,n,r){return Be(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,T(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Oe),this.each((function(){T.event.remove(this,e,n,t)}))}});var je=/<script|<style|<link/i,Ue=/checked\s*(?:[^=]|=\s*.checked.)/i,Fe=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function $e(e,t){return k(e,"table")&&k(11!==t.nodeType?t:t.firstChild,"tr")&&T(e).children("tbody")[0]||e}function qe(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function He(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function We(e,t){var n,r,i,s,o,a;if(1===t.nodeType){if(ae.hasData(e)&&(a=ae.get(e).events))for(i in ae.remove(t,"handle events"),a)for(n=0,r=a[i].length;n<r;n++)T.event.add(t,i,a[i][n]);ce.hasData(e)&&(s=ce.access(e),o=T.extend({},s),ce.set(t,o))}}function Ge(e,t){var n=t.nodeName.toLowerCase();"input"===n&&Te.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}function Ve(e,t,n,r){t=c(t);var i,s,o,a,u,l,d=0,h=e.length,f=h-1,g=t[0],p=v(g);if(p||h>1&&"string"==typeof g&&!m.checkClone&&Ue.test(g))return e.each((function(i){var s=e.eq(i);p&&(t[0]=g.call(this,i,s.html())),Ve(s,t,n,r)}));if(h&&(s=(i=De(t,e[0].ownerDocument,!1,e,r)).firstChild,1===i.childNodes.length&&(i=s),s||r)){for(a=(o=T.map(Ie(i,"script"),qe)).length;d<h;d++)u=i,d!==f&&(u=T.clone(u,!0,!0),a&&T.merge(o,Ie(u,"script"))),n.call(e[d],u,d);if(a)for(l=o[o.length-1].ownerDocument,T.map(o,He),d=0;d<a;d++)u=o[d],ke.test(u.type||"")&&!ae.access(u,"globalEval")&&T.contains(l,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?T._evalUrl&&!u.noModule&&T._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},l):A(u.textContent.replace(Fe,""),u,l))}return e}function ze(e,t,n){for(var r,i=t?T.filter(t,e):e,s=0;null!=(r=i[s]);s++)n||1!==r.nodeType||T.cleanData(Ie(r)),r.parentNode&&(n&&me(r)&&Pe(Ie(r,"script")),r.parentNode.removeChild(r));return e}T.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,s,o,a=e.cloneNode(!0),c=me(e);if(!(m.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||T.isXMLDoc(e)))for(o=Ie(a),r=0,i=(s=Ie(e)).length;r<i;r++)Ge(s[r],o[r]);if(t)if(n)for(s=s||Ie(e),o=o||Ie(a),r=0,i=s.length;r<i;r++)We(s[r],o[r]);else We(e,a);return(o=Ie(a,"script")).length>0&&Pe(o,!c&&Ie(e,"script")),a},cleanData:function(e){for(var t,n,r,i=T.event.special,s=0;void 0!==(n=e[s]);s++)if(se(n)){if(t=n[ae.expando]){if(t.events)for(r in t.events)i[r]?T.event.remove(n,r):T.removeEvent(n,r,t.handle);n[ae.expando]=void 0}n[ce.expando]&&(n[ce.expando]=void 0)}}}),T.fn.extend({detach:function(e){return ze(this,e,!0)},remove:function(e){return ze(this,e)},text:function(e){return ee(this,(function(e){return void 0===e?T.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)}))}),null,e,arguments.length)},append:function(){return Ve(this,arguments,(function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||$e(this,e).appendChild(e)}))},prepend:function(){return Ve(this,arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=$e(this,e);t.insertBefore(e,t.firstChild)}}))},before:function(){return Ve(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this)}))},after:function(){return Ve(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)}))},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(T.cleanData(Ie(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map((function(){return T.clone(this,e,t)}))},html:function(e){return ee(this,(function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!je.test(e)&&!Ce[(_e.exec(e)||["",""])[1].toLowerCase()]){e=T.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(T.cleanData(Ie(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)}),null,e,arguments.length)},replaceWith:function(){var e=[];return Ve(this,arguments,(function(t){var n=this.parentNode;T.inArray(this,e)<0&&(T.cleanData(Ie(this)),n&&n.replaceChild(t,this))}),e)}}),T.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(e,t){T.fn[e]=function(e){for(var n,r=[],i=T(e),s=i.length-1,o=0;o<=s;o++)n=o===s?this:this.clone(!0),T(i[o])[t](n),u.apply(r,n.get());return this.pushStack(r)}}));var Je=new RegExp("^("+he+")(?!px)[a-z%]+$","i"),Ke=/^--/,Ye=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=r),t.getComputedStyle(e)},Xe=function(e,t,n){var r,i,s={};for(i in t)s[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=s[i];return r},Ze=new RegExp(ge.join("|"),"i");function Qe(e,t,n){var r,i,s,o,a=Ke.test(t),c=e.style;return(n=n||Ye(e))&&(o=n.getPropertyValue(t)||n[t],a&&o&&(o=o.replace(D,"$1")||void 0),""!==o||me(e)||(o=T.style(e,t)),!m.pixelBoxStyles()&&Je.test(o)&&Ze.test(t)&&(r=c.width,i=c.minWidth,s=c.maxWidth,c.minWidth=c.maxWidth=c.width=o,o=n.width,c.width=r,c.minWidth=i,c.maxWidth=s)),void 0!==o?o+"":o}function et(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(l){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",pe.appendChild(u).appendChild(l);var e=r.getComputedStyle(l);n="1%"!==e.top,c=12===t(e.marginLeft),l.style.right="60%",o=36===t(e.right),i=36===t(e.width),l.style.position="absolute",s=12===t(l.offsetWidth/3),pe.removeChild(u),l=null}}function t(e){return Math.round(parseFloat(e))}var n,i,s,o,a,c,u=b.createElement("div"),l=b.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",m.clearCloneStyle="content-box"===l.style.backgroundClip,T.extend(m,{boxSizingReliable:function(){return e(),i},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),c},scrollboxSize:function(){return e(),s},reliableTrDimensions:function(){var e,t,n,i;return null==a&&(e=b.createElement("table"),t=b.createElement("tr"),n=b.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="box-sizing:content-box;border:1px solid",t.style.height="1px",n.style.height="9px",n.style.display="block",pe.appendChild(e).appendChild(t).appendChild(n),i=r.getComputedStyle(t),a=parseInt(i.height,10)+parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10)===t.offsetHeight,pe.removeChild(e)),a}}))}();var tt=["Webkit","Moz","ms"],nt=b.createElement("div").style,rt={};function it(e){var t=T.cssProps[e]||rt[e];return t||(e in nt?e:rt[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),n=tt.length;n--;)if((e=tt[n]+t)in nt)return e}(e)||e)}var st=/^(none|table(?!-c[ea]).+)/,ot={position:"absolute",visibility:"hidden",display:"block"},at={letterSpacing:"0",fontWeight:"400"};function ct(e,t,n){var r=fe.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function ut(e,t,n,r,i,s){var o="width"===t?1:0,a=0,c=0,u=0;if(n===(r?"border":"content"))return 0;for(;o<4;o+=2)"margin"===n&&(u+=T.css(e,n+ge[o],!0,i)),r?("content"===n&&(c-=T.css(e,"padding"+ge[o],!0,i)),"margin"!==n&&(c-=T.css(e,"border"+ge[o]+"Width",!0,i))):(c+=T.css(e,"padding"+ge[o],!0,i),"padding"!==n?c+=T.css(e,"border"+ge[o]+"Width",!0,i):a+=T.css(e,"border"+ge[o]+"Width",!0,i));return!r&&s>=0&&(c+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-s-c-a-.5))||0),c+u}function lt(e,t,n){var r=Ye(e),i=(!m.boxSizingReliable()||n)&&"border-box"===T.css(e,"boxSizing",!1,r),s=i,o=Qe(e,t,r),a="offset"+t[0].toUpperCase()+t.slice(1);if(Je.test(o)){if(!n)return o;o="auto"}return(!m.boxSizingReliable()&&i||!m.reliableTrDimensions()&&k(e,"tr")||"auto"===o||!parseFloat(o)&&"inline"===T.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===T.css(e,"boxSizing",!1,r),(s=a in e)&&(o=e[a])),(o=parseFloat(o)||0)+ut(e,t,n||(i?"border":"content"),s,r,o)+"px"}function dt(e,t,n,r,i){return new dt.prototype.init(e,t,n,r,i)}T.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Qe(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,s,o,a=ie(t),c=Ke.test(t),u=e.style;if(c||(t=it(a)),o=T.cssHooks[t]||T.cssHooks[a],void 0===n)return o&&"get"in o&&void 0!==(i=o.get(e,!1,r))?i:u[t];"string"===(s=typeof n)&&(i=fe.exec(n))&&i[1]&&(n=be(e,t,i),s="number"),null!=n&&n==n&&("number"!==s||c||(n+=i&&i[3]||(T.cssNumber[a]?"":"px")),m.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),o&&"set"in o&&void 0===(n=o.set(e,n,r))||(c?u.setProperty(t,n):u[t]=n))}},css:function(e,t,n,r){var i,s,o,a=ie(t);return Ke.test(t)||(t=it(a)),(o=T.cssHooks[t]||T.cssHooks[a])&&"get"in o&&(i=o.get(e,!0,n)),void 0===i&&(i=Qe(e,t,r)),"normal"===i&&t in at&&(i=at[t]),""===n||n?(s=parseFloat(i),!0===n||isFinite(s)?s||0:i):i}}),T.each(["height","width"],(function(e,t){T.cssHooks[t]={get:function(e,n,r){if(n)return!st.test(T.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?lt(e,t,r):Xe(e,ot,(function(){return lt(e,t,r)}))},set:function(e,n,r){var i,s=Ye(e),o=!m.scrollboxSize()&&"absolute"===s.position,a=(o||r)&&"border-box"===T.css(e,"boxSizing",!1,s),c=r?ut(e,t,r,a,s):0;return a&&o&&(c-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(s[t])-ut(e,t,"border",!1,s)-.5)),c&&(i=fe.exec(n))&&"px"!==(i[3]||"px")&&(e.style[t]=n,n=T.css(e,t)),ct(0,n,c)}}})),T.cssHooks.marginLeft=et(m.reliableMarginLeft,(function(e,t){if(t)return(parseFloat(Qe(e,"marginLeft"))||e.getBoundingClientRect().left-Xe(e,{marginLeft:0},(function(){return e.getBoundingClientRect().left})))+"px"})),T.each({margin:"",padding:"",border:"Width"},(function(e,t){T.cssHooks[e+t]={expand:function(n){for(var r=0,i={},s="string"==typeof n?n.split(" "):[n];r<4;r++)i[e+ge[r]+t]=s[r]||s[r-2]||s[0];return i}},"margin"!==e&&(T.cssHooks[e+t].set=ct)})),T.fn.extend({css:function(e,t){return ee(this,(function(e,t,n){var r,i,s={},o=0;if(Array.isArray(t)){for(r=Ye(e),i=t.length;o<i;o++)s[t[o]]=T.css(e,t[o],!1,r);return s}return void 0!==n?T.style(e,t,n):T.css(e,t)}),e,t,arguments.length>1)}}),T.Tween=dt,dt.prototype={constructor:dt,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||T.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(T.cssNumber[n]?"":"px")},cur:function(){var e=dt.propHooks[this.prop];return e&&e.get?e.get(this):dt.propHooks._default.get(this)},run:function(e){var t,n=dt.propHooks[this.prop];return this.options.duration?this.pos=t=T.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):dt.propHooks._default.set(this),this}},dt.prototype.init.prototype=dt.prototype,dt.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=T.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){T.fx.step[e.prop]?T.fx.step[e.prop](e):1!==e.elem.nodeType||!T.cssHooks[e.prop]&&null==e.elem.style[it(e.prop)]?e.elem[e.prop]=e.now:T.style(e.elem,e.prop,e.now+e.unit)}}},dt.propHooks.scrollTop=dt.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},T.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},T.fx=dt.prototype.init,T.fx.step={};var ht,ft,gt=/^(?:toggle|show|hide)$/,pt=/queueHooks$/;function mt(){ft&&(!1===b.hidden&&r.requestAnimationFrame?r.requestAnimationFrame(mt):r.setTimeout(mt,T.fx.interval),T.fx.tick())}function vt(){return r.setTimeout((function(){ht=void 0})),ht=Date.now()}function yt(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=ge[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function bt(e,t,n){for(var r,i=(wt.tweeners[t]||[]).concat(wt.tweeners["*"]),s=0,o=i.length;s<o;s++)if(r=i[s].call(n,t,e))return r}function wt(e,t,n){var r,i,s=0,o=wt.prefilters.length,a=T.Deferred().always((function(){delete c.elem})),c=function(){if(i)return!1;for(var t=ht||vt(),n=Math.max(0,u.startTime+u.duration-t),r=1-(n/u.duration||0),s=0,o=u.tweens.length;s<o;s++)u.tweens[s].run(r);return a.notifyWith(e,[u,r,n]),r<1&&o?n:(o||a.notifyWith(e,[u,1,0]),a.resolveWith(e,[u]),!1)},u=a.promise({elem:e,props:T.extend({},t),opts:T.extend(!0,{specialEasing:{},easing:T.easing._default},n),originalProperties:t,originalOptions:n,startTime:ht||vt(),duration:n.duration,tweens:[],createTween:function(t,n){var r=T.Tween(e,u.opts,t,n,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(r),r},stop:function(t){var n=0,r=t?u.tweens.length:0;if(i)return this;for(i=!0;n<r;n++)u.tweens[n].run(1);return t?(a.notifyWith(e,[u,1,0]),a.resolveWith(e,[u,t])):a.rejectWith(e,[u,t]),this}}),l=u.props;for(!function(e,t){var n,r,i,s,o;for(n in e)if(i=t[r=ie(n)],s=e[n],Array.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),(o=T.cssHooks[r])&&"expand"in o)for(n in s=o.expand(s),delete e[r],s)n in e||(e[n]=s[n],t[n]=i);else t[r]=i}(l,u.opts.specialEasing);s<o;s++)if(r=wt.prefilters[s].call(u,e,l,u.opts))return v(r.stop)&&(T._queueHooks(u.elem,u.opts.queue).stop=r.stop.bind(r)),r;return T.map(l,bt,u),v(u.opts.start)&&u.opts.start.call(e,u),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always),T.fx.timer(T.extend(c,{elem:e,anim:u,queue:u.opts.queue})),u}T.Animation=T.extend(wt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return be(n.elem,e,fe.exec(t),n),n}]},tweener:function(e,t){v(e)?(t=e,e=["*"]):e=e.match(z);for(var n,r=0,i=e.length;r<i;r++)n=e[r],wt.tweeners[n]=wt.tweeners[n]||[],wt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,s,o,a,c,u,l,d="width"in t||"height"in t,h=this,f={},g=e.style,p=e.nodeType&&ye(e),m=ae.get(e,"fxshow");for(r in n.queue||(null==(o=T._queueHooks(e,"fx")).unqueued&&(o.unqueued=0,a=o.empty.fire,o.empty.fire=function(){o.unqueued||a()}),o.unqueued++,h.always((function(){h.always((function(){o.unqueued--,T.queue(e,"fx").length||o.empty.fire()}))}))),t)if(i=t[r],gt.test(i)){if(delete t[r],s=s||"toggle"===i,i===(p?"hide":"show")){if("show"!==i||!m||void 0===m[r])continue;p=!0}f[r]=m&&m[r]||T.style(e,r)}if((c=!T.isEmptyObject(t))||!T.isEmptyObject(f))for(r in d&&1===e.nodeType&&(n.overflow=[g.overflow,g.overflowX,g.overflowY],null==(u=m&&m.display)&&(u=ae.get(e,"display")),"none"===(l=T.css(e,"display"))&&(u?l=u:(xe([e],!0),u=e.style.display||u,l=T.css(e,"display"),xe([e]))),("inline"===l||"inline-block"===l&&null!=u)&&"none"===T.css(e,"float")&&(c||(h.done((function(){g.display=u})),null==u&&(l=g.display,u="none"===l?"":l)),g.display="inline-block")),n.overflow&&(g.overflow="hidden",h.always((function(){g.overflow=n.overflow[0],g.overflowX=n.overflow[1],g.overflowY=n.overflow[2]}))),c=!1,f)c||(m?"hidden"in m&&(p=m.hidden):m=ae.access(e,"fxshow",{display:u}),s&&(m.hidden=!p),p&&xe([e],!0),h.done((function(){for(r in p||xe([e]),ae.remove(e,"fxshow"),f)T.style(e,r,f[r])}))),c=bt(p?m[r]:0,r,h),r in m||(m[r]=c.start,p&&(c.end=c.start,c.start=0))}],prefilter:function(e,t){t?wt.prefilters.unshift(e):wt.prefilters.push(e)}}),T.speed=function(e,t,n){var r=e&&"object"==typeof e?T.extend({},e):{complete:n||!n&&t||v(e)&&e,duration:e,easing:n&&t||t&&!v(t)&&t};return T.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in T.fx.speeds?r.duration=T.fx.speeds[r.duration]:r.duration=T.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){v(r.old)&&r.old.call(this),r.queue&&T.dequeue(this,r.queue)},r},T.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ye).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=T.isEmptyObject(e),s=T.speed(t,n,r),o=function(){var t=wt(this,T.extend({},e),s);(i||ae.get(this,"finish"))&&t.stop(!0)};return o.finish=o,i||!1===s.queue?this.each(o):this.queue(s.queue,o)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&this.queue(e||"fx",[]),this.each((function(){var t=!0,i=null!=e&&e+"queueHooks",s=T.timers,o=ae.get(this);if(i)o[i]&&o[i].stop&&r(o[i]);else for(i in o)o[i]&&o[i].stop&&pt.test(i)&&r(o[i]);for(i=s.length;i--;)s[i].elem!==this||null!=e&&s[i].queue!==e||(s[i].anim.stop(n),t=!1,s.splice(i,1));!t&&n||T.dequeue(this,e)}))},finish:function(e){return!1!==e&&(e=e||"fx"),this.each((function(){var t,n=ae.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=T.timers,o=r?r.length:0;for(n.finish=!0,T.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;t<o;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish}))}}),T.each(["toggle","show","hide"],(function(e,t){var n=T.fn[t];T.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(yt(t,!0),e,r,i)}})),T.each({slideDown:yt("show"),slideUp:yt("hide"),slideToggle:yt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(e,t){T.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}})),T.timers=[],T.fx.tick=function(){var e,t=0,n=T.timers;for(ht=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||T.fx.stop(),ht=void 0},T.fx.timer=function(e){T.timers.push(e),T.fx.start()},T.fx.interval=13,T.fx.start=function(){ft||(ft=!0,mt())},T.fx.stop=function(){ft=null},T.fx.speeds={slow:600,fast:200,_default:400},T.fn.delay=function(e,t){return e=T.fx&&T.fx.speeds[e]||e,t=t||"fx",this.queue(t,(function(t,n){var i=r.setTimeout(t,e);n.stop=function(){r.clearTimeout(i)}}))},function(){var e=b.createElement("input"),t=b.createElement("select").appendChild(b.createElement("option"));e.type="checkbox",m.checkOn=""!==e.value,m.optSelected=t.selected,(e=b.createElement("input")).value="t",e.type="radio",m.radioValue="t"===e.value}();var At,xt=T.expr.attrHandle;T.fn.extend({attr:function(e,t){return ee(this,T.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each((function(){T.removeAttr(this,e)}))}}),T.extend({attr:function(e,t,n){var r,i,s=e.nodeType;if(3!==s&&8!==s&&2!==s)return void 0===e.getAttribute?T.prop(e,t,n):(1===s&&T.isXMLDoc(e)||(i=T.attrHooks[t.toLowerCase()]||(T.expr.match.bool.test(t)?At:void 0)),void 0!==n?null===n?void T.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=T.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!m.radioValue&&"radio"===t&&k(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(z);if(i&&1===e.nodeType)for(;n=i[r++];)e.removeAttribute(n)}}),At={set:function(e,t,n){return!1===t?T.removeAttr(e,n):e.setAttribute(n,n),n}},T.each(T.expr.match.bool.source.match(/\w+/g),(function(e,t){var n=xt[t]||T.find.attr;xt[t]=function(e,t,r){var i,s,o=t.toLowerCase();return r||(s=xt[o],xt[o]=i,i=null!=n(e,t,r)?o:null,xt[o]=s),i}}));var Et=/^(?:input|select|textarea|button)$/i,St=/^(?:a|area)$/i;function Tt(e){return(e.match(z)||[]).join(" ")}function _t(e){return e.getAttribute&&e.getAttribute("class")||""}function kt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(z)||[]}T.fn.extend({prop:function(e,t){return ee(this,T.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each((function(){delete this[T.propFix[e]||e]}))}}),T.extend({prop:function(e,t,n){var r,i,s=e.nodeType;if(3!==s&&8!==s&&2!==s)return 1===s&&T.isXMLDoc(e)||(t=T.propFix[t]||t,i=T.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=T.find.attr(e,"tabindex");return t?parseInt(t,10):Et.test(e.nodeName)||St.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),m.optSelected||(T.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),T.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){T.propFix[this.toLowerCase()]=this})),T.fn.extend({addClass:function(e){var t,n,r,i,s,o;return v(e)?this.each((function(t){T(this).addClass(e.call(this,t,_t(this)))})):(t=kt(e)).length?this.each((function(){if(r=_t(this),n=1===this.nodeType&&" "+Tt(r)+" "){for(s=0;s<t.length;s++)i=t[s],n.indexOf(" "+i+" ")<0&&(n+=i+" ");o=Tt(n),r!==o&&this.setAttribute("class",o)}})):this},removeClass:function(e){var t,n,r,i,s,o;return v(e)?this.each((function(t){T(this).removeClass(e.call(this,t,_t(this)))})):arguments.length?(t=kt(e)).length?this.each((function(){if(r=_t(this),n=1===this.nodeType&&" "+Tt(r)+" "){for(s=0;s<t.length;s++)for(i=t[s];n.indexOf(" "+i+" ")>-1;)n=n.replace(" "+i+" "," ");o=Tt(n),r!==o&&this.setAttribute("class",o)}})):this:this.attr("class","")},toggleClass:function(e,t){var n,r,i,s,o=typeof e,a="string"===o||Array.isArray(e);return v(e)?this.each((function(n){T(this).toggleClass(e.call(this,n,_t(this),t),t)})):"boolean"==typeof t&&a?t?this.addClass(e):this.removeClass(e):(n=kt(e),this.each((function(){if(a)for(s=T(this),i=0;i<n.length;i++)r=n[i],s.hasClass(r)?s.removeClass(r):s.addClass(r);else void 0!==e&&"boolean"!==o||((r=_t(this))&&ae.set(this,"__className__",r),this.setAttribute&&this.setAttribute("class",r||!1===e?"":ae.get(this,"__className__")||""))})))},hasClass:function(e){var t,n,r=0;for(t=" "+e+" ";n=this[r++];)if(1===n.nodeType&&(" "+Tt(_t(n))+" ").indexOf(t)>-1)return!0;return!1}});var Ct=/\r/g;T.fn.extend({val:function(e){var t,n,r,i=this[0];return arguments.length?(r=v(e),this.each((function(n){var i;1===this.nodeType&&(null==(i=r?e.call(this,n,T(this).val()):e)?i="":"number"==typeof i?i+="":Array.isArray(i)&&(i=T.map(i,(function(e){return null==e?"":e+""}))),(t=T.valHooks[this.type]||T.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,i,"value")||(this.value=i))}))):i?(t=T.valHooks[i.type]||T.valHooks[i.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(i,"value"))?n:"string"==typeof(n=i.value)?n.replace(Ct,""):null==n?"":n:void 0}}),T.extend({valHooks:{option:{get:function(e){var t=T.find.attr(e,"value");return null!=t?t:Tt(T.text(e))}},select:{get:function(e){var t,n,r,i=e.options,s=e.selectedIndex,o="select-one"===e.type,a=o?null:[],c=o?s+1:i.length;for(r=s<0?c:o?s:0;r<c;r++)if(((n=i[r]).selected||r===s)&&!n.disabled&&(!n.parentNode.disabled||!k(n.parentNode,"optgroup"))){if(t=T(n).val(),o)return t;a.push(t)}return a},set:function(e,t){for(var n,r,i=e.options,s=T.makeArray(t),o=i.length;o--;)((r=i[o]).selected=T.inArray(T.valHooks.option.get(r),s)>-1)&&(n=!0);return n||(e.selectedIndex=-1),s}}}}),T.each(["radio","checkbox"],(function(){T.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=T.inArray(T(e).val(),t)>-1}},m.checkOn||(T.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}));var It=r.location,Pt={guid:Date.now()},Mt=/\?/;T.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{t=(new r.DOMParser).parseFromString(e,"text/xml")}catch(e){}return n=t&&t.getElementsByTagName("parsererror")[0],t&&!n||T.error("Invalid XML: "+(n?T.map(n.childNodes,(function(e){return e.textContent})).join("\n"):e)),t};var Dt=/^(?:focusinfocus|focusoutblur)$/,Rt=function(e){e.stopPropagation()};T.extend(T.event,{trigger:function(e,t,n,i){var s,o,a,c,u,l,d,h,g=[n||b],p=f.call(e,"type")?e.type:e,m=f.call(e,"namespace")?e.namespace.split("."):[];if(o=h=a=n=n||b,3!==n.nodeType&&8!==n.nodeType&&!Dt.test(p+T.event.triggered)&&(p.indexOf(".")>-1&&(m=p.split("."),p=m.shift(),m.sort()),u=p.indexOf(":")<0&&"on"+p,(e=e[T.expando]?e:new T.Event(p,"object"==typeof e&&e)).isTrigger=i?2:3,e.namespace=m.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:T.makeArray(t,[e]),d=T.event.special[p]||{},i||!d.trigger||!1!==d.trigger.apply(n,t))){if(!i&&!d.noBubble&&!y(n)){for(c=d.delegateType||p,Dt.test(c+p)||(o=o.parentNode);o;o=o.parentNode)g.push(o),a=o;a===(n.ownerDocument||b)&&g.push(a.defaultView||a.parentWindow||r)}for(s=0;(o=g[s++])&&!e.isPropagationStopped();)h=o,e.type=s>1?c:d.bindType||p,(l=(ae.get(o,"events")||Object.create(null))[e.type]&&ae.get(o,"handle"))&&l.apply(o,t),(l=u&&o[u])&&l.apply&&se(o)&&(e.result=l.apply(o,t),!1===e.result&&e.preventDefault());return e.type=p,i||e.isDefaultPrevented()||d._default&&!1!==d._default.apply(g.pop(),t)||!se(n)||u&&v(n[p])&&!y(n)&&((a=n[u])&&(n[u]=null),T.event.triggered=p,e.isPropagationStopped()&&h.addEventListener(p,Rt),n[p](),e.isPropagationStopped()&&h.removeEventListener(p,Rt),T.event.triggered=void 0,a&&(n[u]=a)),e.result}},simulate:function(e,t,n){var r=T.extend(new T.Event,n,{type:e,isSimulated:!0});T.event.trigger(r,null,t)}}),T.fn.extend({trigger:function(e,t){return this.each((function(){T.event.trigger(e,t,this)}))},triggerHandler:function(e,t){var n=this[0];if(n)return T.event.trigger(e,t,n,!0)}});var Lt=/\[\]$/,Ot=/\r?\n/g,Bt=/^(?:submit|button|image|reset|file)$/i,Nt=/^(?:input|select|textarea|keygen)/i;function jt(e,t,n,r){var i;if(Array.isArray(t))T.each(t,(function(t,i){n||Lt.test(e)?r(e,i):jt(e+"["+("object"==typeof i&&null!=i?t:"")+"]",i,n,r)}));else if(n||"object"!==x(t))r(e,t);else for(i in t)jt(e+"["+i+"]",t[i],n,r)}T.param=function(e,t){var n,r=[],i=function(e,t){var n=v(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!T.isPlainObject(e))T.each(e,(function(){i(this.name,this.value)}));else for(n in e)jt(n,e[n],t,i);return r.join("&")},T.fn.extend({serialize:function(){return T.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var e=T.prop(this,"elements");return e?T.makeArray(e):this})).filter((function(){var e=this.type;return this.name&&!T(this).is(":disabled")&&Nt.test(this.nodeName)&&!Bt.test(e)&&(this.checked||!Te.test(e))})).map((function(e,t){var n=T(this).val();return null==n?null:Array.isArray(n)?T.map(n,(function(e){return{name:t.name,value:e.replace(Ot,"\r\n")}})):{name:t.name,value:n.replace(Ot,"\r\n")}})).get()}});var Ut=/%20/g,Ft=/#.*$/,$t=/([?&])_=[^&]*/,qt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ht=/^(?:GET|HEAD)$/,Wt=/^\/\//,Gt={},Vt={},zt="*/".concat("*"),Jt=b.createElement("a");function Kt(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(z)||[];if(v(n))for(;r=s[i++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function Yt(e,t,n,r){var i={},s=e===Vt;function o(a){var c;return i[a]=!0,T.each(e[a]||[],(function(e,a){var u=a(t,n,r);return"string"!=typeof u||s||i[u]?s?!(c=u):void 0:(t.dataTypes.unshift(u),o(u),!1)})),c}return o(t.dataTypes[0])||!i["*"]&&o("*")}function Xt(e,t){var n,r,i=T.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&T.extend(!0,e,r),e}Jt.href=It.href,T.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:It.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(It.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":zt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":T.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Xt(Xt(e,T.ajaxSettings),t):Xt(T.ajaxSettings,e)},ajaxPrefilter:Kt(Gt),ajaxTransport:Kt(Vt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,i,s,o,a,c,u,l,d,h,f=T.ajaxSetup({},t),g=f.context||f,p=f.context&&(g.nodeType||g.jquery)?T(g):T.event,m=T.Deferred(),v=T.Callbacks("once memory"),y=f.statusCode||{},w={},A={},x="canceled",E={readyState:0,getResponseHeader:function(e){var t;if(u){if(!o)for(o={};t=qt.exec(s);)o[t[1].toLowerCase()+" "]=(o[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=o[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return u?s:null},setRequestHeader:function(e,t){return null==u&&(e=A[e.toLowerCase()]=A[e.toLowerCase()]||e,w[e]=t),this},overrideMimeType:function(e){return null==u&&(f.mimeType=e),this},statusCode:function(e){var t;if(e)if(u)E.always(e[E.status]);else for(t in e)y[t]=[y[t],e[t]];return this},abort:function(e){var t=e||x;return n&&n.abort(t),S(0,t),this}};if(m.promise(E),f.url=((e||f.url||It.href)+"").replace(Wt,It.protocol+"//"),f.type=t.method||t.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match(z)||[""],null==f.crossDomain){c=b.createElement("a");try{c.href=f.url,c.href=c.href,f.crossDomain=Jt.protocol+"//"+Jt.host!=c.protocol+"//"+c.host}catch(e){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=T.param(f.data,f.traditional)),Yt(Gt,f,t,E),u)return E;for(d in(l=T.event&&f.global)&&0==T.active++&&T.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!Ht.test(f.type),i=f.url.replace(Ft,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(Ut,"+")):(h=f.url.slice(i.length),f.data&&(f.processData||"string"==typeof f.data)&&(i+=(Mt.test(i)?"&":"?")+f.data,delete f.data),!1===f.cache&&(i=i.replace($t,"$1"),h=(Mt.test(i)?"&":"?")+"_="+Pt.guid+++h),f.url=i+h),f.ifModified&&(T.lastModified[i]&&E.setRequestHeader("If-Modified-Since",T.lastModified[i]),T.etag[i]&&E.setRequestHeader("If-None-Match",T.etag[i])),(f.data&&f.hasContent&&!1!==f.contentType||t.contentType)&&E.setRequestHeader("Content-Type",f.contentType),E.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+zt+"; q=0.01":""):f.accepts["*"]),f.headers)E.setRequestHeader(d,f.headers[d]);if(f.beforeSend&&(!1===f.beforeSend.call(g,E,f)||u))return E.abort();if(x="abort",v.add(f.complete),E.done(f.success),E.fail(f.error),n=Yt(Vt,f,t,E)){if(E.readyState=1,l&&p.trigger("ajaxSend",[E,f]),u)return E;f.async&&f.timeout>0&&(a=r.setTimeout((function(){E.abort("timeout")}),f.timeout));try{u=!1,n.send(w,S)}catch(e){if(u)throw e;S(-1,e)}}else S(-1,"No Transport");function S(e,t,o,c){var d,h,b,w,A,x=t;u||(u=!0,a&&r.clearTimeout(a),n=void 0,s=c||"",E.readyState=e>0?4:0,d=e>=200&&e<300||304===e,o&&(w=function(e,t,n){for(var r,i,s,o,a=e.contents,c=e.dataTypes;"*"===c[0];)c.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in a)if(a[i]&&a[i].test(r)){c.unshift(i);break}if(c[0]in n)s=c[0];else{for(i in n){if(!c[0]||e.converters[i+" "+c[0]]){s=i;break}o||(o=i)}s=s||o}if(s)return s!==c[0]&&c.unshift(s),n[s]}(f,E,o)),!d&&T.inArray("script",f.dataTypes)>-1&&T.inArray("json",f.dataTypes)<0&&(f.converters["text script"]=function(){}),w=function(e,t,n,r){var i,s,o,a,c,u={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)u[o.toLowerCase()]=e.converters[o];for(s=l.shift();s;)if(e.responseFields[s]&&(n[e.responseFields[s]]=t),!c&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),c=s,s=l.shift())if("*"===s)s=c;else if("*"!==c&&c!==s){if(!(o=u[c+" "+s]||u["* "+s]))for(i in u)if((a=i.split(" "))[1]===s&&(o=u[c+" "+a[0]]||u["* "+a[0]])){!0===o?o=u[i]:!0!==u[i]&&(s=a[0],l.unshift(a[1]));break}if(!0!==o)if(o&&e.throws)t=o(t);else try{t=o(t)}catch(e){return{state:"parsererror",error:o?e:"No conversion from "+c+" to "+s}}}return{state:"success",data:t}}(f,w,E,d),d?(f.ifModified&&((A=E.getResponseHeader("Last-Modified"))&&(T.lastModified[i]=A),(A=E.getResponseHeader("etag"))&&(T.etag[i]=A)),204===e||"HEAD"===f.type?x="nocontent":304===e?x="notmodified":(x=w.state,h=w.data,d=!(b=w.error))):(b=x,!e&&x||(x="error",e<0&&(e=0))),E.status=e,E.statusText=(t||x)+"",d?m.resolveWith(g,[h,x,E]):m.rejectWith(g,[E,x,b]),E.statusCode(y),y=void 0,l&&p.trigger(d?"ajaxSuccess":"ajaxError",[E,f,d?h:b]),v.fireWith(g,[E,x]),l&&(p.trigger("ajaxComplete",[E,f]),--T.active||T.event.trigger("ajaxStop")))}return E},getJSON:function(e,t,n){return T.get(e,t,n,"json")},getScript:function(e,t){return T.get(e,void 0,t,"script")}}),T.each(["get","post"],(function(e,t){T[t]=function(e,n,r,i){return v(n)&&(i=i||r,r=n,n=void 0),T.ajax(T.extend({url:e,type:t,dataType:i,data:n,success:r},T.isPlainObject(e)&&e))}})),T.ajaxPrefilter((function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")})),T._evalUrl=function(e,t,n){return T.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){T.globalEval(e,t,n)}})},T.fn.extend({wrapAll:function(e){var t;return this[0]&&(v(e)&&(e=e.call(this[0])),t=T(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map((function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e})).append(this)),this},wrapInner:function(e){return v(e)?this.each((function(t){T(this).wrapInner(e.call(this,t))})):this.each((function(){var t=T(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)}))},wrap:function(e){var t=v(e);return this.each((function(n){T(this).wrapAll(t?e.call(this,n):e)}))},unwrap:function(e){return this.parent(e).not("body").each((function(){T(this).replaceWith(this.childNodes)})),this}}),T.expr.pseudos.hidden=function(e){return!T.expr.pseudos.visible(e)},T.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},T.ajaxSettings.xhr=function(){try{return new r.XMLHttpRequest}catch(e){}};var Zt={0:200,1223:204},Qt=T.ajaxSettings.xhr();m.cors=!!Qt&&"withCredentials"in Qt,m.ajax=Qt=!!Qt,T.ajaxTransport((function(e){var t,n;if(m.cors||Qt&&!e.crossDomain)return{send:function(i,s){var o,a=e.xhr();if(a.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)a[o]=e.xhrFields[o];for(o in e.mimeType&&a.overrideMimeType&&a.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),i)a.setRequestHeader(o,i[o]);t=function(e){return function(){t&&(t=n=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===e?a.abort():"error"===e?"number"!=typeof a.status?s(0,"error"):s(a.status,a.statusText):s(Zt[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=t(),n=a.onerror=a.ontimeout=t("error"),void 0!==a.onabort?a.onabort=n:a.onreadystatechange=function(){4===a.readyState&&r.setTimeout((function(){t&&n()}))},t=t("abort");try{a.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort:function(){t&&t()}}})),T.ajaxPrefilter((function(e){e.crossDomain&&(e.contents.script=!1)})),T.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return T.globalEval(e),e}}}),T.ajaxPrefilter("script",(function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")})),T.ajaxTransport("script",(function(e){var t,n;if(e.crossDomain||e.scriptAttrs)return{send:function(r,i){t=T("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),b.head.appendChild(t[0])},abort:function(){n&&n()}}}));var en,tn=[],nn=/(=)\?(?=&|$)|\?\?/;T.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=tn.pop()||T.expando+"_"+Pt.guid++;return this[e]=!0,e}}),T.ajaxPrefilter("json jsonp",(function(e,t,n){var i,s,o,a=!1!==e.jsonp&&(nn.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&nn.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return i=e.jsonpCallback=v(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(nn,"$1"+i):!1!==e.jsonp&&(e.url+=(Mt.test(e.url)?"&":"?")+e.jsonp+"="+i),e.converters["script json"]=function(){return o||T.error(i+" was not called"),o[0]},e.dataTypes[0]="json",s=r[i],r[i]=function(){o=arguments},n.always((function(){void 0===s?T(r).removeProp(i):r[i]=s,e[i]&&(e.jsonpCallback=t.jsonpCallback,tn.push(i)),o&&v(s)&&s(o[0]),o=s=void 0})),"script"})),m.createHTMLDocument=((en=b.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===en.childNodes.length),T.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(m.createHTMLDocument?((r=(t=b.implementation.createHTMLDocument("")).createElement("base")).href=b.location.href,t.head.appendChild(r)):t=b),s=!n&&[],(i=F.exec(e))?[t.createElement(i[1])]:(i=De([e],t,s),s&&s.length&&T(s).remove(),T.merge([],i.childNodes)));var r,i,s},T.fn.load=function(e,t,n){var r,i,s,o=this,a=e.indexOf(" ");return a>-1&&(r=Tt(e.slice(a)),e=e.slice(0,a)),v(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),o.length>0&&T.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done((function(e){s=arguments,o.html(r?T("<div>").append(T.parseHTML(e)).find(r):e)})).always(n&&function(e,t){o.each((function(){n.apply(this,s||[e.responseText,t,e])}))}),this},T.expr.pseudos.animated=function(e){return T.grep(T.timers,(function(t){return e===t.elem})).length},T.offset={setOffset:function(e,t,n){var r,i,s,o,a,c,u=T.css(e,"position"),l=T(e),d={};"static"===u&&(e.style.position="relative"),a=l.offset(),s=T.css(e,"top"),c=T.css(e,"left"),("absolute"===u||"fixed"===u)&&(s+c).indexOf("auto")>-1?(o=(r=l.position()).top,i=r.left):(o=parseFloat(s)||0,i=parseFloat(c)||0),v(t)&&(t=t.call(e,n,T.extend({},a))),null!=t.top&&(d.top=t.top-a.top+o),null!=t.left&&(d.left=t.left-a.left+i),"using"in t?t.using.call(e,d):l.css(d)}},T.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each((function(t){T.offset.setOffset(this,e,t)}));var t,n,r=this[0];return r?r.getClientRects().length?(t=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===T.css(r,"position"))t=r.getBoundingClientRect();else{for(t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===T.css(e,"position");)e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=T(e).offset()).top+=T.css(e,"borderTopWidth",!0),i.left+=T.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-T.css(r,"marginTop",!0),left:t.left-i.left-T.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent;e&&"static"===T.css(e,"position");)e=e.offsetParent;return e||pe}))}}),T.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(e,t){var n="pageYOffset"===t;T.fn[e]=function(r){return ee(this,(function(e,r,i){var s;if(y(e)?s=e:9===e.nodeType&&(s=e.defaultView),void 0===i)return s?s[t]:e[r];s?s.scrollTo(n?s.pageXOffset:i,n?i:s.pageYOffset):e[r]=i}),e,r,arguments.length)}})),T.each(["top","left"],(function(e,t){T.cssHooks[t]=et(m.pixelPosition,(function(e,n){if(n)return n=Qe(e,t),Je.test(n)?T(e).position()[t]+"px":n}))})),T.each({Height:"height",Width:"width"},(function(e,t){T.each({padding:"inner"+e,content:t,"":"outer"+e},(function(n,r){T.fn[r]=function(i,s){var o=arguments.length&&(n||"boolean"!=typeof i),a=n||(!0===i||!0===s?"margin":"border");return ee(this,(function(t,n,i){var s;return y(t)?0===r.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(s=t.documentElement,Math.max(t.body["scroll"+e],s["scroll"+e],t.body["offset"+e],s["offset"+e],s["client"+e])):void 0===i?T.css(t,n,a):T.style(t,n,i,a)}),t,o?i:void 0,o)}}))})),T.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(e,t){T.fn[t]=function(e){return this.on(t,e)}})),T.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.on("mouseenter",e).on("mouseleave",t||e)}}),T.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(e,t){T.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}));var rn=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;T.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),v(e))return r=a.call(arguments,2),i=function(){return e.apply(t||this,r.concat(a.call(arguments)))},i.guid=e.guid=e.guid||T.guid++,i},T.holdReady=function(e){e?T.readyWait++:T.ready(!0)},T.isArray=Array.isArray,T.parseJSON=JSON.parse,T.nodeName=k,T.isFunction=v,T.isWindow=y,T.camelCase=ie,T.type=x,T.now=Date.now,T.isNumeric=function(e){var t=T.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},T.trim=function(e){return null==e?"":(e+"").replace(rn,"$1")},void 0===(n=function(){return T}.apply(t,[]))||(e.exports=n);var sn=r.jQuery,on=r.$;return T.noConflict=function(e){return r.$===T&&(r.$=on),e&&r.jQuery===T&&(r.jQuery=sn),T},void 0===i&&(r.jQuery=r.$=T),T}))},65905:e=>{var t=Object.prototype.toString,n=Array.isArray;e.exports=function(e){return"string"==typeof e||!n(e)&&function(e){return!!e&&"object"==typeof e}(e)&&"[object String]"==t.call(e)}},41169:(e,t,n)=>{var r,i,s,o,a;r=n(59957),i=n(31761).utf8,s=n(68872),o=n(31761).bin,(a=function(e,t){e.constructor==String?e=t&&"binary"===t.encoding?o.stringToBytes(e):i.stringToBytes(e):s(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||e.constructor===Uint8Array||(e=e.toString());for(var n=r.bytesToWords(e),c=8*e.length,u=1732584193,l=-271733879,d=-1732584194,h=271733878,f=0;f<n.length;f++)n[f]=16711935&(n[f]<<8|n[f]>>>24)|4278255360&(n[f]<<24|n[f]>>>8);n[c>>>5]|=128<<c%32,n[14+(c+64>>>9<<4)]=c;var g=a._ff,p=a._gg,m=a._hh,v=a._ii;for(f=0;f<n.length;f+=16){var y=u,b=l,w=d,A=h;u=g(u,l,d,h,n[f+0],7,-680876936),h=g(h,u,l,d,n[f+1],12,-389564586),d=g(d,h,u,l,n[f+2],17,606105819),l=g(l,d,h,u,n[f+3],22,-1044525330),u=g(u,l,d,h,n[f+4],7,-176418897),h=g(h,u,l,d,n[f+5],12,1200080426),d=g(d,h,u,l,n[f+6],17,-1473231341),l=g(l,d,h,u,n[f+7],22,-45705983),u=g(u,l,d,h,n[f+8],7,1770035416),h=g(h,u,l,d,n[f+9],12,-1958414417),d=g(d,h,u,l,n[f+10],17,-42063),l=g(l,d,h,u,n[f+11],22,-1990404162),u=g(u,l,d,h,n[f+12],7,1804603682),h=g(h,u,l,d,n[f+13],12,-40341101),d=g(d,h,u,l,n[f+14],17,-1502002290),u=p(u,l=g(l,d,h,u,n[f+15],22,1236535329),d,h,n[f+1],5,-165796510),h=p(h,u,l,d,n[f+6],9,-1069501632),d=p(d,h,u,l,n[f+11],14,643717713),l=p(l,d,h,u,n[f+0],20,-373897302),u=p(u,l,d,h,n[f+5],5,-701558691),h=p(h,u,l,d,n[f+10],9,38016083),d=p(d,h,u,l,n[f+15],14,-660478335),l=p(l,d,h,u,n[f+4],20,-405537848),u=p(u,l,d,h,n[f+9],5,568446438),h=p(h,u,l,d,n[f+14],9,-1019803690),d=p(d,h,u,l,n[f+3],14,-187363961),l=p(l,d,h,u,n[f+8],20,1163531501),u=p(u,l,d,h,n[f+13],5,-1444681467),h=p(h,u,l,d,n[f+2],9,-51403784),d=p(d,h,u,l,n[f+7],14,1735328473),u=m(u,l=p(l,d,h,u,n[f+12],20,-1926607734),d,h,n[f+5],4,-378558),h=m(h,u,l,d,n[f+8],11,-2022574463),d=m(d,h,u,l,n[f+11],16,1839030562),l=m(l,d,h,u,n[f+14],23,-35309556),u=m(u,l,d,h,n[f+1],4,-1530992060),h=m(h,u,l,d,n[f+4],11,1272893353),d=m(d,h,u,l,n[f+7],16,-155497632),l=m(l,d,h,u,n[f+10],23,-1094730640),u=m(u,l,d,h,n[f+13],4,681279174),h=m(h,u,l,d,n[f+0],11,-358537222),d=m(d,h,u,l,n[f+3],16,-722521979),l=m(l,d,h,u,n[f+6],23,76029189),u=m(u,l,d,h,n[f+9],4,-640364487),h=m(h,u,l,d,n[f+12],11,-421815835),d=m(d,h,u,l,n[f+15],16,530742520),u=v(u,l=m(l,d,h,u,n[f+2],23,-995338651),d,h,n[f+0],6,-198630844),h=v(h,u,l,d,n[f+7],10,1126891415),d=v(d,h,u,l,n[f+14],15,-1416354905),l=v(l,d,h,u,n[f+5],21,-57434055),u=v(u,l,d,h,n[f+12],6,1700485571),h=v(h,u,l,d,n[f+3],10,-1894986606),d=v(d,h,u,l,n[f+10],15,-1051523),l=v(l,d,h,u,n[f+1],21,-2054922799),u=v(u,l,d,h,n[f+8],6,1873313359),h=v(h,u,l,d,n[f+15],10,-30611744),d=v(d,h,u,l,n[f+6],15,-1560198380),l=v(l,d,h,u,n[f+13],21,1309151649),u=v(u,l,d,h,n[f+4],6,-145523070),h=v(h,u,l,d,n[f+11],10,-1120210379),d=v(d,h,u,l,n[f+2],15,718787259),l=v(l,d,h,u,n[f+9],21,-343485551),u=u+y>>>0,l=l+b>>>0,d=d+w>>>0,h=h+A>>>0}return r.endian([u,l,d,h])})._ff=function(e,t,n,r,i,s,o){var a=e+(t&n|~t&r)+(i>>>0)+o;return(a<<s|a>>>32-s)+t},a._gg=function(e,t,n,r,i,s,o){var a=e+(t&r|n&~r)+(i>>>0)+o;return(a<<s|a>>>32-s)+t},a._hh=function(e,t,n,r,i,s,o){var a=e+(t^n^r)+(i>>>0)+o;return(a<<s|a>>>32-s)+t},a._ii=function(e,t,n,r,i,s,o){var a=e+(n^(t|~r))+(i>>>0)+o;return(a<<s|a>>>32-s)+t},a._blocksize=16,a._digestsize=16,e.exports=function(e,t){if(null==e)throw new Error("Illegal argument "+e);var n=r.wordsToBytes(a(e,t));return t&&t.asBytes?n:t&&t.asString?o.bytesToString(n):r.bytesToHex(n)}},9964:e=>{var t,n,r=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var a,c=[],u=!1,l=-1;function d(){u&&a&&(u=!1,a.length?c=a.concat(c):l=-1,c.length&&h())}function h(){if(!u){var e=o(d);u=!0;for(var t=c.length;t;){for(a=c,c=[];++l<t;)a&&a[l].run();l=-1,t=c.length}a=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function g(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new f(e,t)),1!==c.length||u||o(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},30457:function(e,t){var n,r,i;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,r=[e],n=function(e){"use strict";if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)e.exports=globalThis.browser;else{const t="The message port closed before a response was received.",n=e=>{const n={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(n).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class r extends WeakMap{constructor(e,t=void 0){super(t),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const i=e=>e&&"object"==typeof e&&"function"==typeof e.then,s=(t,n)=>(...r)=>{e.runtime.lastError?t.reject(new Error(e.runtime.lastError.message)):n.singleCallbackArg||r.length<=1&&!1!==n.singleCallbackArg?t.resolve(r[0]):t.resolve(r)},o=e=>1==e?"argument":"arguments",a=(e,t)=>function(n,...r){if(r.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${o(t.minArgs)} for ${e}(), got ${r.length}`);if(r.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${o(t.maxArgs)} for ${e}(), got ${r.length}`);return new Promise(((i,o)=>{if(t.fallbackToNoCallback)try{n[e](...r,s({resolve:i,reject:o},t))}catch(s){n[e](...r),t.fallbackToNoCallback=!1,t.noCallback=!0,i()}else t.noCallback?(n[e](...r),i()):n[e](...r,s({resolve:i,reject:o},t))}))},c=(e,t,n)=>new Proxy(t,{apply:(t,r,i)=>n.call(r,e,...i)});let u=Function.call.bind(Object.prototype.hasOwnProperty);const l=(e,t={},n={})=>{let r=Object.create(null),i={has:(t,n)=>n in e||n in r,get(i,s,o){if(s in r)return r[s];if(!(s in e))return;let d=e[s];if("function"==typeof d)if("function"==typeof t[s])d=c(e,e[s],t[s]);else if(u(n,s)){let t=a(s,n[s]);d=c(e,e[s],t)}else d=d.bind(e);else if("object"==typeof d&&null!==d&&(u(t,s)||u(n,s)))d=l(d,t[s],n[s]);else{if(!u(n,"*"))return Object.defineProperty(r,s,{configurable:!0,enumerable:!0,get:()=>e[s],set(t){e[s]=t}}),d;d=l(d,t[s],n["*"])}return r[s]=d,d},set:(t,n,i,s)=>(n in r?r[n]=i:e[n]=i,!0),defineProperty:(e,t,n)=>Reflect.defineProperty(r,t,n),deleteProperty:(e,t)=>Reflect.deleteProperty(r,t)},s=Object.create(e);return new Proxy(s,i)},d=e=>({addListener(t,n,...r){t.addListener(e.get(n),...r)},hasListener:(t,n)=>t.hasListener(e.get(n)),removeListener(t,n){t.removeListener(e.get(n))}}),h=new r((e=>"function"!=typeof e?e:function(t){const n=l(t,{},{getContent:{minArgs:0,maxArgs:0}});e(n)})),f=new r((e=>"function"!=typeof e?e:function(t,n,r){let s,o,a=!1,c=new Promise((e=>{s=function(t){a=!0,e(t)}}));try{o=e(t,n,s)}catch(e){o=Promise.reject(e)}const u=!0!==o&&i(o);if(!0!==o&&!u&&!a)return!1;const l=e=>{e.then((e=>{r(e)}),(e=>{let t;t=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",r({__mozWebExtensionPolyfillReject__:!0,message:t})})).catch((e=>{}))};return l(u?o:c),!0})),g=({reject:n,resolve:r},i)=>{e.runtime.lastError?e.runtime.lastError.message===t?r():n(new Error(e.runtime.lastError.message)):i&&i.__mozWebExtensionPolyfillReject__?n(new Error(i.message)):r(i)},p=(e,t,n,...r)=>{if(r.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${o(t.minArgs)} for ${e}(), got ${r.length}`);if(r.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${o(t.maxArgs)} for ${e}(), got ${r.length}`);return new Promise(((e,t)=>{const i=g.bind(null,{resolve:e,reject:t});r.push(i),n.sendMessage(...r)}))},m={devtools:{network:{onRequestFinished:d(h)}},runtime:{onMessage:d(f),onMessageExternal:d(f),sendMessage:p.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:p.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},v={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return n.privacy={network:{"*":v},services:{"*":v},websites:{"*":v}},l(e,m,n)};e.exports=n(chrome)}},void 0===(i="function"==typeof n?n.apply(t,r):n)||(e.exports=i)},45091:(e,t,n)=>{"use strict";n.r(t),n.d(t,{VERSION:()=>i,after:()=>Lt,all:()=>en,allKeys:()=>me,any:()=>tn,assign:()=>Le,before:()=>Ot,bind:()=>xt,bindAll:()=>Tt,chain:()=>yt,chunk:()=>jn,clone:()=>je,collect:()=>Jt,compact:()=>kn,compose:()=>Rt,constant:()=>Z,contains:()=>nn,countBy:()=>vn,create:()=>Ne,debounce:()=>Pt,default:()=>Hn,defaults:()=>Oe,defer:()=>Ct,delay:()=>kt,detect:()=>Gt,difference:()=>In,drop:()=>Tn,each:()=>zt,escape:()=>ot,every:()=>en,extend:()=>Re,extendOwn:()=>Le,filter:()=>Zt,find:()=>Gt,findIndex:()=>Ut,findKey:()=>Nt,findLastIndex:()=>Ft,findWhere:()=>Vt,first:()=>Sn,flatten:()=>Cn,foldl:()=>Yt,foldr:()=>Xt,forEach:()=>zt,functions:()=>Me,get:()=>He,groupBy:()=>pn,has:()=>We,head:()=>Sn,identity:()=>Ge,include:()=>nn,includes:()=>nn,indexBy:()=>mn,indexOf:()=>Ht,initial:()=>En,inject:()=>Yt,intersection:()=>Rn,invert:()=>Pe,invoke:()=>rn,isArguments:()=>K,isArray:()=>V,isArrayBuffer:()=>N,isBoolean:()=>C,isDataView:()=>G,isDate:()=>R,isElement:()=>I,isEmpty:()=>ce,isEqual:()=>pe,isError:()=>O,isFinite:()=>Y,isFunction:()=>F,isMap:()=>Se,isMatch:()=>ue,isNaN:()=>X,isNull:()=>_,isNumber:()=>D,isObject:()=>T,isRegExp:()=>L,isSet:()=>_e,isString:()=>M,isSymbol:()=>B,isTypedArray:()=>ie,isUndefined:()=>k,isWeakMap:()=>Te,isWeakSet:()=>ke,iteratee:()=>Ye,keys:()=>ae,last:()=>_n,lastIndexOf:()=>Wt,map:()=>Jt,mapObject:()=>Ze,matcher:()=>Ve,matches:()=>Ve,max:()=>an,memoize:()=>_t,methods:()=>Me,min:()=>cn,mixin:()=>Fn,negate:()=>Dt,noop:()=>Qe,now:()=>rt,object:()=>Bn,omit:()=>xn,once:()=>Bt,pairs:()=>Ie,partial:()=>At,partition:()=>yn,pick:()=>An,pluck:()=>sn,property:()=>ze,propertyOf:()=>et,random:()=>nt,range:()=>Nn,reduce:()=>Yt,reduceRight:()=>Xt,reject:()=>Qt,rest:()=>Tn,restArguments:()=>S,result:()=>pt,sample:()=>dn,select:()=>Zt,shuffle:()=>hn,size:()=>bn,some:()=>tn,sortBy:()=>fn,sortedIndex:()=>$t,tail:()=>Tn,take:()=>Sn,tap:()=>Ue,template:()=>gt,templateSettings:()=>ct,throttle:()=>It,times:()=>tt,toArray:()=>ln,toPath:()=>Fe,transpose:()=>Ln,unescape:()=>at,union:()=>Dn,uniq:()=>Mn,unique:()=>Mn,uniqueId:()=>vt,unzip:()=>Ln,values:()=>Ce,where:()=>on,without:()=>Pn,wrap:()=>Mt,zip:()=>On});var r={};n.r(r),n.d(r,{VERSION:()=>i,after:()=>Lt,all:()=>en,allKeys:()=>me,any:()=>tn,assign:()=>Le,before:()=>Ot,bind:()=>xt,bindAll:()=>Tt,chain:()=>yt,chunk:()=>jn,clone:()=>je,collect:()=>Jt,compact:()=>kn,compose:()=>Rt,constant:()=>Z,contains:()=>nn,countBy:()=>vn,create:()=>Ne,debounce:()=>Pt,default:()=>$n,defaults:()=>Oe,defer:()=>Ct,delay:()=>kt,detect:()=>Gt,difference:()=>In,drop:()=>Tn,each:()=>zt,escape:()=>ot,every:()=>en,extend:()=>Re,extendOwn:()=>Le,filter:()=>Zt,find:()=>Gt,findIndex:()=>Ut,findKey:()=>Nt,findLastIndex:()=>Ft,findWhere:()=>Vt,first:()=>Sn,flatten:()=>Cn,foldl:()=>Yt,foldr:()=>Xt,forEach:()=>zt,functions:()=>Me,get:()=>He,groupBy:()=>pn,has:()=>We,head:()=>Sn,identity:()=>Ge,include:()=>nn,includes:()=>nn,indexBy:()=>mn,indexOf:()=>Ht,initial:()=>En,inject:()=>Yt,intersection:()=>Rn,invert:()=>Pe,invoke:()=>rn,isArguments:()=>K,isArray:()=>V,isArrayBuffer:()=>N,isBoolean:()=>C,isDataView:()=>G,isDate:()=>R,isElement:()=>I,isEmpty:()=>ce,isEqual:()=>pe,isError:()=>O,isFinite:()=>Y,isFunction:()=>F,isMap:()=>Se,isMatch:()=>ue,isNaN:()=>X,isNull:()=>_,isNumber:()=>D,isObject:()=>T,isRegExp:()=>L,isSet:()=>_e,isString:()=>M,isSymbol:()=>B,isTypedArray:()=>ie,isUndefined:()=>k,isWeakMap:()=>Te,isWeakSet:()=>ke,iteratee:()=>Ye,keys:()=>ae,last:()=>_n,lastIndexOf:()=>Wt,map:()=>Jt,mapObject:()=>Ze,matcher:()=>Ve,matches:()=>Ve,max:()=>an,memoize:()=>_t,methods:()=>Me,min:()=>cn,mixin:()=>Fn,negate:()=>Dt,noop:()=>Qe,now:()=>rt,object:()=>Bn,omit:()=>xn,once:()=>Bt,pairs:()=>Ie,partial:()=>At,partition:()=>yn,pick:()=>An,pluck:()=>sn,property:()=>ze,propertyOf:()=>et,random:()=>nt,range:()=>Nn,reduce:()=>Yt,reduceRight:()=>Xt,reject:()=>Qt,rest:()=>Tn,restArguments:()=>S,result:()=>pt,sample:()=>dn,select:()=>Zt,shuffle:()=>hn,size:()=>bn,some:()=>tn,sortBy:()=>fn,sortedIndex:()=>$t,tail:()=>Tn,take:()=>Sn,tap:()=>Ue,template:()=>gt,templateSettings:()=>ct,throttle:()=>It,times:()=>tt,toArray:()=>ln,toPath:()=>Fe,transpose:()=>Ln,unescape:()=>at,union:()=>Dn,uniq:()=>Mn,unique:()=>Mn,uniqueId:()=>vt,unzip:()=>Ln,values:()=>Ce,where:()=>on,without:()=>Pn,wrap:()=>Mt,zip:()=>On});var i="1.13.7",s="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||Function("return this")()||{},o=Array.prototype,a=Object.prototype,c="undefined"!=typeof Symbol?Symbol.prototype:null,u=o.push,l=o.slice,d=a.toString,h=a.hasOwnProperty,f="undefined"!=typeof ArrayBuffer,g="undefined"!=typeof DataView,p=Array.isArray,m=Object.keys,v=Object.create,y=f&&ArrayBuffer.isView,b=isNaN,w=isFinite,A=!{toString:null}.propertyIsEnumerable("toString"),x=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],E=Math.pow(2,53)-1;function S(e,t){return t=null==t?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),r=Array(n),i=0;i<n;i++)r[i]=arguments[i+t];switch(t){case 0:return e.call(this,r);case 1:return e.call(this,arguments[0],r);case 2:return e.call(this,arguments[0],arguments[1],r)}var s=Array(t+1);for(i=0;i<t;i++)s[i]=arguments[i];return s[t]=r,e.apply(this,s)}}function T(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function _(e){return null===e}function k(e){return void 0===e}function C(e){return!0===e||!1===e||"[object Boolean]"===d.call(e)}function I(e){return!(!e||1!==e.nodeType)}function P(e){var t="[object "+e+"]";return function(e){return d.call(e)===t}}const M=P("String"),D=P("Number"),R=P("Date"),L=P("RegExp"),O=P("Error"),B=P("Symbol"),N=P("ArrayBuffer");var j=P("Function"),U=s.document&&s.document.childNodes;"object"!=typeof Int8Array&&"function"!=typeof U&&(j=function(e){return"function"==typeof e||!1});const F=j,$=P("Object");var q=g&&(!/\[native code\]/.test(String(DataView))||$(new DataView(new ArrayBuffer(8)))),H="undefined"!=typeof Map&&$(new Map),W=P("DataView");const G=q?function(e){return null!=e&&F(e.getInt8)&&N(e.buffer)}:W,V=p||P("Array");function z(e,t){return null!=e&&h.call(e,t)}var J=P("Arguments");!function(){J(arguments)||(J=function(e){return z(e,"callee")})}();const K=J;function Y(e){return!B(e)&&w(e)&&!isNaN(parseFloat(e))}function X(e){return D(e)&&b(e)}function Z(e){return function(){return e}}function Q(e){return function(t){var n=e(t);return"number"==typeof n&&n>=0&&n<=E}}function ee(e){return function(t){return null==t?void 0:t[e]}}const te=ee("byteLength"),ne=Q(te);var re=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;const ie=f?function(e){return y?y(e)&&!G(e):ne(e)&&re.test(d.call(e))}:Z(!1),se=ee("length");function oe(e,t){t=function(e){for(var t={},n=e.length,r=0;r<n;++r)t[e[r]]=!0;return{contains:function(e){return!0===t[e]},push:function(n){return t[n]=!0,e.push(n)}}}(t);var n=x.length,r=e.constructor,i=F(r)&&r.prototype||a,s="constructor";for(z(e,s)&&!t.contains(s)&&t.push(s);n--;)(s=x[n])in e&&e[s]!==i[s]&&!t.contains(s)&&t.push(s)}function ae(e){if(!T(e))return[];if(m)return m(e);var t=[];for(var n in e)z(e,n)&&t.push(n);return A&&oe(e,t),t}function ce(e){if(null==e)return!0;var t=se(e);return"number"==typeof t&&(V(e)||M(e)||K(e))?0===t:0===se(ae(e))}function ue(e,t){var n=ae(t),r=n.length;if(null==e)return!r;for(var i=Object(e),s=0;s<r;s++){var o=n[s];if(t[o]!==i[o]||!(o in i))return!1}return!0}function le(e){return e instanceof le?e:this instanceof le?void(this._wrapped=e):new le(e)}function de(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,te(e))}le.VERSION=i,le.prototype.value=function(){return this._wrapped},le.prototype.valueOf=le.prototype.toJSON=le.prototype.value,le.prototype.toString=function(){return String(this._wrapped)};var he="[object DataView]";function fe(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!=e)return t!=t;var i=typeof e;return("function"===i||"object"===i||"object"==typeof t)&&ge(e,t,n,r)}function ge(e,t,n,r){e instanceof le&&(e=e._wrapped),t instanceof le&&(t=t._wrapped);var i=d.call(e);if(i!==d.call(t))return!1;if(q&&"[object Object]"==i&&G(e)){if(!G(t))return!1;i=he}switch(i){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return c.valueOf.call(e)===c.valueOf.call(t);case"[object ArrayBuffer]":case he:return ge(de(e),de(t),n,r)}var s="[object Array]"===i;if(!s&&ie(e)){if(te(e)!==te(t))return!1;if(e.buffer===t.buffer&&e.byteOffset===t.byteOffset)return!0;s=!0}if(!s){if("object"!=typeof e||"object"!=typeof t)return!1;var o=e.constructor,a=t.constructor;if(o!==a&&!(F(o)&&o instanceof o&&F(a)&&a instanceof a)&&"constructor"in e&&"constructor"in t)return!1}r=r||[];for(var u=(n=n||[]).length;u--;)if(n[u]===e)return r[u]===t;if(n.push(e),r.push(t),s){if((u=e.length)!==t.length)return!1;for(;u--;)if(!fe(e[u],t[u],n,r))return!1}else{var l,h=ae(e);if(u=h.length,ae(t).length!==u)return!1;for(;u--;)if(!z(t,l=h[u])||!fe(e[l],t[l],n,r))return!1}return n.pop(),r.pop(),!0}function pe(e,t){return fe(e,t)}function me(e){if(!T(e))return[];var t=[];for(var n in e)t.push(n);return A&&oe(e,t),t}function ve(e){var t=se(e);return function(n){if(null==n)return!1;var r=me(n);if(se(r))return!1;for(var i=0;i<t;i++)if(!F(n[e[i]]))return!1;return e!==xe||!F(n[ye])}}var ye="forEach",be=["clear","delete"],we=["get","has","set"],Ae=be.concat(ye,we),xe=be.concat(we),Ee=["add"].concat(be,ye,"has");const Se=H?ve(Ae):P("Map"),Te=H?ve(xe):P("WeakMap"),_e=H?ve(Ee):P("Set"),ke=P("WeakSet");function Ce(e){for(var t=ae(e),n=t.length,r=Array(n),i=0;i<n;i++)r[i]=e[t[i]];return r}function Ie(e){for(var t=ae(e),n=t.length,r=Array(n),i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r}function Pe(e){for(var t={},n=ae(e),r=0,i=n.length;r<i;r++)t[e[n[r]]]=n[r];return t}function Me(e){var t=[];for(var n in e)F(e[n])&&t.push(n);return t.sort()}function De(e,t){return function(n){var r=arguments.length;if(t&&(n=Object(n)),r<2||null==n)return n;for(var i=1;i<r;i++)for(var s=arguments[i],o=e(s),a=o.length,c=0;c<a;c++){var u=o[c];t&&void 0!==n[u]||(n[u]=s[u])}return n}}const Re=De(me),Le=De(ae),Oe=De(me,!0);function Be(e){if(!T(e))return{};if(v)return v(e);var t=function(){};t.prototype=e;var n=new t;return t.prototype=null,n}function Ne(e,t){var n=Be(e);return t&&Le(n,t),n}function je(e){return T(e)?V(e)?e.slice():Re({},e):e}function Ue(e,t){return t(e),e}function Fe(e){return V(e)?e:[e]}function $e(e){return le.toPath(e)}function qe(e,t){for(var n=t.length,r=0;r<n;r++){if(null==e)return;e=e[t[r]]}return n?e:void 0}function He(e,t,n){var r=qe(e,$e(t));return k(r)?n:r}function We(e,t){for(var n=(t=$e(t)).length,r=0;r<n;r++){var i=t[r];if(!z(e,i))return!1;e=e[i]}return!!n}function Ge(e){return e}function Ve(e){return e=Le({},e),function(t){return ue(t,e)}}function ze(e){return e=$e(e),function(t){return qe(t,e)}}function Je(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,s){return e.call(t,n,r,i,s)}}return function(){return e.apply(t,arguments)}}function Ke(e,t,n){return null==e?Ge:F(e)?Je(e,t,n):T(e)&&!V(e)?Ve(e):ze(e)}function Ye(e,t){return Ke(e,t,1/0)}function Xe(e,t,n){return le.iteratee!==Ye?le.iteratee(e,t):Ke(e,t,n)}function Ze(e,t,n){t=Xe(t,n);for(var r=ae(e),i=r.length,s={},o=0;o<i;o++){var a=r[o];s[a]=t(e[a],a,e)}return s}function Qe(){}function et(e){return null==e?Qe:function(t){return He(e,t)}}function tt(e,t,n){var r=Array(Math.max(0,e));t=Je(t,n,1);for(var i=0;i<e;i++)r[i]=t(i);return r}function nt(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}le.toPath=Fe,le.iteratee=Ye;const rt=Date.now||function(){return(new Date).getTime()};function it(e){var t=function(t){return e[t]},n="(?:"+ae(e).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(e){return e=null==e?"":""+e,r.test(e)?e.replace(i,t):e}}const st={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},ot=it(st),at=it(Pe(st)),ct=le.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var ut=/(.)^/,lt={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},dt=/\\|'|\r|\n|\u2028|\u2029/g;function ht(e){return"\\"+lt[e]}var ft=/^\s*(\w|\$)+\s*$/;function gt(e,t,n){!t&&n&&(t=n),t=Oe({},t,le.templateSettings);var r=RegExp([(t.escape||ut).source,(t.interpolate||ut).source,(t.evaluate||ut).source].join("|")+"|$","g"),i=0,s="__p+='";e.replace(r,(function(t,n,r,o,a){return s+=e.slice(i,a).replace(dt,ht),i=a+t.length,n?s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?s+="'+\n((__t=("+r+"))==null?'':__t)+\n'":o&&(s+="';\n"+o+"\n__p+='"),t})),s+="';\n";var o,a=t.variable;if(a){if(!ft.test(a))throw new Error("variable is not a bare identifier: "+a)}else s="with(obj||{}){\n"+s+"}\n",a="obj";s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{o=new Function(a,"_",s)}catch(e){throw e.source=s,e}var c=function(e){return o.call(this,e,le)};return c.source="function("+a+"){\n"+s+"}",c}function pt(e,t,n){var r=(t=$e(t)).length;if(!r)return F(n)?n.call(e):n;for(var i=0;i<r;i++){var s=null==e?void 0:e[t[i]];void 0===s&&(s=n,i=r),e=F(s)?s.call(e):s}return e}var mt=0;function vt(e){var t=++mt+"";return e?e+t:t}function yt(e){var t=le(e);return t._chain=!0,t}function bt(e,t,n,r,i){if(!(r instanceof t))return e.apply(n,i);var s=Be(e.prototype),o=e.apply(s,i);return T(o)?o:s}var wt=S((function(e,t){var n=wt.placeholder,r=function(){for(var i=0,s=t.length,o=Array(s),a=0;a<s;a++)o[a]=t[a]===n?arguments[i++]:t[a];for(;i<arguments.length;)o.push(arguments[i++]);return bt(e,r,this,this,o)};return r}));wt.placeholder=le;const At=wt,xt=S((function(e,t,n){if(!F(e))throw new TypeError("Bind must be called on a function");var r=S((function(i){return bt(e,r,t,this,n.concat(i))}));return r})),Et=Q(se);function St(e,t,n,r){if(r=r||[],t||0===t){if(t<=0)return r.concat(e)}else t=1/0;for(var i=r.length,s=0,o=se(e);s<o;s++){var a=e[s];if(Et(a)&&(V(a)||K(a)))if(t>1)St(a,t-1,n,r),i=r.length;else for(var c=0,u=a.length;c<u;)r[i++]=a[c++];else n||(r[i++]=a)}return r}const Tt=S((function(e,t){var n=(t=St(t,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=t[n];e[r]=xt(e[r],e)}return e}));function _t(e,t){var n=function(r){var i=n.cache,s=""+(t?t.apply(this,arguments):r);return z(i,s)||(i[s]=e.apply(this,arguments)),i[s]};return n.cache={},n}const kt=S((function(e,t,n){return setTimeout((function(){return e.apply(null,n)}),t)})),Ct=At(kt,le,1);function It(e,t,n){var r,i,s,o,a=0;n||(n={});var c=function(){a=!1===n.leading?0:rt(),r=null,o=e.apply(i,s),r||(i=s=null)},u=function(){var u=rt();a||!1!==n.leading||(a=u);var l=t-(u-a);return i=this,s=arguments,l<=0||l>t?(r&&(clearTimeout(r),r=null),a=u,o=e.apply(i,s),r||(i=s=null)):r||!1===n.trailing||(r=setTimeout(c,l)),o};return u.cancel=function(){clearTimeout(r),a=0,r=i=s=null},u}function Pt(e,t,n){var r,i,s,o,a,c=function(){var u=rt()-i;t>u?r=setTimeout(c,t-u):(r=null,n||(o=e.apply(a,s)),r||(s=a=null))},u=S((function(u){return a=this,s=u,i=rt(),r||(r=setTimeout(c,t),n&&(o=e.apply(a,s))),o}));return u.cancel=function(){clearTimeout(r),r=s=a=null},u}function Mt(e,t){return At(t,e)}function Dt(e){return function(){return!e.apply(this,arguments)}}function Rt(){var e=arguments,t=e.length-1;return function(){for(var n=t,r=e[t].apply(this,arguments);n--;)r=e[n].call(this,r);return r}}function Lt(e,t){return function(){if(--e<1)return t.apply(this,arguments)}}function Ot(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}}const Bt=At(Ot,2);function Nt(e,t,n){t=Xe(t,n);for(var r,i=ae(e),s=0,o=i.length;s<o;s++)if(t(e[r=i[s]],r,e))return r}function jt(e){return function(t,n,r){n=Xe(n,r);for(var i=se(t),s=e>0?0:i-1;s>=0&&s<i;s+=e)if(n(t[s],s,t))return s;return-1}}const Ut=jt(1),Ft=jt(-1);function $t(e,t,n,r){for(var i=(n=Xe(n,r,1))(t),s=0,o=se(e);s<o;){var a=Math.floor((s+o)/2);n(e[a])<i?s=a+1:o=a}return s}function qt(e,t,n){return function(r,i,s){var o=0,a=se(r);if("number"==typeof s)e>0?o=s>=0?s:Math.max(s+a,o):a=s>=0?Math.min(s+1,a):s+a+1;else if(n&&s&&a)return r[s=n(r,i)]===i?s:-1;if(i!=i)return(s=t(l.call(r,o,a),X))>=0?s+o:-1;for(s=e>0?o:a-1;s>=0&&s<a;s+=e)if(r[s]===i)return s;return-1}}const Ht=qt(1,Ut,$t),Wt=qt(-1,Ft);function Gt(e,t,n){var r=(Et(e)?Ut:Nt)(e,t,n);if(void 0!==r&&-1!==r)return e[r]}function Vt(e,t){return Gt(e,Ve(t))}function zt(e,t,n){var r,i;if(t=Je(t,n),Et(e))for(r=0,i=e.length;r<i;r++)t(e[r],r,e);else{var s=ae(e);for(r=0,i=s.length;r<i;r++)t(e[s[r]],s[r],e)}return e}function Jt(e,t,n){t=Xe(t,n);for(var r=!Et(e)&&ae(e),i=(r||e).length,s=Array(i),o=0;o<i;o++){var a=r?r[o]:o;s[o]=t(e[a],a,e)}return s}function Kt(e){return function(t,n,r,i){var s=arguments.length>=3;return function(t,n,r,i){var s=!Et(t)&&ae(t),o=(s||t).length,a=e>0?0:o-1;for(i||(r=t[s?s[a]:a],a+=e);a>=0&&a<o;a+=e){var c=s?s[a]:a;r=n(r,t[c],c,t)}return r}(t,Je(n,i,4),r,s)}}const Yt=Kt(1),Xt=Kt(-1);function Zt(e,t,n){var r=[];return t=Xe(t,n),zt(e,(function(e,n,i){t(e,n,i)&&r.push(e)})),r}function Qt(e,t,n){return Zt(e,Dt(Xe(t)),n)}function en(e,t,n){t=Xe(t,n);for(var r=!Et(e)&&ae(e),i=(r||e).length,s=0;s<i;s++){var o=r?r[s]:s;if(!t(e[o],o,e))return!1}return!0}function tn(e,t,n){t=Xe(t,n);for(var r=!Et(e)&&ae(e),i=(r||e).length,s=0;s<i;s++){var o=r?r[s]:s;if(t(e[o],o,e))return!0}return!1}function nn(e,t,n,r){return Et(e)||(e=Ce(e)),("number"!=typeof n||r)&&(n=0),Ht(e,t,n)>=0}const rn=S((function(e,t,n){var r,i;return F(t)?i=t:(t=$e(t),r=t.slice(0,-1),t=t[t.length-1]),Jt(e,(function(e){var s=i;if(!s){if(r&&r.length&&(e=qe(e,r)),null==e)return;s=e[t]}return null==s?s:s.apply(e,n)}))}));function sn(e,t){return Jt(e,ze(t))}function on(e,t){return Zt(e,Ve(t))}function an(e,t,n){var r,i,s=-1/0,o=-1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var a=0,c=(e=Et(e)?e:Ce(e)).length;a<c;a++)null!=(r=e[a])&&r>s&&(s=r);else t=Xe(t,n),zt(e,(function(e,n,r){((i=t(e,n,r))>o||i===-1/0&&s===-1/0)&&(s=e,o=i)}));return s}function cn(e,t,n){var r,i,s=1/0,o=1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var a=0,c=(e=Et(e)?e:Ce(e)).length;a<c;a++)null!=(r=e[a])&&r<s&&(s=r);else t=Xe(t,n),zt(e,(function(e,n,r){((i=t(e,n,r))<o||i===1/0&&s===1/0)&&(s=e,o=i)}));return s}var un=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function ln(e){return e?V(e)?l.call(e):M(e)?e.match(un):Et(e)?Jt(e,Ge):Ce(e):[]}function dn(e,t,n){if(null==t||n)return Et(e)||(e=Ce(e)),e[nt(e.length-1)];var r=ln(e),i=se(r);t=Math.max(Math.min(t,i),0);for(var s=i-1,o=0;o<t;o++){var a=nt(o,s),c=r[o];r[o]=r[a],r[a]=c}return r.slice(0,t)}function hn(e){return dn(e,1/0)}function fn(e,t,n){var r=0;return t=Xe(t,n),sn(Jt(e,(function(e,n,i){return{value:e,index:r++,criteria:t(e,n,i)}})).sort((function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return e.index-t.index})),"value")}function gn(e,t){return function(n,r,i){var s=t?[[],[]]:{};return r=Xe(r,i),zt(n,(function(t,i){var o=r(t,i,n);e(s,t,o)})),s}}const pn=gn((function(e,t,n){z(e,n)?e[n].push(t):e[n]=[t]})),mn=gn((function(e,t,n){e[n]=t})),vn=gn((function(e,t,n){z(e,n)?e[n]++:e[n]=1})),yn=gn((function(e,t,n){e[n?0:1].push(t)}),!0);function bn(e){return null==e?0:Et(e)?e.length:ae(e).length}function wn(e,t,n){return t in n}const An=S((function(e,t){var n={},r=t[0];if(null==e)return n;F(r)?(t.length>1&&(r=Je(r,t[1])),t=me(e)):(r=wn,t=St(t,!1,!1),e=Object(e));for(var i=0,s=t.length;i<s;i++){var o=t[i],a=e[o];r(a,o,e)&&(n[o]=a)}return n})),xn=S((function(e,t){var n,r=t[0];return F(r)?(r=Dt(r),t.length>1&&(n=t[1])):(t=Jt(St(t,!1,!1),String),r=function(e,n){return!nn(t,n)}),An(e,r,n)}));function En(e,t,n){return l.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))}function Sn(e,t,n){return null==e||e.length<1?null==t||n?void 0:[]:null==t||n?e[0]:En(e,e.length-t)}function Tn(e,t,n){return l.call(e,null==t||n?1:t)}function _n(e,t,n){return null==e||e.length<1?null==t||n?void 0:[]:null==t||n?e[e.length-1]:Tn(e,Math.max(0,e.length-t))}function kn(e){return Zt(e,Boolean)}function Cn(e,t){return St(e,t,!1)}const In=S((function(e,t){return t=St(t,!0,!0),Zt(e,(function(e){return!nn(t,e)}))})),Pn=S((function(e,t){return In(e,t)}));function Mn(e,t,n,r){C(t)||(r=n,n=t,t=!1),null!=n&&(n=Xe(n,r));for(var i=[],s=[],o=0,a=se(e);o<a;o++){var c=e[o],u=n?n(c,o,e):c;t&&!n?(o&&s===u||i.push(c),s=u):n?nn(s,u)||(s.push(u),i.push(c)):nn(i,c)||i.push(c)}return i}const Dn=S((function(e){return Mn(St(e,!0,!0))}));function Rn(e){for(var t=[],n=arguments.length,r=0,i=se(e);r<i;r++){var s=e[r];if(!nn(t,s)){var o;for(o=1;o<n&&nn(arguments[o],s);o++);o===n&&t.push(s)}}return t}function Ln(e){for(var t=e&&an(e,se).length||0,n=Array(t),r=0;r<t;r++)n[r]=sn(e,r);return n}const On=S(Ln);function Bn(e,t){for(var n={},r=0,i=se(e);r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n}function Nn(e,t,n){null==t&&(t=e||0,e=0),n||(n=t<e?-1:1);for(var r=Math.max(Math.ceil((t-e)/n),0),i=Array(r),s=0;s<r;s++,e+=n)i[s]=e;return i}function jn(e,t){if(null==t||t<1)return[];for(var n=[],r=0,i=e.length;r<i;)n.push(l.call(e,r,r+=t));return n}function Un(e,t){return e._chain?le(t).chain():t}function Fn(e){return zt(Me(e),(function(t){var n=le[t]=e[t];le.prototype[t]=function(){var e=[this._wrapped];return u.apply(e,arguments),Un(this,n.apply(le,e))}})),le}zt(["pop","push","reverse","shift","sort","splice","unshift"],(function(e){var t=o[e];le.prototype[e]=function(){var n=this._wrapped;return null!=n&&(t.apply(n,arguments),"shift"!==e&&"splice"!==e||0!==n.length||delete n[0]),Un(this,n)}})),zt(["concat","join","slice"],(function(e){var t=o[e];le.prototype[e]=function(){var e=this._wrapped;return null!=e&&(e=t.apply(e,arguments)),Un(this,e)}}));const $n=le;var qn=Fn(r);qn._=qn;const Hn=qn}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var s=r[e]={exports:{}};return n[e].call(s.exports,s,s.exports,i),s.exports}i.m=n,(()=>{let e,t;try{"undefined"!=typeof browser&&"function"==typeof browser.runtime?.getURL&&(t=browser)}catch(e){}if(!t)try{"undefined"!=typeof chrome&&"function"==typeof chrome.runtime?.getURL&&(e=!0,t=chrome)}catch(e){}i.webExtRtModern=!e,i.webExtRt=t||{get runtime(){throw new Error("No chrome or browser runtime found")}},t||"object"==typeof self&&self.addEventListener||(i.webExtRt={runtime:{getURL:String}})})(),i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"==typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"==typeof n.then)return n}var s=Object.create(null);i.r(s);var o={};e=e||[null,t({}),t([]),t(t)];for(var a=2&r&&n;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>o[e]=()=>n[e]));return o.default=()=>n,i.d(s,o),s},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,n)=>(i.f[n](e,t),t)),[])),i.u=e=>"js/"+(404===e?"pako":e)+".js",i.miniCssF=e=>{},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{let e;i.g.importScripts&&(e=i.g.location+"");const t=i.g.document;if(!e&&t?.currentScript&&(e=t.currentScript.src),!e){if(!i.webExtRt)throw new Error("Automatic publicPath is not supported in this browser");e=i.webExtRt.runtime.getURL("/")}e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e+"../"})(),(()=>{var e={130:1};i.f.i=(t,n)=>{e[t]||importScripts(i.p+i.u(t))};var t=self.webpackChunksource=self.webpackChunksource||[],n=t.push.bind(t);t.push=t=>{var[r,s,o]=t;for(var a in s)i.o(s,a)&&(i.m[a]=s[a]);for(o&&o(i);r.length;)e[r.pop()]=1;n(t)}})(),i.webExtRt.runtime.onMessage.addListener(((e,t,n)=>{if("WTW_INJECT"!=e?.type||"number"!=typeof t?.tab?.id)return;let r=e.file;try{r=new URL(r).pathname}catch(e){}if(r){if(i.webExtRt.scripting)i.webExtRt.scripting.executeScript({target:{tabId:t.tab.id,frameIds:[t.frameId]},files:[r]}).then(n);else{const e={frameId:t.frameId,file:r,matchAboutBlank:!0};i.webExtRtModern?i.webExtRt.tabs.executeScript(t.tab.id,e).then(n):i.webExtRt.tabs.executeScript(t.tab.id,e,n)}return!0}})),i.f.i(404),i.f.i(814);(()=>{"use strict";var e={};i.r(e),i.d(e,{BusinessCard:()=>il,CouponScraper:()=>pl,Groupon:()=>rl,HomeDomain:()=>nl,InStoreCashBack:()=>sl,InstalledExtensions:()=>gl,Merchant:()=>ol,PriceMagic:()=>al,ProcessInterstitial:()=>cl,ProductPageTracker:()=>ll,PromoNotification:()=>yl,Serp:()=>hl,SimilarStores:()=>ml,TaxesPromo:()=>fl,TcppNotification:()=>vl});var t=i(30457),n=i.n(t),r=i(29058),s=i.n(r);const o="unknown";var a,c;!function(e){e[e.DOCUMENTCOMPLETE=0]="DOCUMENTCOMPLETE",e[e.BEFORENAVIGATE=1]="BEFORENAVIGATE",e[e.TABCHANGED=2]="TABCHANGED",e[e.TABUPDATED=3]="TABUPDATED",e[e.NAVIGATIONCOMMITTED=4]="NAVIGATIONCOMMITTED",e[e.TABCLOSED=5]="TABCLOSED"}(a||(a={})),function(e){e[e.NEWTAB=-1]="NEWTAB",e[e.CURRENTTAB=-2]="CURRENTTAB",e[e.NEWWINDOW=-3]="NEWWINDOW",e[e.ALLTABS=-4]="ALLTABS",e[e.BACKGROUNDTAB=-6]="BACKGROUNDTAB"}(c||(c={}));class u{name="chromium";version=o;isLegacyEdge=!1;isWebkitEdge=!1;isChrome=!1;isFirefox=!1;isEdge=!1;isWebkit=!1;isLegacySafari=!1;isSafariApp=!1;isSafariWebext=!1;isSafariMobile=!1;isSafari=!1;DOCUMENTCOMPLETE=a.DOCUMENTCOMPLETE;BEFORENAVIGATE=a.BEFORENAVIGATE;TABCHANGED=a.TABCHANGED;TABUPDATED=a.TABUPDATED;NAVIGATIONCOMMITTED=a.NAVIGATIONCOMMITTED;TABCLOSED=a.TABCLOSED;NEWTAB=c.NEWTAB;CURRENTTAB=c.CURRENTTAB;NEWWINDOW=c.NEWWINDOW;ALLTABS=c.ALLTABS;BACKGROUNDTAB=c.BACKGROUNDTAB;constructor(){this.parseUserAgent(),this.isLegacyEdge="Edge"===this.name,this.isWebkitEdge="WebkitEdge"===this.name,this.isChrome="Chrome"===this.name,this.isFirefox="Firefox"===this.name,this.isEdge=this.isLegacyEdge||this.isWebkitEdge,this.isWebkit=this.isChrome||this.isWebkitEdge||"Opera"===this.name||"Avast"===this.name,this.isLegacySafari=!1,this.isSafariApp=!1,this.isSafari=this.isLegacySafari||this.isSafariApp||this.isSafariWebext||this.isSafariMobile}parseUserAgentData(e){const t={"Google Chrome":"Chrome","Microsoft Edge":"WebkitEdge",Opera:"Opera"};e.brands?.forEach((e=>{t[e.brand]&&(this.name=t[e.brand],this.version=e.version)}))}parseUserAgent(){if(navigator.userAgentData)this.parseUserAgentData(navigator.userAgentData);else if(navigator.userAgent){const e=navigator.userAgent;if(/Safari\/.+/i.test(e)&&!/(Chrome|Chromium)\/.+/i.test(e))/\b(iPad|iPhone|iPod)\b/.test(e)?(this.name="Safari Mobile",this.isSafariMobile=!0):(this.name="Safari",this.isSafariWebext=!0),this.version=e.match(/ Version\/(.+?) /i)?.[1]||o;else{const[,t,n]=e.match(/.*(opr|yabrowser|mrchrome|chrome|firefox|edge|edg|avast)\/?\s*([.\d]+)/i)||[];if("object"==typeof chrome&&"object"==typeof chrome.avast)this.name="Avast";else switch(t?.toLowerCase()){case"avast":this.name="Avast";break;case"opr":this.name="Opera";break;case"firefox":this.name="Firefox";break;case"edge":this.name="Edge";break;case"edg":this.name="WebkitEdge";break;default:this.name="Chrome"}this.version=n||o}}}}const l=class extends u{tabManager=[];fnCallbacks={};oPendingNavigates={};constructor(){super(),this.closeTab=this.removeTab,this.on=this.attachEvent,this.emit=this.fireEvent,s().tabs.onActivated.addListener((async e=>{this.oPendingNavigates[e.tabId]&&this.navigate(this.oPendingNavigates[e.tabId]);const t=await s().tabs.get(e.tabId);s().runtime.lastError||this.tabChanged(t)})),s().windows.onFocusChanged.addListener((async e=>{if(e!==s().windows.WINDOW_ID_NONE){const t=await s().tabs.query({windowId:e,active:!0});t&&this.tabChanged(t.pop())}})),s().tabs.onRemoved.addListener((e=>{this.tabManager.splice(e,1),this.fireEvent(a.TABCLOSED,{name:a.TABCLOSED,tabId:e,url:this.tabManager[e]?.url??""})})),s().tabs.onUpdated.addListener(((e,t,n)=>{const r=n.url;r&&(this.tabManager[e]={url:r},this.fireEvent(a.TABUPDATED,{name:a.TABUPDATED,tabId:e,url:r,status:t.status}))})),s().webNavigation&&(s().webNavigation.onCommitted.addListener((e=>this.fireWebNavigationEvent(a.NAVIGATIONCOMMITTED,e))),s().webNavigation.onDOMContentLoaded.addListener((e=>this.fireWebNavigationEvent(a.DOCUMENTCOMPLETE,e)))),s().webRequest?.onBeforeRequest.addListener((e=>this.onBeforeRequestHandler(e)),{urls:["<all_urls>"],types:["main_frame"]}),s().runtime.onMessage.addListener((e=>this.onMessageHandler(e)))}onBeforeRequestHandler(e){(0===e.frameId||this.isSafariWebext&&0===e.parentFrameId)&&e.url&&this.fireEvent(a.BEFORENAVIGATE,{name:a.BEFORENAVIGATE,tabId:e.tabId,url:e.url})}async fireWebNavigationEvent(e,t){if(0!==t.frameId)return Promise.resolve();let n=t.tabId;if(this.isSafariWebext&&0===n){const e=await s().tabs.query({active:!0,currentWindow:!0});if(e.length>0){const t=e[0];t?.id&&(n=t.id)}}try{const r=await s().tabs.get(n);!s().runtime.lastError&&r&&this.fireEvent(e,{name:e,tabId:n,url:t.url,active:r.active})}catch{}}onMessageHandler(e){return new Promise((t=>{switch(e.action){case"ci_browser_navigate":this.navigate(e).then(t);break;case"ci_browser_redirect":this.redirect(e).then(t)}}))}navigate(e,t=()=>{}){const n=new Promise((t=>{let n;n="string"==typeof e?{url:e,tabId:c.NEWTAB}:e;const r=n.tabId||c.CURRENTTAB,i=n.url,o={url:i};switch(r){case c.NEWTAB:o.active=!0,void 0!==n.active&&(o.active=n.active),void 0!==n.pinned&&(o.pinned=n.pinned),s().tabs.create(o).then(t);break;case c.BACKGROUNDTAB:o.active=!1,void 0!==n.pinned&&(o.pinned=n.pinned),s().tabs.create(o).then(t);break;case c.CURRENTTAB:this.redirect(n.url).then(t);break;case c.NEWWINDOW:s().windows.create({url:i,focused:!0}).then(t);break;default:s().tabs.get(n.tabId).then((e=>{!s().runtime.lastError&&e?(s().tabs.update(n.tabId,o).then(t),delete this.oPendingNavigates[n.tabId]):this.oPendingNavigates[n.tabId]=n}))}}));return n.then(t),n}redirect(e,t=()=>{}){const n=new Promise((t=>{const n="object"==typeof e?e.url:e;s().tabs.query({active:!0,currentWindow:!0}).then((e=>{e.length>0&&s().tabs.update(e[0].id,{url:n}).then(t),t(null)}))}));return n.then(t),n}attachEvent(e,t){this.fnCallbacks[e]||(this.fnCallbacks[e]=[]),this.fnCallbacks[e].push(t)}detachEvent(e,t){if(this.fnCallbacks[e])for(let n=this.fnCallbacks[e].length-1;n>=0;n--)this.fnCallbacks[e][n]&&t===this.fnCallbacks[e][n]&&this.fnCallbacks[e].splice(n,1)}fireEvent(e,t){this.fnCallbacks[e]?.forEach((e=>{"function"==typeof e&&e.call(this,t)}))}tabChanged(e){if(e){const t={action:"event",data:{name:a.TABCHANGED,tabId:e.id,url:e.url}};e.id&&0!==e.url?.indexOf("chrome://")&&s().tabs.sendMessage(e.id,t).catch((e=>{})),this.fireEvent(a.TABCHANGED,t.data)}}removeTab(e){s().tabs.remove("number"==typeof e?e:e.id)}};class d{constructor(){const e=s().runtime.getManifest();this.settings={name:e.name,version:e.version,optionsPage:e.options_ui}}get name(){return this.settings.name}get version(){return this.settings.version}get optionsPage(){return this.settings.optionsPage}getItem(e,t=()=>{}){const n=new Promise((t=>{"string"==typeof e||Array.isArray(e)?s().storage.local.get(e).then((n=>{t("string"==typeof e?n?n[e]:null:n)})):t(null)}));return n.then(t),n}setItem(e,t){return"string"==typeof e?void 0===t?s().storage.local.remove(e):s().storage.local.set({[e]:t}):"object"==typeof e?s().storage.local.set(e):Promise.reject()}getURL(e){return s().runtime.getURL(e)}}const h=class extends d{fnCallbacks={};fnListeners={};constructor(){super(),this.on=this.attachEvent,this.emit=this.fireEvent,s().runtime.onMessage.addListener(((e,t)=>this.onMessageHandler(e,t))),s().runtime.onMessageExternal?.addListener(((e,t)=>this.onMessageExternalHandler(e,t)))}onMessageHandler({action:e,data:t,name:n},r){return new Promise((i=>{if("event"===e)if(t?.tabId){const e={action:"event",name:n,data:t.data,tabId:t.tabId};t.tabId===c.ALLTABS?this.broadcastEvent(e).then(i):s().tabs.sendMessage(t.tabId,e).then(i)}else if(this.fnCallbacks[n]){const e={url:r.tab?.url??r.url??"",tabId:r.tab?.id??0,data:t.data};this.fnCallbacks[n].forEach((t=>{2===t.length?t.call(this,e,i):i(t.call(this,e,(()=>{})))}))}else{this.fnListeners[n]||(this.fnListeners[n]=[]);const e={url:r.tab?.url??r.url??"",tabId:r.tab?.id??0,data:t.data};this.fnListeners[n].push({listener:i,message:e})}}))}onMessageExternalHandler({action:e,data:t,name:n},r){return new Promise((i=>{if("event"===e&&r.id&&this.fnCallbacks[n]){const e={name:n,url:r.tab?r.tab.url:r.url,extensionId:r.id};t&&(e.data=t.data),r.tab&&(e.tabId=r.tab.id),this.fnCallbacks[n].forEach((t=>{2===t.length?t.call(this,e,i):i(t.call(this,e,(()=>{})))}))}else i(null)}))}attachEvent(e,t){this.fnListeners[e]&&(this.fnListeners[e].forEach((({listener:e,message:n})=>{t.call(this,n,e)})),delete this.fnListeners[e]),this.fnCallbacks[e]||(this.fnCallbacks[e]=[]),this.fnCallbacks[e].push(t)}detachEvent(e,t){const n=this.fnCallbacks[e];if(n)for(let e=n.length-1;e>=0;e--)n[e]&&t===n[e]&&n.splice(e,1)}fireEvent(e,{tabId:t,data:n,extensionId:r}={},i=function(){}){const o="event";const a=new Promise((i=>{if(r)s().runtime.sendMessage(r,{action:o,name:e,data:{data:n}}).then(i);else if(t===c.ALLTABS)this.broadcastEvent({action:o,name:e,data:{data:n}}).then(i);else if(t&&function(e){return!isNaN(parseInt(e,10))&&isFinite(e)}(t)&&t>=0){const r={action:o,name:e,data:{data:n},tabId:t};s().tabs.sendMessage(t,r).then(i).catch((e=>{}))}else s().tabs.query({active:!0,currentWindow:!0}).then((t=>{const r=t?.[0];if(r?.id&&r.url&&-1===r.url.indexOf("chrome://")){const t={action:o,name:e,data:{data:n},tabId:r.id};s().tabs.sendMessage(r.id,t).then(i).catch((e=>{}))}}));if(this.fnCallbacks[e]){const t={tabId:0,data:n,url:""};this.fnCallbacks[e].forEach((e=>{e.call(this,t,i)}))}}));return a.then(i),a}async broadcastEvent(e){try{const t=await s().windows.getAll({populate:!0});return new Promise((n=>{t.forEach((t=>{t.tabs?.forEach((t=>{if(t.id&&t.url&&-1===t.url.indexOf("chrome://")&&-1===t.url.indexOf("about:")){const r={...e,tabId:t.id};s().tabs.sendMessage(t.id,r).then(n).catch((e=>{}))}}))}))}))}catch{}}},f=[],g="ButtonClick";function p(e){for(const t of f)try{t({tabId:e.id,url:e.url,name:g})}catch{}}function m(e){const t=/rgb\((\d+), (\d+), (\d+)\)/.exec(e);return t?[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10),255]:e}const v=class{advised=!1;CLICK=g;constructor(){this.on=this.attachEvent}get browserAction(){return s().action??s().browserAction}attachEvent(e,t){e===this.CLICK&&(this.advised||(this.browserAction?.onClicked.addListener(p),this.advised=!0),f.push(t))}detachEvent(e,t){if(e===this.CLICK){for(let e=f.length-1;e>=0;e--)f[e]===t&&f.splice(e,1);0===f.length&&(this.advised=!1,this.browserAction?.onClicked.removeListener(p))}}setIcon(e){return this.browserAction?.setIcon({path:e})}setPopup(e){const t=e?e.url:"";return this.browserAction?.setPopup({popup:t})}setTitle(e){return this.browserAction?.setTitle({title:e})}setBadgeText(e){return this.browserAction?.setBadgeText({text:e.toString()})}setBadgeBackgroundColor(e){return this.browserAction?.setBadgeBackgroundColor({color:m(e)})}setBadgeTextColor(e){return this.browserAction?.setBadgeTextColor?.({color:m(e)})}},y=class{open(){return s().runtime.openOptionsPage()}},b=new class{constructor(){this.browser=new l,this.extension=new h,this.ui={button:new v,settings:new y}}},w={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let A;const x=new Uint8Array(16);function E(){if(!A){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");A=crypto.getRandomValues.bind(crypto)}return A(x)}const S=[];for(let e=0;e<256;++e)S.push((e+256).toString(16).slice(1));function T(e,t=0){return(S[e[t+0]]+S[e[t+1]]+S[e[t+2]]+S[e[t+3]]+"-"+S[e[t+4]]+S[e[t+5]]+"-"+S[e[t+6]]+S[e[t+7]]+"-"+S[e[t+8]]+S[e[t+9]]+"-"+S[e[t+10]]+S[e[t+11]]+S[e[t+12]]+S[e[t+13]]+S[e[t+14]]+S[e[t+15]]).toLowerCase()}const _=function(e,t,n){if(w.randomUUID&&!t&&!e)return w.randomUUID();const r=(e=e||{}).random||(e.rng||E)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return T(r)},k={PRODUCT_CDN:"product-image.ebates.com",BASE:"https://%domain%",STORES:"%apituner_api%/apituner/button/domain/entity/list",STORE_DEALS_COUNT:"%apituner_api%/apituner/button/store/deal/count",DEALS:"%apituner_api%/apituner/button/store/deal/list",STORE_DEALS:"%apituner_api%/apituner/button/store/deal/list?storeId=%storeId%",STORE_CONTENT:"%apituner_api%/apituner/button/store/content?id=%storeId%",CAMPAIGNS:"%apituner_api%/apituner/button/campaign/list",EDS:"%apituner_api%/apituner/eds/member/profile",STORE_COUPONS:"%rakuten_api%/button-acs/stores/%storeId%/coupons",PRODUCT_METADATA:"%rakuten_api%/product-metadata-extractor/v1/regions/USA/stores/%storeId%/products",POPUP_SEARCH:"%search_api%/store/list/suggest?q={terms}&rows=25&start=0",URL_SHORTENER:"https://%domain%/urlshortener/v1/urls",ABANDONED_PRODUCTS:"https://cas.rrcbsn.com/cart_abandonment/v1/members/%uid%/products",CAPTURE_ORDER:"https://capture.ecbsn.com/api/1.0/commercecapture",MEMBER_DETAILS:"%member_api%/api/v3/button/member",MEMBER_ACTIVITY:"%member_api%/api/v3/button/member/activity",MEMBER_FAVORITES:"%member_api%/api/v3/button/member/favorite/stores",MEMBER_VISITED:"%member_api%/api/v3/button/member/store/visited",MEMBER_PURCHASED:"%member_api%/api/v3/button/member/store/purchased",MEMBER_TICKETS:"%member_api%/api/v3/button/member/trackingticket/list",MEMBER_ONE_RECEIPTS:"%member_api%/api/v3/button/member/receipts/list",MEMBER_ISCB:"%member_api%/api/v3/button/member/instore/offers/available",MEMBER_ISCB_LINKED:"%member_api%/api/v3/button/member/instore/offers/linked",MEMBER_UDPATE_TCPP:"%member_api%/api/v3/button/member/tcpp/update",MEMBER_UDPATE_ATTRIBUTE:"%member_api%/api/v3/button/member/attributes/update",MEMBER_TAF:"%member_api%/api/v3/button/member/referral/program",MEMBER_GEOGATING:"%member_api%/geogating/v1/checkStatus.do",MILESTONES_URL:"https://www.rakuten.com/rewardshub/v1/regions/USA/members/%uid%/milestones?cursor=1&limit=10",PRICE_MAGIC:"https://search.ecbsn.com/search/price-magic/v1/similar-products?partnerId=1&sourceName=Toolbar",PRICE_MAGIC_BULK:"https://search.ecbsn.com/search/price-magic/v1/bulk-products?sourceName=Toolbar",SETTINGS_PM:"%member_api%/toolbar/config/pm_stores.json",SETTINGS_COUPONS:"%member_api%/toolbar/config/coupons.json",SETTINGS_PRODUCTS:"%member_api%/toolbar/config/products.json",SETTINGS_MERCHANTS:"https://button.rrcbsn.com/settings/merchants.json",SETTINGS_SERP:"https://button.rrcbsn.com/settings/serp.json",SETTINGS_PROMOS:"https://button.rrcbsn.com/settings/promos.json",SETTINGS_NOTIFICATION_DOMAINS:"%cdn%/toolbar/config/notification-domains.json",WEB_INSTALL:"https://%domain%/button/%browser/install/success?sourceName=toolbar&eeid=45426&toolbarId=%toolbarId&visit_id=%visitId",WEB_LOGON_FORM:"https://%domain%/account/login?tb=yes&eeid=26118&visit_id=%visitId&targetpage=%2F",WEB_LOGIN:"https://%domain%/button/user-auth.htm?tb=yes&auth_type=su&sourceName=toolbar&visit_id=%visitId",WEB_UNINSTALL:"https://%domain%/button/uninstall?tb=yes&toolbarId=%toolbarId&v=%version&visit_id=%visitId&b=%browser",WEB_MOBILE_EXTENSION:"rakuten://us/beo?url=https://%domain%/button/mobile/enable&autologin=true",WEB_SEARCH:"https://%domain%/search?term={terms}&tb=yes&ebtoken=%ebtoken&visit_id=%visitId",WEB_HOME:"https://%domain%/?tb=yes&ebtoken=%ebtoken&eeid=26117&visit_id=%visitId",WEB_REFERRAL:"https://%domain%/referral/default.do?tb=yes&ebtoken=%ebtoken&visit_id=%visitId",WEB_TC:"https://%domain%/referral/default.do?tb=yes&ebtoken=%ebtoken&visit_id=%visitId#taf-tc",WEB_PRIVACY_NOTICE:"https://%domain%/help/article/button-privacy-notice?visit_id=%visitId",WEB_ADVERTISING_DISCLOSURE:"https://%domain%/help/article/advertising-disclosure?tb=yes&eeid=26117",WEB_REFERRAL_TERMS:"https://%domain%/help/article/referral-program-terms?tb=yes&ebtoken=%ebtoken&eeid=61594",WEB_ADD_ADDRESS:"https://%domain%/account-settings.htm?add-address-modal=true&tb=yes&eeid=26117&sourceName=toolbar",WEB_CHOOSE_PAYMENT:"https://%domain%/account-settings.htm?choose-payment=true&tb=yes&eeid=26117&sourceName=toolbar&ebtoken=%ebtoken",WEBSTORE_SAFARI:"https://itunes.apple.com/app/apple-store/id1451893560?pt=117880184&mt=12&ls=1",WEBSTORE_FIREFOX:"https://addons.mozilla.org/en-US/firefox/addon/ebates/reviews/add",WEBSTORE_EDGE:"https://microsoftedge.microsoft.com/addons/detail/gmmlpenookphoknnpfilofakghemolmg",WEBSTORE_CHROME:"https://chromewebstore.google.com/detail/rakuten-get-cash-back-for/chhjbpecpncaggjpdakmflnfcopglcmi/reviews"},C="%feed_api%/datagrid/rest/v1/data";var I=i(45091),P=i(64785),M=i.n(P);const D=function(){function e(){}return e.prototype.then=function(t,n){const r=new e,i=this.s;if(i){const e=1&i?t:n;if(e){try{R(r,1,e(this.v))}catch(e){R(r,2,e)}return r}return this}return this.o=function(e){try{const i=e.v;1&e.s?R(r,1,t?t(i):i):n?R(r,1,n(i)):R(r,2,i)}catch(e){R(r,2,e)}},r},e}();function R(e,t,n){if(!e.s){if(n instanceof D){if(!n.s)return void(n.o=R.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(R.bind(null,e,t),R.bind(null,e,2));e.s=t,e.v=n;const r=e.o;r&&r(e)}}var L=0,O="function"==typeof WeakMap?WeakMap:function(){var e="function"==typeof Symbol?Symbol(0):"__weak$"+ ++L;this.set=function(t,n){t[e]=n},this.get=function(t){return t[e]}};function B(e,t){return new Promise((function(n,r){e.onsuccess=function(){var r=e.result;t&&(r=t(r)),n(r)},e.onerror=function(){r(e.error)}}))}function N(e,t){return B(e.openCursor(t),(function(e){return e?[e.key,e.value]:[]}))}function j(e){return new Promise((function(t,n){e.oncomplete=function(){t()},e.onabort=function(){n(e.error)},e.onerror=function(){n(e.error)}}))}function U(e){if(!function(e){if("number"==typeof e||"string"==typeof e)return!0;if("object"==typeof e&&e){if(Array.isArray(e))return!0;if("setUTCFullYear"in e)return!0;if("function"==typeof ArrayBuffer&&ArrayBuffer.isView(e))return!0;if("byteLength"in e&&"length"in e)return!0}return!1}(e))throw Error("kv-storage: The given value is not allowed as a key")}var F={};function $(e,t){return N(e,q(t))}function q(e){return e===F?IDBKeyRange.lowerBound(-1/0):IDBKeyRange.lowerBound(e,!0)}var H=new O,W=new O,G=new O,V=new O,z=function(){};function J(e,t){return t((function(t,n){try{function c(){return W.set(e,i),G.set(e,void 0),{value:o,done:void 0===i}}var r=W.get(e);if(void 0===r)return Promise.resolve({value:void 0,done:!0});var i,s,o,a=function(e,t){var n,r=-1;e:{for(var i=0;i<t.length;i++){var s=t[i][0];if(s){var o=s();if(o&&o.then)break e;if(o===e){r=i;break}}else r=i}if(-1!==r){do{for(var a=t[r][1];!a;)a=t[++r][1];var c=a();if(c&&c.then){n=!0;break e}var u=t[r][2];r++}while(u&&!u());return c}}const l=new D,d=R.bind(null,l,2);return(n?c.then(h):o.then((function n(o){for(;;){if(o===e){r=i;break}if(++i===t.length){if(-1!==r)break;return void R(l,1,c)}if(s=t[i][0]){if((o=s())&&o.then)return void o.then(n).then(void 0,d)}else r=i}do{for(var a=t[r][1];!a;)a=t[++r][1];var c=a();if(c&&c.then)return void c.then(h).then(void 0,d);var u=t[r][2];r++}while(u&&!u());R(l,1,c)}))).then(void 0,d),l;function h(e){for(;;){var n=t[r][2];if(!n||n())break;for(var i=t[++r][1];!i;)i=t[++r][1];if((e=i())&&e.then)return void e.then(h).then(void 0,d)}R(l,1,e)}}(V.get(e),[[function(){return"keys"},function(){return Promise.resolve(function(e,t){return N(e,q(t)).then((function(e){return e[0]}))}(n,r)).then((function(e){o=i=e}))}],[function(){return"values"},function(){return Promise.resolve($(n,r)).then((function(e){var t;i=(t=e)[0],o=s=t[1]}))}],[function(){return"entries"},function(){return Promise.resolve($(n,r)).then((function(e){var t;s=(t=e)[1],o=void 0===(i=t[0])?void 0:[i,s]}))}]]);return Promise.resolve(a&&a.then?a.then(c):c())}catch(u){return Promise.reject(u)}}))}function K(e,t){var n=new z;return V.set(n,e),H.set(n,t),W.set(n,F),G.set(n,void 0),n}z.prototype.return=function(){W.set(this,void 0)},z.prototype.next=function(){var e=this,t=H.get(this);if(!t)return Promise.reject(new TypeError("Invalid this value"));var n,r=G.get(this);return n=void 0!==r?r.then((function(){return J(e,t)})):J(this,t),G.set(this,n),n},"function"==typeof Symbol&&Symbol.asyncIterator&&(z.prototype[Symbol.asyncIterator]=function(){return this});var Y=function(e,t,n){try{return null===Z.get(e)&&function(e){var t=X.get(e);Z.set(e,new Promise((function(n,r){var i=self.indexedDB.open(t,1);i.onsuccess=function(){var s=i.result;(function(e,t,n){if(1!==e.objectStoreNames.length)return n(te(t)),!1;if(e.objectStoreNames[0]!==Q)return n(te(t)),!1;var r=e.transaction(Q,"readonly").objectStore(Q);return!(r.autoIncrement||r.keyPath||r.indexNames.length)||(n(te(t)),!1)})(s,t,r)&&(s.onclose=function(){Z.set(e,null)},s.onversionchange=function(){s.close(),Z.set(e,null)},n(s))},i.onerror=function(){return r(i.error)},i.onupgradeneeded=function(){try{i.result.createObjectStore(Q)}catch(e){r(e)}}})))}(e),Promise.resolve(Z.get(e)).then((function(e){var r=e.transaction(Q,t),i=r.objectStore(Q);return n(r,i)}))}catch(e){return Promise.reject(e)}},X=new O,Z=new O,Q="store",ee=function(e){var t="kv-storage:"+e;Z.set(this,null),X.set(this,t),this.backingStore={database:t,store:Q,version:1}};function te(e){return new Error('kv-storage: database "'+e+'" corrupted')}ee.prototype.set=function(e,t){try{return U(e),Y(this,"readwrite",(function(n,r){return void 0===t?r.delete(e):r.put(t,e),j(n)}))}catch(e){return Promise.reject(e)}},ee.prototype.get=function(e){try{return U(e),Y(this,"readonly",(function(t,n){return B(n.get(e))}))}catch(e){return Promise.reject(e)}},ee.prototype.delete=function(e){try{return U(e),Y(this,"readwrite",(function(t,n){return n.delete(e),j(t)}))}catch(e){return Promise.reject(e)}},ee.prototype.clear=function(){try{var e=this;function i(){function n(){return B(self.indexedDB.deleteDatabase(X.get(e)))}var r=function(){if(t){try{t.close()}catch(e){}return Promise.resolve(new Promise(setTimeout)).then((function(){}))}}();return r&&r.then?r.then(n):n()}var t,n=Z.get(e),r=function(){if(null!==n){function i(){Z.set(e,null)}var r=function(){try{var e=Promise.resolve(n).then((function(e){t=e}))}catch(e){return}return e&&e.then?e.then(void 0,(function(){})):e}();return r&&r.then?r.then(i):i()}}();return r&&r.then?r.then(i):i()}catch(e){return Promise.reject(e)}},ee.prototype.keys=function(){var e=this;return K("keys",(function(t){return Y(e,"readonly",t)}))},ee.prototype.values=function(){var e=this;return K("values",(function(t){return Y(e,"readonly",t)}))},ee.prototype.entries=function(){var e=this;return K("entries",(function(t){return Y(e,"readonly",t)}))},"function"==typeof Symbol&&Symbol.asyncIterator&&(ee.prototype[Symbol.asyncIterator]=ee.prototype.entries);const ne=new ee("default"),re={locale:"en-US",domain:"www.rakuten.com",cdn:"https://static.rakuten.com",member_api:"https://www.rakuten.com",apituner_api:"https://apituner.ecbsn.com",search_api:"https://search.ecbsn.com",feed_api:"https://api.engager.ecbsn.com",rakuten_api:"https://api.rakuten.com",DATADOG_TOKEN:"pub5c8940d1d60d49fa1ad47b86997d8ed9",SEGMENT_HOST:"https://events.engager.ecbsn.com",SEGMENT_KEY:"RRkzrctEwtmgt8PgYWkF6SzN62oaAiID",FEATUREFLAGS_URL:"https://ffconf.ecbsn.com/featureflags",FEATUREFLAGS_APPID:"1af2274e-266f-4228-8765-b498deb0cc46",FEATUREFLAGS_APIKEY:"c0469223-7cfc-49bc-b1d3-378b71d44817",FEATUREFLAGS_EXPERIMENT_URL:"https://api.rakuten.com/experiment/v4/featureflags_variation",FEATUREFLAGS_EXPERIMENT_APIKEY:"4899e0cf-a5ea-4d81-a5f4-6186e72e23bd",FILLR_DEVKEY:"a157b4f6d3f2d669e92ec47175b7a5b1",URL_TERMS:"https://www.rakuten.com/help/category/legal-115001470127",CC_TENANT_ID:1,FACEBOOK_APP_ID:0xc2ee9ccb8e0a,currency:"$",DEFAULT_REFER_BONUS_AMOUNT:"$30",DEFAULT_REDEEM_THRESHOLD_AMOUNT:"$30",DATE_FORMAT:"M/D/YYYY",SETTINGS_URL:"https://www.rakuten.com/toolbar/config/settings.json",MEMBER_BALANCE:"https://api.rakuten.com/earnings_history/v2/regions/usa/members/%uid%/experience/balance_info",WEB_REWARDS:"https://www.rakuten.com/pending-cash-back.htm?tb=yes&ebtoken=%ebtoken&eeid=26117",WEB_PRIVACY_PREFERENCES:"https://www.rakuten.com/privacy-preferences.htm?tb=yes&ebtoken=%ebtoken&eeid=46021",SHELL_PAGE:"https://www.rakuten.com/help/other-questions?sourceName=toolbar",WEB_HELP:"https://www.rakuten.com/help/category/browser-extension-help-26579223731603?tb=yes"},ie={locale:"en-GB",domain:"www.rakuten.co.uk",cdn:"https://static.rakuten.co.uk/",member_api:"https://www.rakuten.co.uk",apituner_api:"https://apituner.ecbsn.co.uk",search_api:"https://search.ecbsn.co.uk",feed_api:"https://api.engager.ecbsn.co.uk",rakuten_api:"https://api.rakuten.co.uk",DATADOG_TOKEN:"pub5c8940d1d60d49fa1ad47b86997d8ed9",FEATUREFLAGS_URL:"https://ffconf.ecbsn.com/featureflags",FEATUREFLAGS_APPID:"1af2274e-266f-4228-8765-b498deb0cc46",FEATUREFLAGS_APIKEY:"c0469223-7cfc-49bc-b1d3-378b71d44817",FEATUREFLAGS_EXPERIMENT_URL:"https://api.rakuten.com/experiment/v4/featureflags_variation",FEATUREFLAGS_EXPERIMENT_APIKEY:"4899e0cf-a5ea-4d81-a5f4-6186e72e23bd",FILLR_DEVKEY:"a157b4f6d3f2d669e92ec47175b7a5b1",URL_TERMS:"https://www.rakuten.co.uk/help/category/legal-21732382742163",URL_COOKIE_CONSENT:"https://www.rakuten.co.uk/help/article/cookie-policy-25679829169171",CC_TENANT_ID:11,FACEBOOK_APP_ID:0xc2ee9ccb8e0a,currency:"\xa3",DEFAULT_REFER_BONUS_AMOUNT:"\xa315",DEFAULT_REDEEM_THRESHOLD_AMOUNT:"\xa315",DATE_FORMAT:"D MMMM YYYY",SETTINGS_URL:"https://www.rakuten.co.uk/toolbar/config/gbr/settings.json",MEMBER_BALANCE:"https://api.rakuten.co.uk/earnings_history/v2/regions/gbr/members/%uid%/experience/balance_info",WEB_REWARDS:"https://www.rakuten.co.uk/account/balance?tb=yes&ebtoken=%ebtoken&eeid=26117",WEB_PRIVACY_PREFERENCES:"https://www.rakuten.co.uk/account/privacy-preferences?tb=yes&ebtoken=%ebtoken&eeid=46021",SHELL_PAGE:"https://www.rakuten.co.uk/help/other-questions?sourceName=toolbar",WEB_HELP:"https://www.rakuten.co.uk/help/category/browser-extension-21732363738515?tb=yes"},se={"en-US":JSON.parse('{"buttonTitles":{"neutral":"Rakuten: Get Cash Back for Shopping","activated":"Rakuten: Cash Back Activated","available":"Rakuten: Activate to Earn Cash Back"},"daysFromNow":{"endsToday":"Ends Today","endsTomorrow":"Ends Tomorrow","endsDate":"Ends {date}","ended":"Ended"},"reportingMessage":{"45days":"within 45 days after travel has been booked","afterTravel":"after travel has been completed","fewDays":"within a few days after travel has been completed","week":"within a week after travel has been completed","coupleOfWeeks":"within a couple of weeks after travel has been completed","month":"within a month after travel has been completed","sixWeeks":"\'within six weeks after travel has been completed","3Months":"within 3 months after travel has been completed","6Months":"within 6 months after travel has been completed","today":"today","tomorrow":"tomorrow","inAFewDays":"in a few days","oneWeek":"within one week","fewWeeks":"within a few weeks","fewMonths":"within a few months"},"formatCashback":{"tieredCashbackPercentage":"Up to {amount}%","tieredCashbackFixed":"Up to {amount}","offersOnly":"Offers Only","notAvailable":"Not Available"},"taf":{"defaultMessage":"Have you signed up with Rakuten yet? It\'s the best site for earning Cash Back. Get a $10 bonus when you sign up with my invite link and spend $25. It\'s free! [link]","defaultSubject":"Check this out: Get Cash Back for shopping!","twitter":{"postPurchase":"You can get {cashBack} Cash Back at {storeName} when you shop with Rakuten today. \\n\\nJoin with my invite link and you\'ll also get a $30 bonus when you spend $30 on qualifying purchases at 3,500+ stores. \\n{link}"},"email":{"postPurchase":{"subject":"Get Cash Back at {storeName} (thank me later!)","message":"Hey there,\\n\\nYou can get {cashBack} Cash Back at {storeName} when you shop with Rakuten today. \\n\\nJoin with my invite link and you\'ll also get a $30 bonus when you spend $30 on qualifying purchases at 3,500+ stores.\\n\\n{link}\\n\\n"}}},"messages":{"title":"{rewardAmount} just added!","text":"You just earned {rewardAmount} Cash Back from your purchase at {storeName}!","cta":"See Cash Back Activity"}}'),"en-GB":JSON.parse('{"buttonTitles":{"neutral":"Rakuten: Get Cashback for Shopping","activated":"Rakuten: Cashback Activated","available":"Rakuten: Activate to Earn Cashback"},"taf":{"defaultMessage":"Have you signed up with Rakuten yet? It\'s the best site for earning Cashback. Get a $10 bonus when you sign up with my invite link and spend $25. It\'s free! [link]","defaultSubject":"Check this out: Get Cashback for shopping!","twitter":{"postPurchase":"You can get {cashBack} Cashback at {storeName} when you shop with Rakuten today. \\n\\nJoin with my invite link and you\'ll also get an extra 10% Cashback on purchases made at 2,500+ stores for 7 days. You can thank me later!\\n{link}"},"email":{"postPurchase":{"subject":"Get Cashback at {storeName} (thank me later!)","message":"Hey there,\\n\\nYou can get {cashBack} Cashback at {storeName} when you shop with Rakuten today. \\n\\nJoin with my invite link and you\'ll also get an extra 10% Cashback on purchases made at 2,500+ stores for 7 days. You can thank me later!\\n\\n{link}\\n\\n"}}},"messages":{"title":"{rewardAmount} just added!","text":"You just earned {rewardAmount} Cashback from your purchase at {storeName}!","cta":"See Cashback Activity"}}')},oe="en-US";const ae=new class{locale=oe;constructor(){this.fallbackLocale=oe}setLocale(e){this.locale=e}getRawText(e){const t=se,n=e.split(".");n.unshift(this.locale);const r=e.split(".");return r.unshift(this.fallbackLocale),(0,I.get)(t,n)??(0,I.get)(t,r)}get(e,t){let n=this.getRawText(e);if("string"!=typeof n)return e;if(t){const e=[...n.matchAll(/{(.+?)}/g)];if(!e.length)return n;e.forEach((e=>{const r=e[0],i=t[e[1]];n=n?.replace(r,i)}))}return n}};async function ce(e,t){const r=await(n().cookies?.get({url:`https://${e}`,name:t}));return r?.value??""}class ue extends(M()){region=null;homedomain="www.rakuten.com";constructor(){super(),this.configs={USA:re,GBR:ie},this.config=this.configs.USA,this.ready=new Promise((e=>{this.once("change",(()=>e(!0)))})),b.extension.attachEvent("getConfig",(async()=>(await this.ready,this.getAll())))}async migrateRegionStorage(){let e="USA";if(await b.extension.getItem("installVersion")!==b.extension.version){await ne.get("gbr.merchants")&&(e="GBR")}return await this.saveRegion(e),e}async detectRegion(){const e="GBR"===await ce(le.homedomain,"extension-install-region")?"GBR":"USA";return this.saveRegion(e),e}async saveRegion(e){["USA","GBR"].includes(e),b.extension.setItem("region",e)}setRegion(e){ae.setLocale(this.get("locale")),this.region!==e&&(this.region=e,this.config="GBR"===e?this.configs.GBR:this.configs.USA,this.emit("change",e))}get(e,t){return t?this.configs[t][e]:this.config[e]}getAll(){return this.config}}const le=new ue,de=n().runtime.getManifest();function he(e,t,n){return"string"==typeof e&&e.startsWith("/")&&(n&&n.search(/pattern/i)<0||!n)?t?ge(t+e):e.search(/\.(png|jpg|jpeg|gif|svg)$/)>0?ge(`${le.get("cdn")}${e}`):ge(k.BASE+e):"object"==typeof e&&null!==e?fe(e,t):e}function fe(e,t){return(0,I.isArray)(e)?(0,I.map)(e,((e,n)=>he(e,t,n))):(0,I.mapObject)(e,((e,n)=>he(e,t,n)))}function ge(e,t={}){const n=self.EBATES?.member,r={domain:le.get("domain"),apituner_api:le.get("apituner_api"),rakuten_api:le.get("rakuten_api"),member_api:le.get("member_api"),search_api:le.get("search_api"),feed_api:le.get("feed_api"),cdn:le.get("cdn"),version:de.version,browser:b.browser.name.toLowerCase().replace(/ /gi,"").replace("webkitedge","edge"),installVersion:self.EBATES?.installVersion??"",toolbarId:self.EBATES?.toolbarId??"",ebtoken:self.EBATES?.ebToken??"",targetSet:n?.get("targetSet")??"",uid:n?.id??"",visitId:self.EBATES?.visitId??""};return Object.entries({...r,...t}).reduce(((e,[t,n])=>e.replace(new RegExp(`%${t}%?`,"g"),n)),he(e))}function pe(e){if(e){const t=e.match(/\.(.*)\./);try{if(t&&t.length>0){const e=t.pop()??"";return JSON.parse(atob(e))}}catch(e){}}return null}function me({url:e,width:t=650,height:r=400,screen:i}){if(b.browser.isSafari)b.browser.navigate(e);else{const s=Math.floor((i.availWidth-t)/2),o=Math.floor((i.availHeight-r)/2);n().windows.create({type:"popup",height:r,width:t,top:s,left:o,url:e})}}const ve=self.ServiceWorkerGlobalScope&&self instanceof self.ServiceWorkerGlobalScope;function ye(e,t){ve||self.addEventListener(e,t)}function be(e){return"number"==typeof e&&Number.isFinite(e)}function we(e){if(e&&!e.startsWith("data:")){const t=/(?:https?:\/\/)?(?:\w+:\/)?[^:?#/\s]*?([^.\s]+\.(?:[a-z]{2,}|co\.uk|org\.uk|ac\.uk|org\.au|com\.au))(?:[:?#/]|$)/gi.exec(e);return t?t[1].toLowerCase():null}return null}var Ae={log:"log",debug:"debug",info:"info",warn:"warn",error:"error"},xe=console,Ee={};Object.keys(Ae).forEach((function(e){Ee[e]=xe[e]}));var Se="Datadog Browser SDK:",Te={debug:Ee.debug.bind(xe,Se),log:Ee.log.bind(xe,Se),info:Ee.info.bind(xe,Se),warn:Ee.warn.bind(xe,Se),error:Ee.error.bind(xe,Se)},_e="https://docs.datadoghq.com",ke="".concat(_e,"/real_user_monitoring/browser/troubleshooting"),Ce="More details:";function Ie(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];try{return e.apply(void 0,n)}catch(e){Te.error(t,e)}}}var Pe,Me=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,s=t.length;i<s;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},De=!1;function Re(e){De=e}function Le(e,t,n){var r=n.value;n.value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(Pe?Oe(r):r).apply(this,e)}}function Oe(e){return function(){return Be(e,this,arguments)}}function Be(e,t,n){try{return e.apply(t,n)}catch(e){if(Ne(e),Pe)try{Pe(e)}catch(e){Ne(e)}}}function Ne(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];De&&Te.error.apply(Te,Me(["[MONITOR]"],e,!1))}function je(e,t){return-1!==e.indexOf(t)}function Ue(e){if(Array.from)return Array.from(e);var t=[];if(e instanceof Set)e.forEach((function(e){return t.push(e)}));else for(var n=0;n<e.length;n++)t.push(e[n]);return t}function Fe(e){return Object.keys(e).map((function(t){return e[t]}))}function $e(e,t){return e.slice(0,t.length)===t}function qe(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.forEach((function(t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})),e}function He(){if("object"==typeof globalThis)return globalThis;Object.defineProperty(Object.prototype,"_dd_temp_",{get:function(){return this},configurable:!0});var e=_dd_temp_;return delete Object.prototype._dd_temp_,"object"!=typeof e&&(e="object"==typeof self?self:"object"==typeof window?window:{}),e}var We=1024,Ge=/[^\u0000-\u007F]/;function Ve(e){return Ge.test(e)?void 0!==window.TextEncoder?(new TextEncoder).encode(e).length:new Blob([e]).size:e.length}function ze(e,t){var n,r=He();return r.Zone&&"function"==typeof r.Zone.__symbol__&&(n=e[r.Zone.__symbol__(t)]),n||(n=e[t]),n}function Je(e,t){return ze(He(),"setTimeout")(Oe(e),t)}function Ke(e){ze(He(),"clearTimeout")(e)}function Ye(e,t){return ze(He(),"setInterval")(Oe(e),t)}function Xe(e){ze(He(),"clearInterval")(e)}function Ze(e,t,n){var r,i,s=!n||void 0===n.leading||n.leading,o=!n||void 0===n.trailing||n.trailing,a=!1;return{throttled:function(){for(var n=[],c=0;c<arguments.length;c++)n[c]=arguments[c];a?r=n:(s?e.apply(void 0,n):r=n,a=!0,i=Je((function(){o&&r&&e.apply(void 0,r),a=!1,r=void 0}),t))},cancel:function(){Ke(i),a=!1,r=void 0}}}function Qe(){}function et(e,t,n){if("object"!=typeof e||null===e)return JSON.stringify(e);var r=tt(Object.prototype),i=tt(Array.prototype),s=tt(Object.getPrototypeOf(e)),o=tt(e);try{return JSON.stringify(e,t,n)}catch(e){return"<error: unable to serialize object>"}finally{r(),i(),s(),o()}}function tt(e){var t=e,n=t.toJSON;return n?(delete t.toJSON,function(){t.toJSON=n}):Qe}function nt(e,t){return Object.keys(e).some((function(n){return e[n]===t}))}function rt(e){return 0===Object.keys(e).length}function it(e){void 0===e&&(e=2);var t=new Map,n=!1;function r(r){if(void 0===r&&(r=0),!n&&0!==e){var i=2===e?3072:16384,s=r;t.forEach((function(e){s+=e.getBytesCount()})),s>i&&(!function(e){Te.warn("Customer data exceeds the recommended ".concat(e/We,"KiB threshold. ").concat(Ce," ").concat(ke,"/#customer-data-exceeds-the-recommended-threshold-warning"))}(i),n=!0)}}return{createDetachedTracker:function(){var e=st((function(){return r(e.getBytesCount())}));return e},getOrCreateTracker:function(e){return t.has(e)||t.set(e,st(r)),t.get(e)},setCompressionStatus:function(t){0===e&&(e=t,r())},getCompressionStatus:function(){return e},stop:function(){t.forEach((function(e){return e.stop()})),t.clear()}}}function st(e){var t=0,n=Ze((function(n){t=Ve(et(n)),e()}),200),r=n.throttled,i=n.cancel,s=function(){i(),t=0};return{updateCustomerData:function(e){rt(e)?s():r(e)},resetCustomerData:s,getBytesCount:function(){return t},stop:function(){i()}}}function ot(e){return null===e?"null":Array.isArray(e)?"array":typeof e}function at(e,t,n){if(void 0===n&&(n=function(){if("undefined"!=typeof WeakSet){var e=new WeakSet;return{hasAlreadyBeenSeen:function(t){var n=e.has(t);return n||e.add(t),n}}}var t=[];return{hasAlreadyBeenSeen:function(e){var n=t.indexOf(e)>=0;return n||t.push(e),n}}}()),void 0===t)return e;if("object"!=typeof t||null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp){var r=t.flags||[t.global?"g":"",t.ignoreCase?"i":"",t.multiline?"m":"",t.sticky?"y":"",t.unicode?"u":""].join("");return new RegExp(t.source,r)}if(!n.hasAlreadyBeenSeen(t)){if(Array.isArray(t)){for(var i=Array.isArray(e)?e:[],s=0;s<t.length;++s)i[s]=at(i[s],t[s],n);return i}var o="object"===ot(e)?e:{};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(o[a]=at(o[a],t[a],n));return o}}function ct(e){return at(void 0,e)}function ut(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=0,i=t;r<i.length;r++){var s=i[r];null!=s&&(e=at(e,s))}return e}function lt(e,t){void 0===t&&(t=225280);var n=tt(Object.prototype),r=tt(Array.prototype),i=[],s=new WeakMap,o=dt(e,"$",void 0,i,s),a=JSON.stringify(o),c=a?a.length:0;if(!(c>t)){for(;i.length>0&&c<t;){var u=i.shift(),l=0;if(Array.isArray(u.source))for(var d=0;d<u.source.length;d++){if(c+=void 0!==(h=dt(u.source[d],u.path,d,i,s))?JSON.stringify(h).length:4,c+=l,l=1,c>t){ht(t,"truncated",e);break}u.target[d]=h}else for(var d in u.source)if(Object.prototype.hasOwnProperty.call(u.source,d)){var h;if(void 0!==(h=dt(u.source[d],u.path,d,i,s))&&(c+=JSON.stringify(h).length+l+d.length+3,l=1),c>t){ht(t,"truncated",e);break}u.target[d]=h}}return n(),r(),o}ht(t,"discarded",e)}function dt(e,t,n,r,i){var s=function(e){var t=e;if(t&&"function"==typeof t.toJSON)try{return t.toJSON()}catch(e){}return e}(e);if(!s||"object"!=typeof s)return function(e){if("bigint"==typeof e)return"[BigInt] ".concat(e.toString());if("function"==typeof e)return"[Function] ".concat(e.name||"unknown");if("symbol"==typeof e)return"[Symbol] ".concat(e.description||e.toString());return e}(s);var o=function(e){try{if(e instanceof Event)return{isTrusted:e.isTrusted};var t=Object.prototype.toString.call(e).match(/\[object (.*)\]/);if(t&&t[1])return"[".concat(t[1],"]")}catch(e){}return"[Unserializable]"}(s);if("[Object]"!==o&&"[Array]"!==o&&"[Error]"!==o)return o;var a=e;if(i.has(a))return"[Reference seen at ".concat(i.get(a),"]");var c=void 0!==n?"".concat(t,".").concat(n):t,u=Array.isArray(s)?[]:{};return i.set(a,c),r.push({source:s,target:u,path:c}),u}function ht(e,t,n){Te.warn("The data provided has been ".concat(t," as it is over the limit of ").concat(e," characters:"),n)}var ft=function(){function e(e){this.onFirstSubscribe=e,this.observers=[]}return e.prototype.subscribe=function(e){var t=this;return this.observers.push(e),1===this.observers.length&&this.onFirstSubscribe&&(this.onLastUnsubscribe=this.onFirstSubscribe(this)||void 0),{unsubscribe:function(){t.observers=t.observers.filter((function(t){return e!==t})),!t.observers.length&&t.onLastUnsubscribe&&t.onLastUnsubscribe()}}},e.prototype.notify=function(e){this.observers.forEach((function(t){return t(e)}))},e}();function gt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new ft((function(t){var n=e.map((function(e){return e.subscribe((function(e){return t.notify(e)}))}));return function(){return n.forEach((function(e){return e.unsubscribe()}))}}))}function pt(e){var t={},n=new ft,r={getContext:function(){return ct(t)},setContext:function(i){"object"===ot(i)?(t=lt(i),e&&e.updateCustomerData(t)):r.clearContext(),n.notify()},setContextProperty:function(r,i){t[r]=lt(i),e&&e.updateCustomerData(t),n.notify()},removeContextProperty:function(r){delete t[r],e&&e.updateCustomerData(t),n.notify()},clearContext:function(){t={},e&&e.resetCustomerData(),n.notify()},changeObservable:n};return r}var mt={GRANTED:"granted",NOT_GRANTED:"not-granted"};function vt(e,t,n,r,i){return yt(e,t,[n],r,i)}function yt(e,t,n,r,i){var s=void 0===i?{}:i,o=s.once,a=s.capture,c=s.passive,u=Oe((function(t){(t.isTrusted||t.__ddIsTrusted||e.allowUntrustedEvents)&&(o&&f(),r(t))})),l=c?{capture:a,passive:c}:a,d=window.EventTarget&&t instanceof EventTarget?window.EventTarget.prototype:t,h=ze(d,"addEventListener");function f(){var e=ze(d,"removeEventListener");n.forEach((function(n){return e.call(t,n,u,l)}))}return n.forEach((function(e){return h.call(t,e,u,l)})),{stop:f}}var bt="_dd_c",wt=[];function At(e,t,n,r){var i=function(e,t){return"".concat(bt,"_").concat(e,"_").concat(t)}(n,r);function s(){var e=localStorage.getItem(i);return null!==e?JSON.parse(e):{}}wt.push(vt(e,window,"storage",(function(e){var n=e.key;i===n&&t.setContext(s())}))),t.changeObservable.subscribe((function(){localStorage.setItem(i,JSON.stringify(t.getContext()))})),t.setContext(ut(s(),t.getContext()))}var xt="?";function Et(e){var t=[],n=Dt(e,"stack"),r=String(e);return n&&$e(n,r)&&(n=n.slice(r.length)),n&&n.split("\n").forEach((function(e){var n=function(e){var t=_t.exec(e);if(!t)return;var n=t[2]&&0===t[2].indexOf("native"),r=t[2]&&0===t[2].indexOf("eval"),i=kt.exec(t[2]);r&&i&&(t[2]=i[1],t[3]=i[2],t[4]=i[3]);return{args:n?[t[2]]:[],column:t[4]?+t[4]:void 0,func:t[1]||xt,line:t[3]?+t[3]:void 0,url:n?void 0:t[2]}}(e)||function(e){var t=Ct.exec(e);if(!t)return;return{args:[],column:t[3]?+t[3]:void 0,func:xt,line:t[2]?+t[2]:void 0,url:t[1]}}(e)||function(e){var t=It.exec(e);if(!t)return;return{args:[],column:t[4]?+t[4]:void 0,func:t[1]||xt,line:+t[3],url:t[2]}}(e)||function(e){var t=Pt.exec(e);if(!t)return;var n=t[3]&&t[3].indexOf(" > eval")>-1,r=Mt.exec(t[3]);n&&r&&(t[3]=r[1],t[4]=r[2],t[5]=void 0);return{args:t[2]?t[2].split(","):[],column:t[5]?+t[5]:void 0,func:t[1]||xt,line:t[4]?+t[4]:void 0,url:t[3]}}(e);n&&(!n.func&&n.line&&(n.func=xt),t.push(n))})),{message:Dt(e,"message"),name:Dt(e,"name"),stack:t}}var St="((?:file|https?|blob|chrome-extension|native|eval|webpack|snippet|<anonymous>|\\w+\\.|\\/).*?)",Tt="(?::(\\d+))",_t=new RegExp("^\\s*at (.*?) ?\\(".concat(St).concat(Tt,"?").concat(Tt,"?\\)?\\s*$"),"i"),kt=new RegExp("\\((\\S*)".concat(Tt).concat(Tt,"\\)"));var Ct=new RegExp("^\\s*at ?".concat(St).concat(Tt,"?").concat(Tt,"??\\s*$"),"i");var It=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i;var Pt=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|capacitor|\[native).*?|[^@]*bundle)(?::(\d+))?(?::(\d+))?\s*$/i,Mt=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i;function Dt(e,t){if("object"==typeof e&&e&&t in e){var n=e[t];return"string"==typeof n?n:void 0}}function Rt(e,t,n,r){var i=[{url:t,column:r,line:n}],s=function(e){var t,n,r;"[object String]"==={}.toString.call(e)&&(n=(t=Lt.exec(e))[1],r=t[2]);return{name:n,message:r}}(e);return{name:s.name,message:s.message,stack:i}}var Lt=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?([\s\S]*)$/;function Ot(){var e,t=new Error;if(!t.stack)try{throw t}catch(e){}return Be((function(){var n=Et(t);n.stack=n.stack.slice(2),e=Bt(n)})),e}function Bt(e){var t=Nt(e);return e.stack.forEach((function(e){var n="?"===e.func?"<anonymous>":e.func,r=e.args&&e.args.length>0?"(".concat(e.args.join(", "),")"):"",i=e.line?":".concat(e.line):"",s=e.line&&e.column?":".concat(e.column):"";t+="\n  at ".concat(n).concat(r," @ ").concat(e.url).concat(i).concat(s)})),t}function Nt(e){return"".concat(e.name||"Error",": ").concat(e.message)}var jt,Ut="No stack, consider using an instance of Error";function Ft(e){var t=e.stackTrace,n=e.originalError,r=e.handlingStack,i=e.startClocks,s=e.nonErrorPrefix,o=e.source,a=e.handling,c=qt(n),u=function(e,t,n,r){return(null==e?void 0:e.message)&&(null==e?void 0:e.name)?e.message:t?"Empty message":"".concat(n," ").concat(et(lt(r)))}(t,c,s,n),l=function(e,t){if(void 0===t)return!1;if(e)return!0;return t.stack.length>0&&(t.stack.length>1||void 0!==t.stack[0].url)}(c,t)?Bt(t):Ut,d=c?Ht(n,o):void 0;return{startClocks:i,source:o,handling:a,handlingStack:r,originalError:n,type:t?t.name:void 0,message:u,stack:l,causes:d,fingerprint:$t(n)}}function $t(e){return qt(e)&&"dd_fingerprint"in e?String(e.dd_fingerprint):void 0}function qt(e){return"[object Error]"===Object.prototype.toString.call(e)}function Ht(e,t){for(var n=e,r=[];qt(null==n?void 0:n.cause)&&r.length<10;){var i=Et(n.cause);r.push({message:n.cause.message,source:t,type:null==i?void 0:i.name,stack:i&&Bt(i)}),n=n.cause}return r.length?r:void 0}!function(e){e.WRITABLE_RESOURCE_GRAPHQL="writable_resource_graphql",e.REMOTE_CONFIGURATION="remote_configuration",e.LONG_ANIMATION_FRAME="long_animation_frame",e.ACTION_NAME_MASKING="action_name_masking"}(jt||(jt={}));var Wt=new Set;function Gt(e){Array.isArray(e)&&e.filter((function(e){return nt(jt,e)})).forEach((function(e){Wt.add(e)}))}function Vt(){return Wt}var zt,Jt="dd0g-gov.com",Kt="datadoghq.com",Yt="pci.browser-intake-datadoghq.com",Xt=["ddsource","ddtags"],Zt=1e3,Qt=6e4;function en(){return(new Date).getTime()}function tn(){return en()}function nn(){return performance.now()}function rn(){return{relative:nn(),timeStamp:tn()}}function sn(e,t){return e+t}function on(e){return e-an()}function an(){return void 0===zt&&(zt=performance.timing.navigationStart),zt}function cn(e,t){var n=window.__ddBrowserSdkExtensionCallback;n&&n({type:e,payload:t})}function un(e){return 0!==e&&100*Math.random()<=e}function ln(){var e,t=window.navigator;return{status:t.onLine?"connected":"not_connected",interfaces:t.connection&&t.connection.type?[t.connection.type]:void 0,effective_type:null===(e=t.connection)||void 0===e?void 0:e.effectiveType}}function dn(e,t){var n=e.indexOf(t);n>=0&&e.splice(n,1)}function hn(){var e=[];return{add:function(t){e.push(t)>500&&e.splice(0,1)},remove:function(t){dn(e,t)},drain:function(t){e.forEach((function(e){return e(t)})),e.length=0}}}var fn="log",gn="configuration",pn="usage",mn=["https://www.datadoghq-browser-agent.com","https://www.datad0g-browser-agent.com","https://d3uc069fcn7uxw.cloudfront.net","https://d20xtzwzcl0ceb.cloudfront.net","http://localhost","<anonymous>"],vn=["ddog-gov.com"],yn=hn(),bn=function(e){yn.add((function(){return bn(e)}))};function wn(e,t){var n,r,i=new ft,s=new Set,o=!je(vn,t.site)&&un(t.telemetrySampleRate),a=((n={})[fn]=o,n[gn]=o&&un(t.telemetryConfigurationSampleRate),n[pn]=o&&un(t.telemetryUsageSampleRate),n),c={is_local_file:"file:"===window.location.protocol,is_worker:"WorkerGlobalScope"in self};return bn=function(n){var o=et(n);if(a[n.type]&&s.size<t.maxTelemetryEventsPerPage&&!s.has(o)){var u=function(e,t,n){return ut({type:"telemetry",date:tn(),service:e,version:"5.33.0",source:"browser",_dd:{format_version:2},telemetry:ut(t,{runtime_env:n,connectivity:ln(),sdk_setup:"npm"}),experimental_features:Ue(Vt())},void 0!==r?r():{})}(e,n,c);i.notify(u),cn("telemetry",u),s.add(o)}},Pe=xn,{setContextProvider:function(e){r=e},observable:i,enabled:o}}function An(e,t){Ne(Ae.debug,e,t),bn(qe({type:fn,message:e,status:"debug"},t))}function xn(e,t){bn(qe({type:fn,status:"error"},function(e){if(qt(e)){var t=Et(e);return{error:{kind:t.name,stack:Bt(En(t))},message:t.message}}return{error:{stack:Ut},message:"".concat("Uncaught"," ").concat(et(e))}}(e),t))}function En(e){return e.stack=e.stack.filter((function(e){return!e.url||mn.some((function(t){return $e(e.url,t)}))})),e}function Sn(e){var t=qe({},e);return["id","name","email"].forEach((function(e){e in t&&(t[e]=String(t[e]))})),t}function Tn(e,t){t.silentMultipleInit||Te.error("".concat(e," is already initialized."))}var _n,kn="agent",Cn="console",In="logger",Pn="network",Mn="source",Dn="report";function Rn(e,t,n){var r=n.getHandler(),i=Array.isArray(r)?r:[r];return On[e]>=On[n.getLevel()]&&je(i,t)}var Ln={ok:"ok",debug:"debug",info:"info",notice:"notice",warn:"warn",error:"error",critical:"critical",alert:"alert",emerg:"emerg"},On=((_n={})[Ln.ok]=0,_n[Ln.debug]=1,_n[Ln.info]=2,_n[Ln.notice]=4,_n[Ln.warn]=5,_n[Ln.error]=6,_n[Ln.critical]=7,_n[Ln.alert]=8,_n[Ln.emerg]=9,_n);function Bn(e,t){var n=(void 0===t?{}:t).includeMessage,r=void 0!==n&&n;return{stack:e.stack,kind:e.type,message:r?e.message:void 0,causes:e.causes,fingerprint:e.fingerprint,handling:e.handling}}var Nn=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},jn="console",Un="http",Fn=Object.keys(Ln),$n=function(){function e(e,t,n,r,i,s){void 0===r&&(r=Un),void 0===i&&(i=Ln.debug),void 0===s&&(s={}),this.handleLogStrategy=e,this.handlerType=r,this.level=i,this.contextManager=pt(t),this.contextManager.setContext(s),n&&this.contextManager.setContextProperty("logger",{name:n})}return e.prototype.logImplementation=function(e,t,n,r,i){void 0===n&&(n=Ln.info);var s,o=lt(t);null!=r?s=ut({error:Bn(Ft({stackTrace:qt(r)?Et(r):void 0,originalError:r,nonErrorPrefix:"Provided",source:In,handling:"handled",startClocks:rn()}),{includeMessage:!0})},o):s=o;this.handleLogStrategy({message:lt(e),context:s,status:n},this,i)},e.prototype.log=function(e,t,n,r){var i;void 0===n&&(n=Ln.info),Rn(n,Un,this)&&(i=Ot()),this.logImplementation(e,t,n,r,i)},e.prototype.setContext=function(e){this.contextManager.setContext(e)},e.prototype.getContext=function(){return this.contextManager.getContext()},e.prototype.setContextProperty=function(e,t){this.contextManager.setContextProperty(e,t)},e.prototype.removeContextProperty=function(e){this.contextManager.removeContextProperty(e)},e.prototype.clearContext=function(){this.contextManager.clearContext()},e.prototype.setHandler=function(e){this.handlerType=e},e.prototype.getHandler=function(){return this.handlerType},e.prototype.setLevel=function(e){this.level=e},e.prototype.getLevel=function(){return this.level},Nn([Le],e.prototype,"logImplementation",null),e}();function qn(e){return function(t,n,r){var i;Rn(e,Un,this)&&(i=Ot()),this.logImplementation(t,n,e,r,i)}}function Hn(){var e=He().DatadogEventBridge;if(e)return{getCapabilities:function(){var t;return JSON.parse((null===(t=e.getCapabilities)||void 0===t?void 0:t.call(e))||"[]")},getPrivacyLevel:function(){var t;return null===(t=e.getPrivacyLevel)||void 0===t?void 0:t.call(e)},getAllowedWebViewHosts:function(){return JSON.parse(e.getAllowedWebViewHosts())},send:function(t,n,r){var i=r?{id:r}:void 0;e.send(JSON.stringify({eventType:t,event:n,view:i}))}}}function Wn(e){var t;void 0===e&&(e=null===(t=He().location)||void 0===t?void 0:t.hostname);var n=Hn();return!!n&&n.getAllowedWebViewHosts().some((function(t){return e===t||function(e,t){return e.slice(-t.length)===t}(e,".".concat(t))}))}function Gn(e,t,n,r){var i=(void 0===r?{}:r).computeHandlingStack,s=e[t];if("function"!=typeof s){if(!(t in e)||!$e(t,"on"))return{stop:Qe};s=Qe}var o=!1,a=function(){if(o)return s.apply(this,arguments);var e,t=Ue(arguments);Be(n,null,[{target:this,parameters:t,onPostCall:function(t){e=t},handlingStack:i?Ot():void 0}]);var r=s.apply(this,t);return e&&Be(e,null,[r]),r};return e[t]=a,{stop:function(){o=!0,e[t]===a&&(e[t]=s)}}}function Vn(e){return zn(e,location.href).href}function zn(e,t){var n=function(){if(void 0===Jn)try{var e=new Yn("http://test/path");Jn="http://test/path"===e.href}catch(e){Jn=!1}return Jn?Yn:void 0}();if(n)try{return void 0!==t?new n(e,t):new n(e)}catch(n){throw new Error("Failed to construct URL: ".concat(String(n)," ").concat(et({url:e,base:t})))}if(void 0===t&&!/:/.test(e))throw new Error("Invalid URL: '".concat(e,"'"));var r=document,i=r.createElement("a");if(void 0!==t){var s=(r=document.implementation.createHTMLDocument("")).createElement("base");s.href=t,r.head.appendChild(s),r.body.appendChild(i)}return i.href=e,i}$n.prototype.ok=qn(Ln.ok),$n.prototype.debug=qn(Ln.debug),$n.prototype.info=qn(Ln.info),$n.prototype.notice=qn(Ln.notice),$n.prototype.warn=qn(Ln.warn),$n.prototype.error=qn(Ln.error),$n.prototype.critical=qn(Ln.critical),$n.prototype.alert=qn(Ln.alert),$n.prototype.emerg=qn(Ln.emerg);var Jn,Kn,Yn=URL;function Xn(){return Kn||(Kn=new ft((function(e){if(window.fetch){var t=Gn(window,"fetch",(function(t){return function(e,t){var n=e.parameters,r=e.onPostCall,i=e.handlingStack,s=n[0],o=n[1],a=o&&o.method;void 0===a&&s instanceof Request&&(a=s.method);var c=void 0!==a?String(a).toUpperCase():"GET",u=s instanceof Request?s.url:Vn(String(s)),l=rn(),d={state:"start",init:o,input:s,method:c,startClocks:l,url:u,handlingStack:i};t.notify(d),n[0]=d.input,n[1]=d.init,r((function(e){return function(e,t,n){var r=n;function i(t){r.state="resolve",qe(r,t),e.notify(r)}t.then(Oe((function(e){i({response:e,responseType:e.type,status:e.status,isAborted:!1})})),Oe((function(e){var t,n;i({status:0,isAborted:(null===(n=null===(t=r.init)||void 0===t?void 0:t.signal)||void 0===n?void 0:n.aborted)||e instanceof DOMException&&e.code===DOMException.ABORT_ERR,error:e})})))}(t,e,d)}))}(t,e)}),{computeHandlingStack:!0}).stop;return t}}))),Kn}function Zn(e){return e?(parseInt(e,10)^16*Math.random()>>parseInt(e,10)/4).toString(16):"".concat(1e7,"-").concat(1e3,"-").concat(4e3,"-").concat(8e3,"-").concat(1e11).replace(/[018]/g,Zn)}var Qn,er,tr,nr=/([\w-]+)\s*=\s*([^;]+)/g;function rr(e,t,n){void 0===n&&(n="");var r=e.charCodeAt(t-1),i=r>=55296&&r<=56319?t+1:t;return e.length<=i?e:"".concat(e.slice(0,i)).concat(n)}function ir(){return null!=Qn?Qn:Qn=function(e){var t;void 0===e&&(e=window);var n=e.navigator.userAgent;if(e.chrome||/HeadlessChrome/.test(n))return 1;if(0===(null===(t=e.navigator.vendor)||void 0===t?void 0:t.indexOf("Apple"))||/safari/i.test(n)&&!/chrome|android/i.test(n))return 2;if(e.document.documentMode)return 0;return 3}()}function sr(e,t,n,r){var i=new Date;i.setTime(i.getTime()+n);var s="expires=".concat(i.toUTCString()),o=r&&r.crossSite?"none":"strict",a=r&&r.domain?";domain=".concat(r.domain):"",c=r&&r.secure?";secure":"",u=r&&r.partitioned?";partitioned":"";document.cookie="".concat(e,"=").concat(t,";").concat(s,";path=/;samesite=").concat(o).concat(a).concat(c).concat(u)}function or(e){return function(e,t){for(nr.lastIndex=0;;){var n=nr.exec(e);if(!n)break;if(n[1]===t)return n[2]}}(document.cookie,e)}function ar(e){return er||(er=function(e){var t=new Map;for(nr.lastIndex=0;;){var n=nr.exec(e);if(!n)break;t.set(n[1],n[2])}return t}(document.cookie)),er.get(e)}function cr(e,t){sr(e,"",0,t)}var ur="_dd_s",lr=144e5,dr=9e5,hr=/^([a-zA-Z]+)=([a-z0-9-]+)$/,fr="&";function gr(e){return rt(e)}function pr(e){return!gr(e)}function mr(e){return void 0!==e.isExpired||!((void 0===(t=e).created||en()-Number(t.created)<lr)&&(void 0===t.expire||en()<Number(t.expire)));var t}function vr(e){e.expire=String(en()+dr)}function yr(e){return(t=e,Object.keys(t).map((function(e){return[e,t[e]]}))).map((function(e){var t=e[0],n=e[1];return"".concat(t,"=").concat(n)})).join("&");var t}function br(e){var t={};return function(e){return!!e&&(-1!==e.indexOf(fr)||hr.test(e))}(e)&&e.split(fr).forEach((function(e){var n=hr.exec(e);if(null!==n){var r=n[1],i=n[2];t[r]=i}})),t}function wr(e){var t=function(e){var t={};t.secure=!!e.useSecureSessionCookie||!!e.usePartitionedCrossSiteSessionCookie||!!e.useCrossSiteSessionCookie,t.crossSite=!!e.usePartitionedCrossSiteSessionCookie||!!e.useCrossSiteSessionCookie,t.partitioned=!!e.usePartitionedCrossSiteSessionCookie,e.trackSessionAcrossSubdomains&&(t.domain=function(){if(void 0===tr){for(var e="dd_site_test_".concat(Zn()),t=window.location.hostname.split("."),n=t.pop();t.length&&!or(e);)n="".concat(t.pop(),".").concat(n),sr(e,"test",Zt,{domain:n});cr(e,{domain:n}),tr=n}return tr}());return t}(e);return function(e){if(void 0===document.cookie||null===document.cookie)return!1;try{var t="dd_cookie_test_".concat(Zn()),n="test";sr(t,n,Qt,e);var r=or(t)===n;return cr(t,e),r}catch(e){return Te.error(e),!1}}(t)?{type:"Cookie",cookieOptions:t}:void 0}function Ar(e){var t,n={isLockEnabled:1===ir(),persistSession:(t=e,function(e){sr(ur,yr(e),dr,t)}),retrieveSession:xr,expireSession:function(){return function(e){sr(ur,yr({isExpired:"1"}),lr,e)}(e)}};return function(e){if(!ar(ur)){var t=ar("_dd"),n=ar("_dd_r"),r=ar("_dd_l"),i={};t&&(i.id=t),r&&/^[01]$/.test(r)&&(i.logs=r),n&&/^[012]$/.test(n)&&(i.rum=n),pr(i)&&(vr(i),e.persistSession(i))}}(n),n}function xr(){return br(or(ur))}function Er(e){localStorage.setItem(ur,yr(e))}function Sr(){return br(localStorage.getItem(ur))}function Tr(){Er({isExpired:"1"})}var _r,kr=[];function Cr(e,t,n){var r;void 0===n&&(n=0);var i=t.isLockEnabled,s=t.persistSession,o=t.expireSession,a=function(e){return s(qe({},e,{lock:u}))},c=function(){var e=t.retrieveSession(),n=e.lock;return e.lock&&delete e.lock,{session:e,lock:n}};if(_r||(_r=e),e===_r)if(i&&n>=100)Pr(t);else{var u,l=c();if(i){if(l.lock)return void Ir(e,t,n);if(u=Zn(),a(l.session),(l=c()).lock!==u)return void Ir(e,t,n)}var d=e.process(l.session);if(i&&(l=c()).lock!==u)Ir(e,t,n);else{if(d&&(mr(d)?o():(vr(d),i?a(d):s(d))),i&&(!d||!mr(d))){if((l=c()).lock!==u)return void Ir(e,t,n);s(l.session),d=l.session}null===(r=e.after)||void 0===r||r.call(e,d||l.session),Pr(t)}}else kr.push(e)}function Ir(e,t,n){Je((function(){Cr(e,t,n+1)}),10)}function Pr(e){_r=void 0;var t=kr.shift();t&&Cr(t,e)}var Mr=Zt;function Dr(e){var t=wr(e);return!t&&e.allowFallbackToLocalStorage&&(t=function(){try{var e=Zn(),t="".concat("_dd_test_").concat(e);localStorage.setItem(t,e);var n=localStorage.getItem(t);return localStorage.removeItem(t),e===n?{type:"LocalStorage"}:void 0}catch(e){return}}()),t}function Rr(e,t,n){var r,i=new ft,s=new ft,o=new ft,a="Cookie"===e.type?Ar(e.cookieOptions):{isLockEnabled:!1,persistSession:Er,retrieveSession:Sr,expireSession:Tr},c=a.expireSession,u=Ye((function(){Cr({process:function(e){return mr(e)?{isExpired:"1"}:void 0},after:f},a)}),Mr);g();var l=Ze((function(){Cr({process:function(e){if(!gr(e)){var r=f(e);return function(e){if(gr(e))return!1;var r=n(e[t]),i=r.trackingType,s=r.isTracked;e[t]=i,delete e.isExpired,s&&!e.id&&(e.id=Zn(),e.created=String(en()))}(r),r}},after:function(e){pr(e)&&!p()&&function(e){r=e,i.notify()}(e),r=e}},a)}),Mr),d=l.throttled,h=l.cancel;function f(e){return mr(e)&&(e={isExpired:"1"}),p()&&(!function(e){return r.id!==e.id||r[t]!==e[t]}(e)?(o.notify({previousState:r,newState:e}),r=e):(r={isExpired:"1"},s.notify())),e}function g(){Cr({process:function(e){if(gr(e))return{isExpired:"1"}},after:function(e){r=e}},a)}function p(){return void 0!==r[t]}return{expandOrRenewSession:d,expandSession:function(){Cr({process:function(e){return p()?f(e):void 0}},a)},getSession:function(){return r},renewObservable:i,expireObservable:s,sessionStateUpdateObservable:o,restartSession:g,expire:function(){h(),c(),f({isExpired:"1"})},stop:function(){Xe(u)},updateSessionState:function(e){Cr({process:function(t){return qe({},t,e)},after:f},a)}}}function Lr(e,t,n){var r=function(e,t){var n="/api/v2/".concat(t),r=e.proxy;if("string"==typeof r){var i=Vn(r);return function(e){return"".concat(i,"?ddforward=").concat(encodeURIComponent("".concat(n,"?").concat(e)))}}if("function"==typeof r)return function(e){return r({path:n,parameters:e})};var s=function(e,t){var n=t.site,r=void 0===n?Kt:n,i=t.internalAnalyticsSubdomain;if("logs"===e&&t.usePciIntake&&r===Kt)return Yt;if(i&&r===Kt)return"".concat(i,".").concat(Kt);if(r===Jt)return"http-intake.logs.".concat(r);var s=r.split("."),o=s.pop();return"browser-intake-".concat(s.join("-"),".").concat(o)}(t,e);return function(e){return"https://".concat(s).concat(n,"?").concat(e)}}(e,t);return{build:function(i,s){var o=function(e,t,n,r,i){var s=e.clientToken,o=e.internalAnalyticsSubdomain,a=i.retry,c=i.encoding,u=["sdk_version:".concat("5.33.0"),"api:".concat(r)].concat(n);a&&u.push("retry_count:".concat(a.count),"retry_after:".concat(a.lastFailureStatus));var l=["ddsource=browser","ddtags=".concat(encodeURIComponent(u.join(","))),"dd-api-key=".concat(s),"dd-evp-origin-version=".concat(encodeURIComponent("5.33.0")),"dd-evp-origin=browser","dd-request-id=".concat(Zn())];c&&l.push("dd-evp-encoding=".concat(c));"rum"===t&&l.push("batch_time=".concat(tn()));o&&l.reverse();return l.join("&")}(e,t,n,i,s);return r(o)},urlPrefix:r(""),trackType:t}}function Or(e,t){var n=200-e.length-1;(t.length>n||function(e){if(!function(){try{return new RegExp("[\\p{Ll}]","u"),!0}catch(e){return!1}}())return!1;return new RegExp("[^\\p{Ll}\\p{Lo}0-9_:./-]","u").test(e)}(t))&&Te.warn("".concat(e," value doesn't meet tag requirements and will be sanitized. ").concat(Ce," ").concat(_e,"/getting_started/tagging/#defining-tags"));var r=t.replace(/,/g,"_");return"".concat(e,":").concat(r)}function Br(e){var t=e.site||Kt,n=function(e){var t=e.env,n=e.service,r=e.version,i=e.datacenter,s=[];return t&&s.push(Or("env",t)),n&&s.push(Or("service",n)),r&&s.push(Or("version",r)),i&&s.push(Or("datacenter",i)),s}(e),r=function(e,t){return{logsEndpointBuilder:Lr(e,"logs",t),rumEndpointBuilder:Lr(e,"rum",t),sessionReplayEndpointBuilder:Lr(e,"replay",t)}}(e,n),i=function(e,t){if(!e.replica)return;var n=qe({},e,{site:Kt,clientToken:e.replica.clientToken}),r={logsEndpointBuilder:Lr(n,"logs",t),rumEndpointBuilder:Lr(n,"rum",t)};return qe({applicationId:e.replica.applicationId},r)}(e,n);return qe({replica:i,site:t},r)}function Nr(e,t){return null==e||"string"==typeof e||(Te.error("".concat(t," must be defined as a string")),!1)}function jr(e,t){return!!(void 0===e||(n=e,function(e){return"number"==typeof e}(n)&&n>=0&&n<=100))||(Te.error("".concat(t," Sample Rate should be a number between 0 and 100")),!1);var n}function Ur(e){var t,n,r,i,s;if(e&&e.clientToken){if((!(o=e.site)||"string"!=typeof o||/(datadog|ddog|datad0g|dd0g)/.test(o)||(Te.error("Site should be a valid Datadog site. ".concat(Ce," ").concat(_e,"/getting_started/site/.")),0))&&jr(e.sessionSampleRate,"Session")&&jr(e.telemetrySampleRate,"Telemetry")&&jr(e.telemetryConfigurationSampleRate,"Telemetry Configuration")&&jr(e.telemetryUsageSampleRate,"Telemetry Usage")&&Nr(e.version,"Version")&&Nr(e.env,"Env")&&Nr(e.service,"Service")){var o;if(void 0===e.trackingConsent||nt(mt,e.trackingConsent))return qe({beforeSend:e.beforeSend&&Ie(e.beforeSend,"beforeSend threw an error:"),sessionStoreStrategyType:Dr(e),sessionSampleRate:null!==(t=e.sessionSampleRate)&&void 0!==t?t:100,telemetrySampleRate:null!==(n=e.telemetrySampleRate)&&void 0!==n?n:20,telemetryConfigurationSampleRate:null!==(r=e.telemetryConfigurationSampleRate)&&void 0!==r?r:5,telemetryUsageSampleRate:null!==(i=e.telemetryUsageSampleRate)&&void 0!==i?i:5,service:e.service||void 0,silentMultipleInit:!!e.silentMultipleInit,allowUntrustedEvents:!!e.allowUntrustedEvents,trackingConsent:null!==(s=e.trackingConsent)&&void 0!==s?s:mt.GRANTED,storeContextsAcrossPages:!!e.storeContextsAcrossPages,batchBytesLimit:16384,eventRateLimiterThreshold:3e3,maxTelemetryEventsPerPage:15,flushTimeout:3e4,batchMessagesLimit:50,messageBytesLimit:262144},Br(e));Te.error('Tracking Consent should be either "granted" or "not-granted"')}}else Te.error("Client Token is not configured, we will not send any data.")}var Fr={intervention:"intervention",deprecation:"deprecation",cspViolation:"csp_violation"};function $r(e,t){var n=[];je(t,Fr.cspViolation)&&n.push(function(e){return new ft((function(t){return vt(e,document,"securitypolicyviolation",(function(e){t.notify(function(e){var t="'".concat(e.blockedURI,"' blocked by '").concat(e.effectiveDirective,"' directive");return qr({type:e.effectiveDirective,message:"".concat(Fr.cspViolation,": ").concat(t),originalError:e,csp:{disposition:e.disposition},stack:Hr(e.effectiveDirective,e.originalPolicy?"".concat(t,' of the policy "').concat(rr(e.originalPolicy,100,"..."),'"'):"no policy",e.sourceFile,e.lineNumber,e.columnNumber)})}(e))})).stop}))}(e));var r=t.filter((function(e){return e!==Fr.cspViolation}));return r.length&&n.push(function(e){return new ft((function(t){if(window.ReportingObserver){var n=Oe((function(e,n){return e.forEach((function(e){return t.notify(function(e){var t=e.type,n=e.body;return qr({type:n.id,message:"".concat(t,": ").concat(n.message),originalError:e,stack:Hr(n.id,n.message,n.sourceFile,n.lineNumber,n.columnNumber)})}(e))}))})),r=new window.ReportingObserver(n,{types:e,buffered:!0});return r.observe(),function(){r.disconnect()}}}))}(r)),gt.apply(void 0,n)}function qr(e){return qe({startClocks:rn(),source:Dn,handling:"unhandled"},e)}function Hr(e,t,n,r,i){return n?Bt({name:e,message:t,stack:[{func:"?",url:n,line:null!=r?r:void 0,column:null!=i?i:void 0}]}):void 0}function Wr(e,t,n){return void 0===e?[]:"all"===e||Array.isArray(e)&&e.every((function(e){return je(t,e)}))?"all"===e?t:(r=e,i=new Set,r.forEach((function(e){return i.add(e)})),Ue(i)):void Te.error("".concat(n,' should be "all" or an array with allowed values "').concat(t.join('", "'),'"'));var r,i}function Gr(e,t,n){var r,i,s=hn(),o=t.observable.subscribe(a);function a(){if(i&&r&&t.isGranted()){o.unsubscribe();var e=n(r,i);s.drain(e)}}return{init:function(e){if(e)if(Gt(e.enableExperimentalFeatures),Wn()&&(e=function(e){return qe({},e,{clientToken:"empty"})}(e)),r=e,i)Tn("DD_LOGS",e);else{var n=function(e){!0===e.usePciIntake&&e.site&&"datadoghq.com"!==e.site&&Te.warn("PCI compliance for Logs is only available for Datadog organizations in the US1 site. Default intake will be used.");var t=Ur(e),n=Wr(e.forwardConsoleLogs,Fe(Ae),"Forward Console Logs"),r=Wr(e.forwardReports,Fe(Fr),"Forward Reports");if(t&&n&&r)return e.forwardErrorsToLogs&&!je(n,Ae.error)&&n.push(Ae.error),qe({forwardErrorsToLogs:!1!==e.forwardErrorsToLogs,forwardConsoleLogs:n,forwardReports:r,requestErrorResponseLengthLimit:32768,sendLogsAfterSessionExpiration:!!e.sendLogsAfterSessionExpiration},t)}(e);n&&(i=n,Xn().subscribe(Qe),t.tryToInit(n.trackingConsent),a())}else Te.error("Missing configuration")},get initConfiguration(){return r},getInternalContext:Qe,handleLog:function(t,n,r,i,o){void 0===i&&(i=e()),void 0===o&&(o=tn()),s.add((function(e){return e.handleLog(t,n,r,i,o)}))}}}var Vr="logs";var zr={HIDDEN:"visibility_hidden",UNLOADING:"before_unload",PAGEHIDE:"page_hide",FROZEN:"page_frozen"};function Jr(){return Boolean(window._DATADOG_SYNTHETICS_INJECTS_RUM||ar("datadog-synthetics-injects-rum"))}function Kr(){var e=window._DATADOG_SYNTHETICS_RESULT_ID||ar("datadog-synthetics-result-id");return"string"==typeof e?e:void 0}var Yr=1/0;function Xr(e){var t=e.expireDelay,n=e.maxEntries,r=[],i=Ye((function(){return function(){var e=nn()-t;for(;r.length>0&&r[r.length-1].endTime<e;)r.pop()}()}),6e4);return{add:function(e,t){var i={value:e,startTime:t,endTime:Yr,remove:function(){dn(r,i)},close:function(e){i.endTime=e}};return n&&r.length>=n&&r.pop(),r.unshift(i),i},find:function(e,t){void 0===e&&(e=Yr),void 0===t&&(t={returnInactive:!1});for(var n=0,i=r;n<i.length;n++){var s=i[n];if(s.startTime<=e){if(t.returnInactive||e<=s.endTime)return s.value;break}}},closeActive:function(e){var t=r[0];t&&t.endTime===Yr&&t.close(e)},findAll:function(e,t){void 0===e&&(e=Yr),void 0===t&&(t=0);var n=sn(e,t);return r.filter((function(t){return t.startTime<=n&&e<=t.endTime})).map((function(e){return e.value}))},reset:function(){r=[]},stop:function(){Xe(i)}}}var Zr=Qt,Qr=lr,ei=[];function ti(e,t,n,r){var i=new ft,s=new ft,o=Rr(e.sessionStoreStrategyType,t,n);ei.push((function(){return o.stop()}));var a=Xr({expireDelay:Qr});function c(){return{id:o.getSession().id,trackingType:o.getSession()[t],isReplayForced:!!o.getSession().forcedReplay}}return ei.push((function(){return a.stop()})),o.renewObservable.subscribe((function(){a.add(c(),nn()),i.notify()})),o.expireObservable.subscribe((function(){s.notify(),a.closeActive(nn())})),o.expandOrRenewSession(),a.add(c(),[0,an()][0]),r.observable.subscribe((function(){r.isGranted()?o.expandOrRenewSession():o.expire()})),function(e,t){var n=yt(e,window,["click","touchstart","keydown","scroll"],t,{capture:!0,passive:!0}).stop;ei.push(n)}(e,(function(){r.isGranted()&&o.expandOrRenewSession()})),function(e,t){var n=function(){"visible"===document.visibilityState&&t()},r=vt(e,document,"visibilitychange",n).stop;ei.push(r);var i=Ye(n,Zr);ei.push((function(){Xe(i)}))}(e,(function(){return o.expandSession()})),function(e,t){var n=vt(e,window,"resume",t,{capture:!0}).stop;ei.push(n)}(e,(function(){return o.restartSession()})),{findSession:function(e,t){return a.find(e,t)},renewObservable:i,expireObservable:s,sessionStateUpdateObservable:o.sessionStateUpdateObservable,expire:o.expire,updateSessionState:o.updateSessionState}}function ni(e,t){var n=ti(e,"logs",(function(t){return function(e,t){var n=function(e){return"0"===e||"1"===e}(t)?t:ri(e);return{trackingType:n,isTracked:"1"===n}}(e,t)}),t);return{findTrackedSession:function(e,t){void 0===t&&(t={returnInactive:!1});var r=n.findSession(e,t);return r&&"1"===r.trackingType?{id:r.id}:void 0},expireObservable:n.expireObservable}}function ri(e){return un(e.sessionSampleRate)?"1":"0"}var ii=!1;function si(e){var t,n=window;if(Jr()){var r=i(n.DD_RUM_SYNTHETICS);return r||ii||(ii=!0,An("Logs sent before RUM is injected by the synthetics worker",{testId:(t=window._DATADOG_SYNTHETICS_PUBLIC_ID||ar("datadog-synthetics-public-id"),"string"==typeof t?t:void 0),resultId:Kr()})),r}return i(n.DD_RUM);function i(t){if(t&&t.getInternalContext)return t.getInternalContext(e)}}function oi(e,t,n,r,i){var s=Fn.concat(["custom"]),o={};s.forEach((function(e){var n,r,s,a,c;o[e]=(n=e,r=t.eventRateLimiterThreshold,s=i,a=0,c=!1,{isLimitReached:function(){if(0===a&&Je((function(){a=0}),Qt),(a+=1)<=r||c)return c=!1,!1;if(a===r+1){c=!0;try{s({message:"Reached max number of ".concat(n,"s by minute: ").concat(r),source:kn,startClocks:rn()})}finally{c=!1}}return!0}})})),n.subscribe(0,(function(i){var s,a,c=i.rawLogsEvent,u=i.messageContext,l=void 0===u?void 0:u,d=i.savedCommonContext,h=void 0===d?void 0:d,f=i.domainContext,g=on(c.date),p=e.findTrackedSession(g);if(p||t.sendLogsAfterSessionExpiration&&e.findTrackedSession(g,{returnInactive:!0})){var m=h||r(),v=ut({service:t.service,session_id:p?p.id:void 0,session:p?{id:p.id}:void 0,usr:rt(m.user)?void 0:m.user,view:m.view},m.context,si(g),c,l);!1===(null===(s=t.beforeSend)||void 0===s?void 0:s.call(t,v,f))||v.origin!==kn&&(null!==(a=o[v.status])&&void 0!==a?a:o.custom).isLimitReached()||n.notify(1,v)}}))}var ai,ci={};function ui(e){var t=e.map((function(e){return ci[e]||(ci[e]=function(e){return new ft((function(t){var n=xe[e];return xe[e]=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];n.apply(console,r);var s=Ot();Be((function(){t.notify(function(e,t,n){var r,i=e.map((function(e){return function(e){if("string"==typeof e)return lt(e);if(qt(e))return Nt(Et(e));return et(lt(e),void 0,2)}(e)})).join(" ");if(t===Ae.error){var s=function(e,t){for(var n=0;n<e.length;n+=1){var r=e[n];if(t(r,n))return r}}(e,qt);r={stack:s?Bt(Et(s)):void 0,fingerprint:$t(s),causes:s?Ht(s,"console"):void 0,startClocks:rn(),message:i,source:Cn,handling:"handled",handlingStack:n}}return{api:t,message:i,error:r,handlingStack:n}}(r,e,s))}))},function(){xe[e]=n}}))}(e)),ci[e]}));return gt.apply(void 0,t)}var li,di=((ai={})[Ae.log]=Ln.info,ai[Ae.debug]=Ln.debug,ai[Ae.info]=Ln.info,ai[Ae.warn]=Ln.warn,ai[Ae.error]=Ln.error,ai);var hi=new WeakMap;function fi(e){return li||(li=function(e){return new ft((function(t){var n=Gn(XMLHttpRequest.prototype,"open",gi).stop,r=Gn(XMLHttpRequest.prototype,"send",(function(n){!function(e,t,n){var r=e.target,i=e.handlingStack,s=hi.get(r);if(!s)return;var o=s;o.state="start",o.startClocks=rn(),o.isAborted=!1,o.xhr=r,o.handlingStack=i;var a=!1,c=Gn(r,"onreadystatechange",(function(){r.readyState===XMLHttpRequest.DONE&&u()})).stop,u=function(){if(l(),c(),!a){a=!0;var e,t=s;t.state="complete",t.duration=(e=o.startClocks.timeStamp,tn()-e),t.status=r.status,n.notify(qe({},t))}},l=vt(t,r,"loadend",u).stop;n.notify(o)}(n,e,t)}),{computeHandlingStack:!0}).stop,i=Gn(XMLHttpRequest.prototype,"abort",pi).stop;return function(){n(),r(),i()}}))}(e)),li}function gi(e){var t=e.target,n=e.parameters,r=n[0],i=n[1];hi.set(t,{state:"open",method:String(r).toUpperCase(),url:Vn(String(i))})}function pi(e){var t=e.target,n=hi.get(t);n&&(n.isAborted=!0)}function mi(e){return e>=500}function vi(e,t){if(!e.forwardErrorsToLogs)return{stop:Qe};var n=fi(e).subscribe((function(e){"complete"===e.state&&i("xhr",e)})),r=Xn().subscribe((function(e){"resolve"===e.state&&i("fetch",e)}));function i(n,r){var i;function s(e){var i={isAborted:r.isAborted,handlingStack:r.handlingStack};t.notify(0,{rawLogsEvent:{message:"".concat(bi(n)," error ").concat(r.method," ").concat(r.url),date:r.startClocks.timeStamp,error:{stack:e||"Failed to load",handling:void 0},http:{method:r.method,status_code:r.status,url:r.url},status:Ln.error,origin:Pn},domainContext:i})}i=r.url,Xt.every((function(e){return je(i,e)}))||!function(e){return 0===e.status&&"opaque"!==e.responseType}(r)&&!mi(r.status)||("xhr"in r?function(e,t,n){"string"==typeof e.response?n(yi(e.response,t)):n(e.response)}(r.xhr,e,s):r.response?function(e,t,n){var r=function(e){try{return e.clone()}catch(e){return}}(e);r&&r.body?window.TextDecoder?function(e,t,n){!function(e,t,n){var r=e.getReader(),i=[],s=0;function o(){var e,o;if(r.cancel().catch(Qe),n.collectStreamBody){var a;if(1===i.length)a=i[0];else{a=new Uint8Array(s);var c=0;i.forEach((function(e){a.set(e,c),c+=e.length}))}e=a.slice(0,n.bytesLimit),o=a.length>n.bytesLimit}t(void 0,e,o)}!function e(){r.read().then(Oe((function(t){t.done?o():(n.collectStreamBody&&i.push(t.value),(s+=t.value.length)>n.bytesLimit?o():e())})),Oe((function(e){return t(e)})))}()}(e,(function(e,t,r){if(e)n(e);else{var i=(new TextDecoder).decode(t);r&&(i+="..."),n(void 0,i)}}),{bytesLimit:t,collectStreamBody:!0})}(r.body,t.requestErrorResponseLengthLimit,(function(e,t){n(e?"Unable to retrieve response: ".concat(e):t)})):r.text().then(Oe((function(e){return n(yi(e,t))})),Oe((function(e){return n("Unable to retrieve response: ".concat(e))}))):n()}(r.response,e,s):r.error&&function(e,t,n){n(yi(Bt(Et(e)),t))}(r.error,e,s))}return{stop:function(){n.unsubscribe(),r.unsubscribe()}}}function yi(e,t){return e.length>t.requestErrorResponseLengthLimit?"".concat(e.substring(0,t.requestErrorResponseLengthLimit),"..."):e}function bi(e){return"xhr"===e?"XHR":"Fetch"}function wi(e){var t,n=function(t,n){var r=Ft({stackTrace:t,originalError:n,startClocks:rn(),nonErrorPrefix:"Uncaught",source:Mn,handling:"unhandled"});e.notify(r)},r=(t=n,Gn(window,"onerror",(function(e){var n,r=e.parameters,i=r[0],s=r[1],o=r[2],a=r[3],c=r[4];n=qt(c)?Et(c):Rt(i,s,o,a),t(n,null!=c?c:i)}))).stop,i=function(e){return Gn(window,"onunhandledrejection",(function(t){var n=t.parameters[0].reason||"Empty reason",r=Et(n);e(r,n)}))}(n).stop;return{stop:function(){r(),i()}}}var Ai,xi=function(){function e(){this.callbacks={}}return e.prototype.notify=function(e,t){var n=this.callbacks[e];n&&n.forEach((function(e){return e(t)}))},e.prototype.subscribe=function(e,t){var n=this;return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),{unsubscribe:function(){n.callbacks[e]=n.callbacks[e].filter((function(e){return t!==e}))}}},e}();function Ei(e){return{handleLog:function(t,n,r,i,s){var o=ut(n.getContext(),t.context);if(Rn(t.status,jn,n)&&function(e,t){var n=e.status,r=e.message;Ee[Si[n]].call(xe,r,t)}(t,o),Rn(t.status,Un,n)){var a={rawLogsEvent:{date:s||tn(),message:t.message,status:t.status,origin:In},messageContext:o,savedCommonContext:i};r&&(a.domainContext={handlingStack:r}),e.notify(0,a)}}}}var Si=((Ai={})[Ln.ok]=Ae.debug,Ai[Ln.debug]=Ae.debug,Ai[Ln.info]=Ae.info,Ai[Ln.notice]=Ae.info,Ai[Ln.warn]=Ae.warn,Ai[Ln.error]=Ae.error,Ai[Ln.critical]=Ae.error,Ai[Ln.alert]=Ae.error,Ai[Ln.emerg]=Ae.error,Ai);function Ti(e){var t=e.encoder,n=e.request,r=e.flushController,i=e.messageBytesLimit,s={},o=r.flushObservable.subscribe((function(e){return function(e){var r=Fe(s).join("\n");s={};var i=(a=e.reason,je(Fe(zr),a)),o=i?n.sendOnExit:n.send;var a;if(i&&t.isAsync){var c=t.finishSync();c.outputBytesCount&&o(_i(c));var u=[c.pendingData,r].filter(Boolean).join("\n");u&&o({data:u,bytesCount:Ve(u)})}else r&&t.write(t.isEmpty?r:"\n".concat(r)),t.finish((function(e){o(_i(e))}))}(e)}));function a(e,n){var o=et(e),a=t.estimateEncodedBytesCount(o);a>=i?Te.warn("Discarded a message whose size was bigger than the maximum allowed size ".concat(i,"KB. ").concat(Ce," ").concat(ke,"/#technical-limitations")):(function(e){return void 0!==e&&void 0!==s[e]}(n)&&function(e){var n=s[e];delete s[e];var i=t.estimateEncodedBytesCount(n);r.notifyAfterRemoveMessage(i)}(n),function(e,n,i){r.notifyBeforeAddMessage(n),void 0!==i?(s[i]=e,r.notifyAfterAddMessage()):t.write(t.isEmpty?e:"\n".concat(e),(function(e){r.notifyAfterAddMessage(e-n)}))}(o,a,n))}return{flushController:r,add:a,upsert:a,stop:o.unsubscribe}}function _i(e){return{data:"string"==typeof e.output?e.output:new Blob([e.output],{type:"text/plain"}),bytesCount:e.outputBytesCount,encoding:e.encoding}}var ki=3145728,Ci=Zt;function Ii(e,t,n,r,i){0===t.transportStatus&&0===t.queuedPayloads.size()&&t.bandwidthMonitor.canHandle(e)?Mi(e,t,n,{onSuccess:function(){return Di(0,t,n,r,i)},onFailure:function(){t.queuedPayloads.enqueue(e),Pi(t,n,r,i)}}):t.queuedPayloads.enqueue(e)}function Pi(e,t,n,r){2===e.transportStatus&&Je((function(){Mi(e.queuedPayloads.first(),e,t,{onSuccess:function(){e.queuedPayloads.dequeue(),e.currentBackoffTime=Ci,Di(1,e,t,n,r)},onFailure:function(){e.currentBackoffTime=Math.min(6e4,2*e.currentBackoffTime),Pi(e,t,n,r)}})}),e.currentBackoffTime)}function Mi(e,t,n,r){var i=r.onSuccess,s=r.onFailure;t.bandwidthMonitor.add(e),n(e,(function(n){t.bandwidthMonitor.remove(e),!function(e){return"opaque"!==e.type&&(0===e.status&&!navigator.onLine||408===e.status||429===e.status||mi(e.status))}(n)?(t.transportStatus=0,i()):(t.transportStatus=t.bandwidthMonitor.ongoingRequestCount>0?1:2,e.retry={count:e.retry?e.retry.count+1:1,lastFailureStatus:n.status},s())}))}function Di(e,t,n,r,i){0===e&&t.queuedPayloads.isFull()&&!t.queueFullReported&&(i({message:"Reached max ".concat(r," events size queued for upload: ").concat(3,"MiB"),source:kn,startClocks:rn()}),t.queueFullReported=!0);var s=t.queuedPayloads;for(t.queuedPayloads=Ri();s.size()>0;)Ii(s.dequeue(),t,n,r,i)}function Ri(){var e=[];return{bytesCount:0,enqueue:function(t){this.isFull()||(e.push(t),this.bytesCount+=t.bytesCount)},first:function(){return e[0]},dequeue:function(){var t=e.shift();return t&&(this.bytesCount-=t.bytesCount),t},size:function(){return e.length},isFull:function(){return this.bytesCount>=ki}}}function Li(e,t,n){var r={transportStatus:0,currentBackoffTime:Ci,bandwidthMonitor:{ongoingRequestCount:0,ongoingByteCount:0,canHandle:function(e){return 0===this.ongoingRequestCount||this.ongoingByteCount+e.bytesCount<=81920&&this.ongoingRequestCount<32},add:function(e){this.ongoingRequestCount+=1,this.ongoingByteCount+=e.bytesCount},remove:function(e){this.ongoingRequestCount-=1,this.ongoingByteCount-=e.bytesCount}},queuedPayloads:Ri(),queueFullReported:!1},i=function(n,r){return function(e,t,n,r){var i=function(){try{return window.Request&&"keepalive"in new Request("http://a")}catch(e){return!1}}()&&n.bytesCount<t;if(i){var s=e.build("fetch",n);fetch(s,{method:"POST",body:n.data,keepalive:!0,mode:"cors"}).then(Oe((function(e){return null==r?void 0:r({status:e.status,type:e.type})})),Oe((function(){Bi(e.build("xhr",n),n.data,r)})))}else{Bi(e.build("xhr",n),n.data,r)}}(e,t,n,r)};return{send:function(t){Ii(t,r,i,e.trackType,n)},sendOnExit:function(n){!function(e,t,n){var r=!!navigator.sendBeacon&&n.bytesCount<t;if(r)try{var i=e.build("beacon",n);if(navigator.sendBeacon(i,n.data))return}catch(e){!function(e){Oi||(Oi=!0,xn(e))}(e)}var s=e.build("xhr",n);Bi(s,n.data)}(e,t,n)}}}var Oi=!1;function Bi(e,t,n){var r=new XMLHttpRequest;r.open("POST",e,!0),t instanceof Blob&&r.setRequestHeader("Content-Type",t.type),vt({allowUntrustedEvents:!0},r,"loadend",(function(){null==n||n({status:r.status})}),{once:!0}),r.send(t)}function Ni(e){var t,n=e.messagesLimit,r=e.bytesLimit,i=e.durationLimit,s=e.pageExitObservable,o=e.sessionExpireObservable,a=s.subscribe((function(e){return h(e.reason)})),c=o.subscribe((function(){return h("session_expire")})),u=new ft((function(){return function(){a.unsubscribe(),c.unsubscribe()}})),l=0,d=0;function h(e){if(0!==d){var t=d,n=l;d=0,l=0,f(),u.notify({reason:e,messagesCount:t,bytesCount:n})}}function f(){Ke(t),t=void 0}return{flushObservable:u,get messagesCount(){return d},notifyBeforeAddMessage:function(e){l+e>=r&&h("bytes_limit"),d+=1,l+=e,void 0===t&&(t=Je((function(){h("duration_limit")}),i))},notifyAfterAddMessage:function(e){void 0===e&&(e=0),l+=e,d>=n?h("messages_limit"):l>=r&&h("bytes_limit")},notifyAfterRemoveMessage:function(e){l-=e,0===(d-=1)&&f()}}}function ji(e,t,n,r,i,s,o){void 0===o&&(o=Ti);var a=u(e,t),c=n&&u(e,n);function u(e,t){var n=t.endpoint,a=t.encoder;return o({encoder:a,request:Li(n,e.batchBytesLimit,r),flushController:Ni({messagesLimit:e.batchMessagesLimit,bytesLimit:e.batchBytesLimit,durationLimit:e.flushTimeout,pageExitObservable:i,sessionExpireObservable:s}),messageBytesLimit:e.messageBytesLimit})}return{flushObservable:a.flushController.flushObservable,add:function(e,t){void 0===t&&(t=!0),a.add(e),c&&t&&c.add(n.transformMessage?n.transformMessage(e):e)},upsert:function(e,t){a.upsert(e,t),c&&c.upsert(n.transformMessage?n.transformMessage(e):e,t)},stop:function(){a.stop(),c&&c.stop()}}}function Ui(){var e="",t=0;return{isAsync:!1,get isEmpty(){return!e},write:function(n,r){var i=Ve(n);t+=i,e+=n,r&&r(i)},finish:function(e){e(this.finishSync())},finishSync:function(){var n={output:e,outputBytesCount:t,rawBytesCount:t,pendingData:""};return e="",t=0,n},estimateEncodedBytesCount:function(e){return e.length}}}function Fi(e,t,n,r,i){var s=wn("browser-logs-sdk",t);s.setContextProvider((function(){var e,t,n,r,s,o;return{application:{id:null===(e=si())||void 0===e?void 0:e.application_id},session:{id:null===(t=i.findTrackedSession())||void 0===t?void 0:t.id},view:{id:null===(r=null===(n=si())||void 0===n?void 0:n.view)||void 0===r?void 0:r.id},action:{id:null===(o=null===(s=si())||void 0===s?void 0:s.user_action)||void 0===o?void 0:o.id}}}));var o=[];if(Wn()){var a=Hn(),c=s.observable.subscribe((function(e){return a.send("internal_telemetry",e)}));o.push((function(){return c.unsubscribe()}))}else{var u=ji(t,{endpoint:t.rumEndpointBuilder,encoder:Ui()},t.replica&&{endpoint:t.replica.rumEndpointBuilder,encoder:Ui()},n,r,i.expireObservable);o.push((function(){return u.stop()}));var l=s.observable.subscribe((function(e){return u.add(e,function(e){return"datad0g.com"===e.site}(t))}));o.push((function(){return l.unsubscribe()}))}return yn.drain(),function(e){bn({type:gn,configuration:e})}(function(e){var t,n={session_sample_rate:(t=e).sessionSampleRate,telemetry_sample_rate:t.telemetrySampleRate,telemetry_configuration_sample_rate:t.telemetryConfigurationSampleRate,telemetry_usage_sample_rate:t.telemetryUsageSampleRate,use_before_send:!!t.beforeSend,use_cross_site_session_cookie:t.useCrossSiteSessionCookie,use_partitioned_cross_site_session_cookie:t.usePartitionedCrossSiteSessionCookie,use_secure_session_cookie:t.useSecureSessionCookie,use_proxy:!!t.proxy,silent_multiple_init:t.silentMultipleInit,track_session_across_subdomains:t.trackSessionAcrossSubdomains,allow_fallback_to_local_storage:!!t.allowFallbackToLocalStorage,store_contexts_across_pages:!!t.storeContextsAcrossPages,allow_untrusted_events:!!t.allowUntrustedEvents,tracking_consent:t.trackingConsent};return qe({forward_errors_to_logs:e.forwardErrorsToLogs,forward_console_logs:e.forwardConsoleLogs,forward_reports:e.forwardReports,use_pci_intake:e.usePciIntake,send_logs_after_session_expiration:e.sendLogsAfterSessionExpiration},n)}(e)),{telemetry:s,stop:function(){o.forEach((function(e){return e()}))}}}var $i=function(e){var t,n,r=it(),i=pt(r.getOrCreateTracker(2)),s=pt(r.getOrCreateTracker(1)),o={tryToInit:function(e){t||(t=e)},update:function(e){t=e,n.notify()},isGranted:function(){return t===mt.GRANTED},observable:n=new ft};function a(){return function(e,t){return{view:{referrer:document.referrer,url:window.location.href},context:e.getContext(),user:t.getContext()}}(i,s)}var c,u,l=Gr(a,o,(function(t,n){t.storeContextsAcrossPages&&(At(n,i,Vr,2),At(n,s,Vr,1));var r=e(t,n,a,o);return l=function(e,t){return qe({init:function(e){Tn("DD_LOGS",e)},initConfiguration:e},t)}(t,r),r})),d={},h=new $n((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return l.handleLog.apply(l,e)}),r.createDetachedTracker());return c={logger:h,init:Oe((function(e){return l.init(e)})),setTrackingConsent:Oe((function(e){o.update(e),bn({type:pn,usage:{feature:"set-tracking-consent",tracking_consent:e}})})),getGlobalContext:Oe((function(){return i.getContext()})),setGlobalContext:Oe((function(e){return i.setContext(e)})),setGlobalContextProperty:Oe((function(e,t){return i.setContextProperty(e,t)})),removeGlobalContextProperty:Oe((function(e){return i.removeContextProperty(e)})),clearGlobalContext:Oe((function(){return i.clearContext()})),createLogger:Oe((function(e,t){return void 0===t&&(t={}),d[e]=new $n((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return l.handleLog.apply(l,e)}),r.createDetachedTracker(),lt(e),t.handler,t.level,lt(t.context)),d[e]})),getLogger:Oe((function(e){return d[e]})),getInitConfiguration:Oe((function(){return ct(l.initConfiguration)})),getInternalContext:Oe((function(e){return l.getInternalContext(e)})),setUser:Oe((function(e){(function(e){var t="object"===ot(e);return t||Te.error("Unsupported user:",e),t})(e)&&s.setContext(Sn(e))})),getUser:Oe((function(){return s.getContext()})),setUserProperty:Oe((function(e,t){var n,r=Sn((n={},n[e]=t,n))[e];s.setContextProperty(e,r)})),removeUserProperty:Oe((function(e){return s.removeContextProperty(e)})),clearUser:Oe((function(){return s.clearContext()}))},u=qe({version:"5.33.0",onReady:function(e){e()}},c),Object.defineProperty(u,"_setDebug",{get:function(){return Re},enumerable:!1}),u}((function(e,t,n,r){var i=new xi,s=[];i.subscribe(1,(function(e){return cn("logs",e)}));var o=function(e){return function(t){e.notify(0,{rawLogsEvent:{message:t.message,date:t.startClocks.timeStamp,origin:kn,status:Ln.error}}),An("Error reported to customer",{"error.message":t.message})}}(i),a=function(e){return new ft((function(t){var n=yt(e,window,["visibilitychange","freeze"],(function(e){"visibilitychange"===e.type&&"hidden"===document.visibilityState?t.notify({reason:zr.HIDDEN}):"freeze"===e.type&&t.notify({reason:zr.FROZEN})}),{capture:!0}).stop,r=vt(e,window,"beforeunload",(function(){t.notify({reason:zr.UNLOADING})})).stop;return function(){n(),r()}}))}(t),c=!t.sessionStoreStrategyType||Wn()||Jr()?function(e){var t="1"===ri(e)?{}:void 0;return{findTrackedSession:function(){return t},expireObservable:new ft}}(t):ni(t,r),u=Fi(e,t,o,a,c).stop;s.push((function(){return u()})),vi(t,i),function(e,t){if(!e.forwardErrorsToLogs)return{stop:Qe};var n=new ft,r=wi(n).stop,i=n.subscribe((function(e){t.notify(0,{rawLogsEvent:{message:e.message,date:e.startClocks.timeStamp,error:Bn(e),origin:Mn,status:Ln.error}})}))}(t,i),function(e,t){var n=ui(e.forwardConsoleLogs).subscribe((function(e){var n={rawLogsEvent:{date:tn(),message:e.message,origin:Cn,error:e.error&&Bn(e.error),status:di[e.api]},domainContext:{handlingStack:e.handlingStack}};t.notify(0,n)}))}(t,i),function(e,t){var n=$r(e,e.forwardReports).subscribe((function(e){var n,r=e.message,i="deprecation"===e.originalError.type?Ln.warn:Ln.error;i===Ln.error?n=Bn(e):e.stack&&(r+=" Found in ".concat(function(e){var t;return null===(t=/@ (.+)/.exec(e))||void 0===t?void 0:t[1]}(e.stack))),t.notify(0,{rawLogsEvent:{date:tn(),message:r,origin:Dn,error:n,status:i}})}))}(t,i);var l,d=Ei(i).handleLog;if(oi(c,t,i,n,o),Wn())!function(e){var t=Hn();e.subscribe(1,(function(e){t.send("log",e)}))}(i);else{var h=function(e,t,n,r,i){var s=ji(e,{endpoint:e.logsEndpointBuilder,encoder:Ui()},e.replica&&{endpoint:e.replica.logsEndpointBuilder,encoder:Ui()},n,r,i.expireObservable);return t.subscribe(1,(function(e){s.add(e)})),s}(t,i,o,a,c).stop;s.push((function(){return h()}))}return{handleLog:d,getInternalContext:(l=c,{get:function(e){var t=l.findTrackedSession(e);if(t)return{session_id:t.id}}}).get,stop:function(){s.forEach((function(e){return e()}))}}}));!function(e,t,n){var r=e[t];r&&!r.q&&r.version&&Te.warn("SDK is loaded more than once. This is unsupported and might have unexpected behavior."),e[t]=n,r&&r.q&&r.q.forEach((function(e){return Ie(e,"onReady callback threw an error:")()}))}(He(),"DD_LOGS",$i);const qi=new class{getKey(e){return"GBR"===le.region?`gbr.${e}`:e}set(e,t){try{return ne.set(this.getKey(e),t)}catch(e){$i.logger.error("IndexedDB Error",e.message)}return Promise.resolve()}delete(e){return ne.delete(this.getKey(e))}get(e){try{return ne.get(this.getKey(e))}catch(e){return $i.logger.error("IndexedDB Error",e.message),Promise.resolve(null)}}};function Hi(e,t){const n=Gi(t).toString();return n?e+(e.includes("?")?"&":"?")+n:e}function Wi(e,t){const n=Gi(t);if(""===n.toString())return e.toString();const r="string"==typeof e?new URL(e):e;return n.forEach(((e,t)=>{r.searchParams.set(t,e)})),r.toString()}function Gi(e){if("object"==typeof e){const t={...e};for(const e in t)void 0!==t[e]&&""!==t[e]||delete t[e];return new URLSearchParams(t)}return new URLSearchParams(e)}function Vi(e,t={}){e instanceof URL&&(e=e.toString());const n=new Request(e,t);if(n.headers.append("X-Button-Version",b.extension.version),n.url.includes(ge(C))){n.headers.append("Client-Agent","button"),n.headers.append("Content-Type","application/json");const e=n.headers.get("If-None-Match");e&&n.headers.append("RR-If-None-Match",e)}return self.EBATES&&(n.url.search(/(?!button|mobile|eds)\/member/)>0||n.url.search(/\/geogating\/v1\/checkStatus\.do/)>0)&&n.headers.append("ebToken",self.EBATES.ebToken??""),n}async function zi(e,t={}){"object"!=typeof e||e instanceof URL||(e=(t=e).url),t.beforeSend&&t.beforeSend(t);const n=t.method||t.type||"GET",r=new Headers(t.headers||{});t.contentType&&r.set("Content-Type",t.contentType),function(e,t=""){if(!e.get("Accept")){const n={text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"};e.set("Accept",Object.keys(n).includes(t)?`${n[t]}, */*; q=0.01`:"*/*")}}(r,t.dataType),"GET"===n&&"object"==typeof t.data&&(e=Hi(e.toString(),t.data));const i={method:n,headers:r};"POST"===n&&(i.body=t.data||t.body);const s=Vi(e,i);let o=null;try{o=await async function(e,t){return t&&AbortSignal.timeout?fetch(e,{signal:AbortSignal.timeout(t)}):fetch(e)}(s,t.timeout)}catch{return void Ji(o,t)}return async function(e,t={}){if(304===e.status)t.success&&t.success(void 0,e.status,e);else{if(e.ok&&e.status>=200&&e.status<300){const n=(()=>e.headers.get("Content-Type")?.includes("application/json"))()?await e.json():await e.text();return t.success&&t.success(n,e.status,e),n}Ji(e,t)}}(o,t)}function Ji(e,t={}){const n=new Error("Network error");if(e=e||{status:0},!t.error)throw n;t.error(e,e.status,n)}function Ki(e){const t=(e.get("cache-control")??"").match(/max-age=(\d+)[\s;,]?/);return t&&t.length>1?1e3*parseInt(t[1],10):0}class Yi{meta={nextUpdateTime:0,headers:{}};data=null}const Xi="Network error";class Zi extends(M()){cache=null;errorAttempt=0;MAX_ERROR_ATTEMPT=4;_promise=null;UPDATE_INTERVAL=0;DEFAULT_UPDATE_INTERVAL=9e5;ERROR_UPDATE_INTERVAL=0;constructor(){super()}get headers(){return{}}get _headers(){const e={...this.headers},t=this.cache?.meta?.headers?.etag;return t&&!e["If-None-Match"]&&(e["If-None-Match"]=t),e}parse(e){return e}getData(){return this.cache?.data}async verifyInternalCache(){const{data:e,meta:t}=this.cache??await this.getStorageCache();if(t){if(this.cache={data:e,meta:t},t.nextUpdateTime&&Date.now()<t.nextUpdateTime){if(!this.errorAttempt)return e;throw new Error(Xi)}throw new Error("Data expired")}throw new Error("Invalid cache")}async load(e={}){const{reset:t}=e;return t&&this.clearCache(),this._promise||(this._promise=this.verifyInternalCache().catch((t=>{if(t.message===Xi)throw new Error(Xi);return this.fetch(e)})).finally((()=>(this._promise=null,this.cache)))),this._promise}async save(e,t){return this.cache={data:e,meta:t},qi.set(this._id,{data:e,meta:t})}async readCache(){return this.cache=await this.getStorageCache(),this.cache}async clearCache(){return this.cache=null,qi.delete(this._id)}async getStorageCache(){return await qi.get(this._id)??new Yi}async fetch({reset:e=!1,url:t,method:n="GET",data:r,body:i,headers:s={}}={}){let o;this.emit("beforeRequest",this),e&&(s["Cache-Control"]="max-age=0, no-cache",s.Pragma="no-cache");const a={nextUpdateTime:0,headers:{}},c={meta:a,data:null},u=e=>{const t=this.ERROR_UPDATE_INTERVAL||10*Math.pow(3,Math.min(this.MAX_ERROR_ATTEMPT,++this.errorAttempt))*1e3,{meta:n=a,data:r}=this.cache||c;return n.nextUpdateTime=Date.now()+t,this.save(r,n),new Error(Xi)};try{o=await function(e,t){const n=Vi(e,t);return fetch(n)}(t??this.url,{method:n,mode:"cors",headers:{...this._headers,...s},data:r,body:i})}catch(e){throw u()}if(304===o.status){const{meta:e=a,data:t}=this.cache||c;return e.nextUpdateTime=this.getNextUpdateTime(o.headers),this.errorAttempt=0,this.save(t,e),this.emit("sync",this),t}if(o.ok){const e=await o.json(),t={nextUpdateTime:this.getNextUpdateTime(o.headers),headers:["cache-control","etag","date"].reduce(((e,t)=>(e[t]=o.headers.get(t),e)),{})};this.errorAttempt=0;const n=this.parse(e);return this.save(n,t),this.emit("sync",this),n}throw u()}getNextUpdateTime(e){let t=this.DEFAULT_UPDATE_INTERVAL;if(this.UPDATE_INTERVAL)t=this.UPDATE_INTERVAL;else{const n=Ki(e);n>0&&(t=n)}return Date.now()+t}}const Qi=new class extends Zi{_id="feature-flags";UPDATE_INTERVAL=72e5;_variations={};constructor(){super(),this.get=this.variation}get url(){const e={region:le.region,browser:b.browser.name,version:de.version};return Wi(le.get("FEATUREFLAGS_URL"),e)}get headers(){return{"APP-ID":le.get("FEATUREFLAGS_APPID"),"API-KEY":le.get("FEATUREFLAGS_APIKEY")}}async init(){b.browser.attachEvent(b.browser.DOCUMENTCOMPLETE,(0,I.throttle)((async()=>{this.sync()}),1e3)),await this.readCache(),this._variations=this.getData()??{}}async sync(){if(await this.ifUpdateRequired()){try{const e=await this.load();this.emitChangeEvents(e),this._variations=e}catch{}return this}}async ifUpdateRequired(){try{return await this.verifyInternalCache(),!1}catch(e){return!0}}emitChangeEvents(e){const t={};[...new Set([...Object.keys(this._variations),...Object.keys(e)])].forEach((n=>{const r=e[n];this._variations[n]!==r&&(t[n]=r)})),Object.entries(t).forEach((([e,t])=>{this.emit(`change:${e}`,t)}))}variation(e,t=!1){return this._variations[e]??t}toJSON(){return JSON.parse(JSON.stringify(this._variations))}};let es=function(e){return e.SurfaceVisited="SurfaceVisited",e.ApplicationInstalled="ApplicationInstalled",e.HoverDismissed="HoverDismissed",e.HoverViewed="HoverViewed",e.ShoppingTripStarted="ShoppingTripStarted",e.PriceMagicMismatch="PriceMagicMismatch",e.MerchantTripStarted="MerchantTripStarted",e.MerchantPageViewed="MerchantPageViewed",e.SerpContentInjected="SerpContentInjected",e.ApplicationDetected="ApplicationDetected",e.ReferAFriendViewed="ReferAFriendViewed",e.ReferAFriendStarted="ReferAFriendStarted",e.ReferAFriendCompleted="ReferAFriendCompleted",e.WebsiteVisited="WebsiteVisited",e.ConfirmationHoverViewed="ConfirmationHoverViewed",e.CartDetailsCaptured="CartDetailsCaptured",e.OrderPlaced="OrderPlaced",e}({});const ts={[es.SurfaceVisited]:{type:"Surface Visited",schema_id:952},[es.ApplicationInstalled]:{type:"Application Installed",schema_id:972},[es.HoverViewed]:{type:"Hover Viewed",schema_id:962},[es.HoverDismissed]:{type:"Hover Dismissed",schema_id:997},[es.PriceMagicMismatch]:{type:"Price Magic Mismatch",schema_id:748},[es.ShoppingTripStarted]:{type:"Shopping Trip Started",schema_id:992},[es.MerchantTripStarted]:{type:"Merchant Trip Started",schema_id:1135},[es.MerchantPageViewed]:{type:"Merchant Page Viewed",schema_id:1356},[es.SerpContentInjected]:{type:"Serp Content Injected",schema_id:970},[es.ApplicationDetected]:{type:"Application Detected",schema_id:1301},[es.ReferAFriendViewed]:{type:"Refer A Friend Viewed",schema_id:1087},[es.ReferAFriendStarted]:{type:"Refer A Friend Started",schema_id:1089},[es.ReferAFriendCompleted]:{type:"Refer A Friend Completed",schema_id:1088},[es.WebsiteVisited]:{type:"Website Visited",schema_id:1231},[es.ConfirmationHoverViewed]:{type:"Confirmation Hover Viewed",schema_id:1260},[es.CartDetailsCaptured]:{type:"Cart Details Captured",schema_id:1206},[es.OrderPlaced]:{type:"Order Placed",schema_id:1220}};async function ns(){b.extension.attachEvent("SurfaceVisitedData",(async function e({tabId:t,data:n}){if(t===r){const{referring_visit_id:t,campaign:r,legacy_campaign:i}=n;self.EBATES.holistic.track({event:es.SurfaceVisited,data:{...Object.keys(r).length&&{campaign:r},...Object.keys(i).length&&{legacy_campaign:i},...t&&{referring_visit_id:t}}}),b.extension.detachEvent("SurfaceVisitedData",e)}}));const e=await ce(le.homedomain,"extension-install-source").catch((()=>"")),{url:t,tabId:r}=await async function(e){let t;if(/(?:step2|EB-Test1\d{2,}A)/.test(e)){t=ge("%domain%?sourceName=toolbar&eeid=45426&toolbarId=%toolbarId&visit_id=%visitId");return{url:t,tabId:(await b.browser.navigate({url:t,tabId:b.browser.NEWTAB},(({id:e})=>{setTimeout((()=>b.extension.fireEvent("welcome",{tabId:e})),2500)}))).id}}return t=ge(k.WEB_INSTALL),{url:t,tabId:(await b.browser.navigate(t)).id}}(e),i=await async function(){try{const e="JSESSIONID";return await ce(le.get("domain"),e)||new Promise((t=>{function r({cookie:s}){s.domain===le.get("domain")&&s.name===e&&s.value&&(clearTimeout(i),n().cookies.onChanged.removeListener(r),t(s.value))}n().cookies.onChanged.addListener(r);const i=setTimeout((()=>{n().cookies.onChanged.removeListener(r),t("")}),8e3)}))}catch(e){return""}}(),s=await new Promise((e=>{chrome?.instanceID?.getID?chrome.instanceID.getID(e):e(null)}));await b.extension.setItem("installationSource",e),await b.extension.setItem("installSessionId",i),b.browser.isWebkit&&n().windows.getAll({populate:!0}).then((e=>{e.forEach((e=>{e?.tabs?.forEach((({id:e,url:t})=>{t?.includes(ge("%domain/button-landing/"))&&n().tabs.update(e,{url:t})}))}))})),self.EBATES.segment.track("Install Application",{attribution_source:e,desktop_session_id:i,url:t,instanceId:s}),self.EBATES.holistic.track({event:es.ApplicationInstalled,data:{attribution_source:e,toolbar_id:`${self.EBATES.toolbarId}`}})}let rs=function(e){return e[e.DEFAULT=4]="DEFAULT",e[e.PRICE_MAGIC=23]="PRICE_MAGIC",e[e.SHOPSTYLE=12]="SHOPSTYLE",e}({});const is="toolbar",ss="merchant",os="groupon",as="business\u0421ard",cs="homeDomain",us="inStoreCashBack",ls="priceMagic",ds="processInterstitial",hs="product-page-tracker",fs="SERP",gs="taxesPromo",ps="InstalledExtensions",ms="CouponScraper",vs="similarStores",ys="TcppNotification",bs="PromoNotification",ws={[rs.DEFAULT]:"BUTTON",[rs.PRICE_MAGIC]:"BUTTON_PRICE_MAGIC",[rs.SHOPSTYLE]:"SHOPSTYLE"};let As=function(e){return e[e.TAKEOVER_PREVENTION=38448]="TAKEOVER_PREVENTION",e[e.MPL_STORE=40874]="MPL_STORE",e[e.SHARE_EMAIL=45829]="SHARE_EMAIL",e[e.SHARE_COPY=45830]="SHARE_COPY",e[e.SHARE_FACEBOOK=45831]="SHARE_FACEBOOK",e[e.SHARE_TWITTER=45832]="SHARE_TWITTER",e[e.SHARE_POST_PURCHASE_NOTIFICATION=57122]="SHARE_POST_PURCHASE_NOTIFICATION",e[e.SHARE_RAF_PRODUCT_PAGE=61593]="SHARE_RAF_PRODUCT_PAGE",e[e.PROMO_SERP_BANNER=63100]="PROMO_SERP_BANNER",e}({});const xs="store/radiant-generic/button/store-deals",Es="button/my-deals",Ss="button/notification",Ts="button/serp-ad-feed",_s="button/similar-stores-feed",ks="Post-Purchase notification",Cs="PDP Product Share Widget",Is="Coupons and Cash Back Available Notification - CB CTA",Ps="Coupon Magic Results with CB CTA",Ms="BTN222",Ds="BTN213",Rs="BTN216",Ls="use-bookkeeper-api-and-design-for-extension-in-all-regions",Os="www\\.google\\.com\\/search";class Bs{storage=new Map;backgroundColorUpdated=!1;constructor(){b.extension.attachEvent("updateBadge",(()=>{this.update()}))}update(e,t){self.EBATES.member.isTcppBlocking()?this.setExclamationMark():(this.setDefaultColors(),self.EBATES.settings.userSettings.get("gatingStatusBadge")?b.ui.button.setBadgeText("1"):self.EBATES.member.isExtensionDisabled()?"not-certified"===self.EBATES.member.get("gdprCertificationStatus")?b.ui.button.setBadgeText("1"):b.ui.button.setBadgeText(""):(e&&this.storage.set(e,t??0),this.display()))}setExclamationMark(){b.ui.button.setBadgeText("!"),b.ui.button.setBadgeBackgroundColor("red"),b.ui.button.setBadgeTextColor("white"),this.backgroundColorUpdated=!0}setDefaultColors(){this.backgroundColorUpdated&&(b.ui.button.setBadgeBackgroundColor("black"),b.ui.button.setBadgeTextColor("white"))}display(){let e=0;this.storage.forEach((t=>e+=t)),this.set(e)}set(e){b.ui.button.setBadgeText(e>0?e:"")}}var Ns=i(36337),js=i.n(Ns);js().ajax=zi;const Us=js();function Fs(e){if(e){const t=le.get("domain").replace(/(?:www\.)?/,"").replace(/\./g,"\\.");return new RegExp(`//(?!global\\.)(?:[\\w-]+\\.)?${t}\\/`,"i").test(e)}return!1}const $s=Us.Model.extend({toJSON(){return fe((0,I.clone)(this.attributes))}});let qs={pauseDocumentCompleteTrigerredUpdates:!0,timeout:null,errorAttempt:0,dynamic:!0,loading:!1,MAX_ERROR_ATTEMPT:4,DEFAULT_UPDATE_INTERVAL:9e5,UPDATE_INTERVAL:null,initialize(){this.dynamic&&b.browser.attachEvent(b.browser.DOCUMENTCOMPLETE,(0,I.throttle)((async()=>{!this.pauseDocumentCompleteTrigerredUpdates&&await this.ifCacheExpired()&&this.fetch().catch((()=>{}))}),1e3)),this.once("sync",(()=>this._dataSynced=!0)),this.readCache({cache:!0,silent:!0})},setNextUpdateTime(e){this.key&&b.extension.setItem(`${this.key}.nextUpdateTime`,e),this._nextUpdateTime=e},async getNextUpdateTime(){if(!Number.isFinite(this._nextUpdateTime)){let e=this.key?await b.extension.getItem(`${this.key}.nextUpdateTime`):0;this._nextUpdateTime=parseInt(e,10)||0}return this._nextUpdateTime},async ifCacheExpired(){return await this.getNextUpdateTime()<Date.now()},clearCache(){this.noCache=!0,b.extension.setItem(this.key,{noCache:!0}),this.setNextUpdateTime(0)},getCache(){return b.extension.getItem(this.key)},async saveCache(){const{etag:e,noCache:t}=await this.getCache()??{};this.setCache({etag:e,noCache:t,data:this.attributes})},async setCache({...e}){b.extension.setItem(this.key,e)},async readCache({reset:e,force:t,cache:n,silent:r}){let i;if(this.key&&void 0===this.etag&&(this.etag=null,i=await this.getCache(),i?.data&&(this.etag=i.etag??null)),e||this.noCache||t)return!1;if(!n&&await this.ifCacheExpired())return!1;if(this.key&&(i=i??await this.getCache(),this.noCache=i?.noCache,i?.data)){try{this.length||this.set(this.parse(i.data),{silent:r})}catch(e){return!1}try{this.trigger("sync",this)}catch(e){}return!0}return!1},async sync(e,t,n={}){const r=n.reset||this.noCache||n.force;if("read"!==e)return Us.Collection.prototype.sync.apply(t,arguments);this.pauseDocumentCompleteTrigerredUpdates=!1;if(await this.readCache(n))return this;if(t.loading)return new Promise((function(e){t.once("sync",(function(){t.trigger("sync",t,null,n),e()}))}));t.etag&&!r&&(n.beforeSend=function(e){e.headers=Object.assign({},e.headers,{"If-None-Match":t.etag})}),r&&(n.headers=Object.assign({},n.headers,{"Cache-Control":"max-age=0, no-cache",Pragma:"no-cache"})),this.noCache=!1,t.loading=!0;let i=n.success;return n.success=function(e,r,s){t.loading=!1;try{t.errorAttempt=0;let r=t.DEFAULT_UPDATE_INTERVAL;if(t.UPDATE_INTERVAL)r=t.UPDATE_INTERVAL;else{let e=s.headers.get("Cache-Control");if(e&&e.indexOf("max-age=")>=0){let e=Ki(s.headers);e>0&&(r=e)}}n.headers=s.headers,t.etag=s.headers.get("ETag"),t.setNextUpdateTime(Date.now()+r),t.key&&e&&t.setCache({etag:t.etag,data:e}),i&&200===s.status?i.apply(t,arguments):t.trigger("sync",t)}catch(e){n.error(s)}},n.error=function(e){if(t.loading=!1,[401,403].includes(e.status))t.pauseDocumentCompleteTrigerredUpdates=!0;else{let e=t.ERROR_UPDATE_INTERVAL||10*Math.pow(3,Math.min(t.MAX_ERROR_ATTEMPT,++t.errorAttempt))*1e3;t.setNextUpdateTime(Date.now()+e)}t.trigger("error",t,e,n)},Us.Collection.prototype.sync.call(t,e,t,n)},stop(){this.pauseDocumentCompleteTrigerredUpdates=!0,this.etag=null,b.extension.setItem(`${this.key}.nextUpdateTime`,0)},ready(){return new Promise((e=>{this._dataSynced?e(this):this.once("sync",(()=>e(this)))}))}};const Hs=Us.Collection.extend(qs),Ws=$s.extend(qs);const Gs=$s.extend({timeout:18e5,errorTimeout:3e4,loading:!1,nextUpdateTime:0,sync:function(e,t,n={}){if("read"!==e)return Us.sync.call(this,e,t,n);if(Date.now()<t.nextUpdateTime&&!n.reset&&!n.force)return new Promise((function(e){t.trigger("sync",t,null,n),e()}));if(t.loading)return new Promise((function(e){t.once("sync",(function(){t.trigger("sync",t,null,n),e()}))}));b.browser.isSafari&&(n.reset||n.force)&&(n.data=(0,I.extend)({_:Date.now()},n.data)),t.ETag&&(n.headers=Object.assign({},n.headers,{"If-None-Match":t.ETag})),(n.reset||n.force)&&(n.headers=Object.assign({},n.headers,{"Cache-Control":"max-age=0, no-cache",Pragma:"no-cache"})),t.loading=!0;const r=n.success;n.success=function(e,i,s){t.loading=!1,t.nextUpdateTime=Date.now()+t.timeout,t.ETag=s.headers.get("ETag"),304!==s.status?r&&(n.headers=s.headers,r.apply(t,arguments)):t.trigger("sync",t,e,n)};const i=n.error;return n.error=function(){t.loading=!1,t.nextUpdateTime=Date.now()+t.errorTimeout,i&&i.apply(t,arguments)},Us.sync.call(this,e,t,n)}}),Vs=Us.Collection.extend({sync:(e,t,n)=>new Promise((r=>{"read"===e&&b.extension.getItem(t.key,(e=>{n.success(e),r()}))})),save(){b.extension.setItem(this.key,this.toJSON())}}),zs=Us.Model.extend({sync(e,t,n){return new Promise((t=>{"read"===e?b.extension.getItem(this.key,(e=>{t(),n.success(e)})):"update"!==e&&"create"!==e||(b.extension.setItem(this.key,(0,I.clone)(this.attributes)),t())}))}});class Js extends Map{scriptLoadingProcess=new Map;constructor(){super();const e=({tabId:e,url:t,name:n})=>{const r=Object.assign({},this.get(e),{tabId:e,url:t});n===b.browser.NAVIGATIONCOMMITTED&&(r.scripts=[]),this.set(e,r)};this.getCurrentActiveTab().then((t=>{t&&e({...t,name:"tabsInit"})})),b.browser.attachEvent(b.browser.NAVIGATIONCOMMITTED,e),b.browser.attachEvent(b.browser.TABCHANGED,e),b.browser.attachEvent(b.browser.TABCLOSED,(e=>this.delete(e.tabId))),b.extension.attachEvent("currentTab",(()=>this.getActive()))}async getActive(){const[{id:e=0,url:t="about:blank"}={id:0,url:"about:blank"}]=await n().tabs.query({active:!0,currentWindow:!0});return{tabId:e,url:t}}async executeScript({tabId:e,files:t,signal:r,injectImmediately:i=!1}){Array.isArray(t)||(t=[t]),await this.scriptLoadingProcess.get(e);const s=(async()=>{try{const[s]=await n().scripting.executeScript({target:{tabId:e},injectImmediately:i,func:()=>self["__extension-scripts-loaded"]});s?.result||r?.aborted||(await n().scripting.executeScript({injectImmediately:i,target:{tabId:e},files:t}),await n().scripting.executeScript({injectImmediately:i,target:{tabId:e},func:()=>{self["__extension-scripts-loaded"]=!0}}))}catch(e){}})();this.scriptLoadingProcess.set(e,s);try{await s}finally{this.scriptLoadingProcess.delete(e)}return!0}async getCurrentActiveTab(){const e=await n().tabs.query({active:!0,currentWindow:!0});if(!e.length)return null;const t=e[0],{id:r=0,url:i=""}=t;return{tabId:r,url:i}}}const Ks=new Js;class Ys extends Zi{_id="settings-merchants";DEFAULT_UPDATE_INTERVAL=216e5;constructor(){super()}get url(){return ge(k.SETTINGS_MERCHANTS)}parse(e){return e.merchants.map((e=>(e.track_events=!0,e)))}}var Xs=i(38761),Zs=i.n(Xs);function Qs(e){const t=e=>e.toString().replace(/\.0+$/,"");if(e)switch(e.display){case"Percentage":return e.range&&e.amount?ae.get("formatCashback.tieredCashbackPercentage",{amount:t(e.amount)}):`${t(e.amount)}%`;case"Fixed":return e.amount&&e.range?ae.get("formatCashback.tieredCashbackFixed",{amount:t(Zs().formatMoney(e.amount))}):t(Zs().formatMoney(e.amount));case"Coupons":return ae.get("formatCashback.offersOnly");case"None":return ae.get("formatCashback.notAvailable")}return""}function eo(e,t){if(!e||!t||e.display!==t.display)return NaN;const n=e.amount,r=t.amount;return n>r?1:n===r?0:-1}let to=$s.extend({idAttribute:"storeId",defaults:{reward:null,cashBackDifference:0,lastVisit:Date.now()},recalculateDifference(){let e=EBATES.merchants.get(this.id)?.getReward();if(e&&this.get("reward")){let t=parseFloat(Qs(e).replace(/[^\d.]/g,"")),n=parseFloat(Qs(this.get("reward")).replace(/[^\d.]/g,""));t?this.set({cashBackDifference:t-n}):this.collection.remove(this)}}});const no=Vs.extend({model:to,comparator:(e,t)=>e.get("cashBackDifference")===t.get("cashBackDifference")?e.get("lastVisit")>t.get("lastVisit")?-1:1:e.get("cashBackDifference")>t.get("cashBackDifference")?-1:1,key:"recent",size:500,initialize(){this.on({add:function(){this.sort(),this.length>this.size&&this.pop(),this.save()}})},save(){b.extension.setItem(this.key,this.map((e=>e.attributes)))},visit(e){const t=e.get("storeId"),n=e.getReward(),r=this.add({storeId:t,lastVisit:Date.now()},{merge:!0});if(r.get("reward")){let e=eo(n,r.get("reward"));e<0?(r.set({reward:n}),r.recalculateDifference(),this.save()):e>0&&!r.updateTimeout&&(r.updateTimeout=setTimeout((()=>{let e=this.get(t);e&&(e.set({reward:n}),e.updateTimeout=null,e.recalculateDifference(),this.save())}),9e5))}},async updateRecent(){for(let e=this.length-1;e>=0;e--){let t=this.at(e);const n=t.get("storeId");this.get(n)&&"X"!==await(EBATES.merchants.get(n)?.incrementalityTest())?t.recalculateDifference():this.remove(t)}this.sort(),this.save()}}),ro=3e5;class io extends Map{constructor(){super([[rs.DEFAULT,new oo(rs.DEFAULT)],[rs.PRICE_MAGIC,new oo(rs.PRICE_MAGIC)]]),b.extension.attachEvent("updateRewards",(async({data:e={}})=>{const t=e?.channel??rs.DEFAULT,{storeIds:n="all"}=e;return await(this.get(t)?.fetch(n))}))}get default(){return this.get(rs.DEFAULT)}init(){this.get(rs.DEFAULT)?.initialize(),this.get(rs.PRICE_MAGIC)?.initialize()}add(e){if(isNaN(e))throw new Error("Channel must be defined");this.has(e)||this.set(e,new oo(e))}reset(){this.forEach((e=>e.reset()))}}class so{amount=0;display="None";constructor({storeId:e,reward:t,tiers:n,tiered:r=!1,rakplusTargeted:i=!1}){if(this.storeId=e,this.tiered=r,this.rakplusTargeted=i,t&&(this.amount=t.amount,this.display=t.display,this.range=t.range,this.description=t.description,this.previous=t.previous),n&&n.length||!this.range||!this.description)this.tiers=n;else{const e=function(e){const t=[];return e.split("\n").forEach((e=>{const n=e.match(/(.+ Cash Back) (.*)/);n&&t.push({cashBack:n[1],description:n[2]})})),t}(this.description);e?.length&&(this.tiers=e,this.tiered=!0)}}}class oo extends(M()){stores=new Map;constructor(e=rs.DEFAULT){super(),this.channel=e}get platform(){return ws[this.channel]||self.EBATES.settings.get("platforms")?.[this.channel]}get name(){return`rates-${this.platform}`}async initialize(){this.channel===rs.DEFAULT&&(await this.load(),0===this.stores.size&&await this.fetch("all"))}async load(){if(0===this.stores.size){const e=await qi.get(this.name)||[];this.stores=new Map(e)}}async save(){await qi.set(this.name,[...this.stores])}get(e){if(0===this.stores.size)throw new Error("Missing Rewards");if(!this.stores.has(e))throw new Error(`Missing Reward (${this.channel}): ${e}`);const t={...this.stores.get(e)?.rate};return!Qi.get("wasCashBack",!0)&&t&&delete t.previous,!Qi.get("rakPlus",!0)&&t&&delete t.rakplusTargeted,t}async reset(){this.stores.forEach((({date:e,...t},n,r)=>{r.set(n,t)})),this.save()}async fetch(e){if(await this.load(),"all"===e){try{await this.request([e])}catch{}return}const t=[].concat(e),n=Date.now()-ro,r=t.find((e=>{const t=this.stores.get(e)?.date;return!t||t<n}));if(r)try{await this.request(t)}catch{}return Array.isArray(e)?t.map((e=>this.stores.get(e)?.rate)):this.stores.get(e)?.rate}async request(e){const t=await zi(ge(C),{data:{name:"button_reward_v1",variables:JSON.stringify({storeIds:e.map(String)})},headers:{"X-Platform":this.platform,Authorization:`ebtoken ${self.EBATES?.ebToken||""}`}}),n=Date.now();return t.data.stores.forEach((({id:e,tiered:t,reward:r,rakplusTargeted:i})=>{const s=new so({storeId:e,tiered:t,reward:r,rakplusTargeted:i});this.stores.set(e,{date:n,rate:s})})),this.save(),this.stores}}class ao extends Map{constructor(){super([[rs.DEFAULT,new co(rs.DEFAULT)],[rs.PRICE_MAGIC,new co(rs.PRICE_MAGIC)],[rs.SHOPSTYLE,new co(rs.SHOPSTYLE)]])}add(e){if(isNaN(e))throw new Error("Channel must be defined");this.has(e)||this.set(e,new co(e))}}class co extends(M()){name="tiers";stores=new Map;constructor(e=rs.DEFAULT){super(),this.channel=e}get platform(){return ws[this.channel]||self.EBATES.settings.get("platforms")?.[this.channel]}async save(){await qi.set(this.name,[...this.stores])}async fetch(e){0===this.stores.size&&(this.stores=new Map(await qi.get(this.name)||[]));const t=[].concat(e),n=Date.now()-ro,r=t.find((e=>{const t=this.stores.get(e)?.date;return!t||t<n}));if(r)try{await this.request(t)}catch{}return Array.isArray(e)?t.map((e=>this.stores.get(e)?.tiers)):this.stores.get(e)?.tiers}async request(e){const t=await zi(ge(C),{data:{name:"button_tiers_v1",variables:JSON.stringify({storeIds:e.map(String)})},headers:{"X-Platform":this.platform,Authorization:`ebtoken ${self.EBATES?.ebToken||""}`}}),n=Date.now();return t.data.stores.forEach((({storeId:e,tiers:t,reward:r})=>{const i=new so({storeId:e,reward:r,tiers:t});this.stores.set(e,{date:n,tiers:i.tiers})})),this.save(),this.stores}}class uo extends Zi{_id="store_modified_times";UPDATE_INTERVAL=9e5;get url(){return Wi(ge(C),{name:"store_modified_times",variables:'{"storeIds": "ALL"}'})}parse(e){return e?.data?.storeLastModifiedTime?.value??[]}async ifUpdateRequired(){try{return await this.verifyInternalCache(),!1}catch(e){return!0}}}function lo(e){if(!e)return{};let t="",n=0,r="";switch(e.display){case"Percentage":t="%";break;case"Fixed":t="$"}return e.amount&&(n=e.amount,r=e.range?"tiered":"flat"),{cash_back_type:t,cash_back:n,cash_back_structure:r}}function ho(e="",t="[&?](?:LinkshareID|wmlspartner|siteID|mkwid|pcrid|cmp|adid|sourceid|veh|tid|kwid|ap|gclid|cid|cjevent|cp|aid|sid|aff\\w*||\\w*email\\w*|ran\\w+)=[^&]*"){const[n]=e.split("?",1);return e.replace(new RegExp(t,"gi"),"").replace(/([&=])[^&=]+(?:@|%40)[\w.-]+\.\w{2,}/g,"$1").replace(`${n}&`,`${n}?`)}const fo=Hs.extend({dynamic:!1,initialize(){return this.on({error:function(e,t){[401,403].includes(t.status)&&EBATES.onTokenExpired()}}),Hs.prototype.initialize.apply(this)}}),go=$s.extend({store:null,defaults:{storeId:11095},initialize(){this.get("code")&&this.get("code").indexOf("&amp;")&&this.set({code:this.get("code").replace("&amp;","&")})},toJSON(...e){const t=EBATES.merchants.findWhere({storeId:this.get("storeId")});if(t&&t.get("shoppingURL")){const n=Hi(t.get("shoppingURL").replace("&store_url=%deepLinkUrl%",""),{special:this.id,tb:"yes",domainName:t.get("domainName"),sourceName:is,channel:rs.DEFAULT,toolbarFeatureId:"DDD",eeid:t.get("mpl")?As.MPL_STORE:"26141",mpl_id:t.get("mpl")});return{...$s.prototype.toJSON.apply(this,e),images:t.get("images"),storeName:t.get("storeName"),reward:t.getReward(),rewardsExpired:t.collection.rates.default.expired,shoppingURL:n}}return null}}),po=Hs.extend({dynamic:!1,model:go,initialize(e,t){return(0,I.extend)(this,t),Hs.prototype.initialize.apply(this)},comparator:e=>[e.has("code")?0:1,["Store Wide","Department","Free Gift","Free Shipping","Product",null].indexOf(e.get("scope")),e.get("scores")?e.get("scores").score1:0],parse:e=>(0,I.chain)(e.storeDeals).map((function(e){return(0,I.map)(e.deals,(function(t){return(0,I.extend)({storeId:e.storeId},t)}))})).flatten().value(),search(e){return(0,I.chain)(this.filter((function(t){return t.get("description").toLowerCase().indexOf(e)>=0}))).invoke("toJSON").value()}});class mo extends Zi{DEFAULT_UPDATE_INTERVAL=108e5;ERROR_UPDATE_INTERVAL=108e5;constructor(e){super(),this.storeId=e,this._id=`experimental-coupons-${e}`}get url(){return ge(k.STORE_COUPONS,{storeId:this.storeId})}parse(e){return e?.map((e=>(e.source="ACS",e)))}sort(e){return e.sort(((e,t)=>(t.orders_count??0)-(e.orders_count??0)))}async get(){const e=await this.load();return this.sort(e)}}class vo extends(M()){constructor(e){if(super(),!e)throw new Error("storageId required");this._storageId=e}save(e){if(ve)return qi.set(this._storageId,e)}clearCache(){if(ve)return qi.delete(this._storageId)}async load(){if(ve)return qi.get(this._storageId)}}class yo extends vo{constructor(e){super(`shopping-trip-${e}`),this.pending={},this.attributes={},this.load().then((e=>{e&&0!==Object.keys(e).length&&Object.assign(this.attributes,e)}))}get(e){return this.attributes[e]}set(e,t){"string"==typeof e&&void 0!==t?this.attributes[e]=t:Object.assign(this.attributes,e),this.save(this.attributes)}start(e={}){if(!e.ttn)throw new Error("Missing ttn");this.attributes={...e,...this.pending},this.pending={},this.emit("start",this),this.save(this.attributes)}reset(){this.attributes={},this.clearCache()}resetPendingAttributes(){this.pending={}}addPendingAttributes(e){this.pending={...e,...this.pending}}getCurrentState(){return{...this.pending,...this.attributes}}toJSON(){return this.attributes}}const bo={notificationHover:!0,notificationReminder:!0,notificationCheckout:!0,notificationConfirmation:!0,notificationCaa:!0,activated:!1,suppressed:!1,rab:!1,hoverShownCount:0,visit:null,backgroundActivated:!1};class wo extends vo{attributes={...bo};constructor(e){super(`merchant-session-${e}`),this.shoppingTrip=new yo(e),this.load().then((e=>{e&&0!==Object.keys(e).length&&Object.assign(this.attributes,e)}))}set(e,t){"string"==typeof e&&void 0!==t?this.attributes[e]=t:Object.assign(this.attributes,e),this.save(this.attributes)}get(e){return this.attributes[e]}has(e){return void 0!==this.attributes[e]}start({shoppingTrip:e,...t}){(this.shoppingTrip.get("partner")!==e.partner||this.get("suppressed"))&&this.stop(),this.set(t),e&&this.shoppingTrip.start(e),this.set("notificationHover",!0),this.set("notificationReminder",!1),this.set("activated",!0),this.emit("start",this)}suppress(){this.reset(),this.shoppingTrip.resetPendingAttributes(),this.set("notificationReminder",!1),this.set("suppressed",!0),this.emit("start",this)}stop(){this.reset(),this.emit("stop",this)}reset(){this.attributes={...bo},this.shoppingTrip.reset(),this.clearCache()}checkSessionTimeout(){const e=this.get("sessionInterval")||18e5,t=this.get("visit");t&&(t+e<Date.now()&&(this.stop(),this.shoppingTrip.resetPendingAttributes()),t+36e5<Date.now()&&this.set("notificationHover",!0));const n=this.get("rabSnoozeTimestamp");n&&Date.now()>n&&(delete this.attributes.rabSnoozeTimestamp,this.set("rab",!0))}toJSON(){return{...this.attributes,shoppingTrip:this.shoppingTrip.toJSON()}}}const Ao={platform:"Extension",browser:b.browser.name,extension_version:b.extension.version};const xo=new class extends Zi{_id="experiments";UPDATE_INTERVAL=72e5;memberGuid="";anonymousId="";constructor(){super(),this.get=this.variation,b.extension.attachEvent("experiments:getAll",(()=>this.toJSON())),b.extension.attachEvent("experiments:activate",(({data:{id:e,props:t}})=>this.activate(e,t))),b.extension.attachEvent("experiments:get",(({data:{id:e,defaultValue:t}})=>this.variation(e,t))),this.readCache()}get url(){return le.get("FEATUREFLAGS_EXPERIMENT_URL")}setMember({anonymousId:e,memberGuid:t}){this.memberGuid&&this.memberGuid!==t&&this.clearCache(),this.memberGuid=t,this.anonymousId=e}async fetchData(){const e={user:{member_guid:this.memberGuid,anonymous_id:this.anonymousId},context:Ao,region:le.region,event_properties:{application_type:"button"}},t=le.get("FEATUREFLAGS_EXPERIMENT_APIKEY");try{return await this.load({url:this.url,method:"POST",headers:{"api-key":t,"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(e){return this.getData()??{}}}async getFlag(e){if(e){return(await this.fetchData())[e]}return null}async inExperiment(e){const t=await this.getFlag(e);return!!t?.in_experiment}async variation(e,t=!1){const n=await this.getFlag(e);return n?.value??t}getId(){return this.memberGuid??this.anonymousId??""}async activate(e,t={}){const n=await this.getFlag(e);return n&&(n.in_experiment||"IE-Test-Expedia"===e&&["A","X"].includes(n.value))&&(self.EBATES.member.identify(),self.EBATES.segment.track("View Experiment",{experiment_name:e,variation_name:`${e}${n.value}`,activation_id:this.getId(),activation_id_type:this.memberGuid?"guid":"anonymous",...t})),n?.value}async toJSON(){const e=await this.fetchData(),t={};return Object.keys(e).forEach((n=>t[n]=e[n].value)),t}},Eo=$s.extend({idAttribute:"storeId",deals:null,experimentalCoupons:null,session:null,defaults:{activationCode:0},isButtonMerchant(){return[3,5].includes(this.get("activationCode"))},isActiveMerchant(e){try{return(e=e||this.getReward())&&["Percentage","Fixed"].includes(e.display)&&e.amount>0}catch(e){}return!1},isRabDisabled(){const e=Qi.get("rabDisabledMerchants",{storeIds:[]}),t=this.get("storeId")??-1;return Array.isArray(e.storeIds)&&e.storeIds.includes(t)},isActiveButtonMerchant(){return this.isButtonMerchant()&&this.isActiveMerchant()},async isEligibleForIconAnimation(){const e="X"===await this.incrementalityTest();return!this.session.get("suppressed")&&!e&&(this.isActiveButtonMerchant()||6===this.get("activationCode")&&this.session.get("activated"))},processCode(e){const t=this.get("activationCode"),n=this.isActiveMerchant(e),r=this.isButtonMerchant(),i=r&&n,s=this.isRabDisabled();return{settings_notification:Qi.get("hover",!0)&&3===t&&n||2===t,settings_rab:Qi.get("hoverRAB")&&!s&&n&&3===t,settings_confirmation:i||6===t,settings_checkout:3===t&&i,settings_serp:3===t&&n&&!0!==this.get("serpDisabled"),settings_popup:i,settings_caa:r,settings_purchase:r,offers_cb:n}},initialize(){const e=this.get("storeId");return this.session=new wo(e),this.has("storeId")&&(this.deals=new po([],{key:`deals/${this.get("storeId")}`,url:ge(k.STORE_DEALS,{storeId:e})}),this.experimentalCoupons=new mo(e)),this.session.shoppingTrip.on("start",(e=>{e.get("source")&&(self.EBATES.segment.track("Start Shopping Trip",{version:"Remind me Later",store_name:this.get("storeName"),store_id:this.get("storeId"),tracking_ticket:e.get("ttn"),attribution_source_previous_click:e.get("source"),interstitial_type:e.get("interstitialType"),entity_name:e.get("entity_name"),rank:e.get("rank"),activation_type:e.get("type"),serp_rank:e.get("serp_rank"),type:e.get("featureType"),referring_domain:e.get("referring_domain"),search_term:e.get("search_term"),...e.get("event_attributes"),...lo(e.get("reward"))}),self.EBATES.holistic.track({event:es.ShoppingTripStarted,data:{tracking_ticket:e.get("ttn"),store:{id:this.get("storeId"),name:this.get("storeName")},trip_surface:"WEB"}}))})),this.session.on("start",(()=>{this.session.checkSessionTimeout(),this.visit(),b.extension.fireEvent("merchant.state:change"),this.updateMerchantForCurrentTab()})),this.session.on("stop",(()=>{if(this.isActiveMerchant()){const e=this.collection.recent.get(this.get("storeId"));e&&e.set({reward:this.getReward(),lastVisit:Date.now()},{merge:!0})}b.extension.fireEvent("merchant.state:change"),this.updateMerchantForCurrentTab()})),$s.prototype.initialize.call(this)},toJSON(e={},...t){const n=this.getReward(e.channel),r=this.session.toJSON(),i={...$s.prototype.toJSON.apply(this,[e,...t]),...this.processCode(n),reward:n};if(!i.siteUrl){const e=this.get("shoppingURL")?.match(/.*\/(.*?)_\d+/);i.siteUrl=e?e[1]:this.get("domainName")}i.hoverMessageTrheshold&&i.reward&&eo(i.reward,{amount:i.hoverMessageTrheshold,display:i.reward.display})>=0&&delete i.hoverMessage;const s=EBATES.merchants.recent.get(this.get("storeId"));return s&&(i.recent=s.toJSON()),{...i,...r,rewardsExpired:this.collection.rates.default.expired,loggedIn:EBATES.loggedIn,travelStore:EBATES.settings.get("travelStores").includes(this.get("storeId"))}},showTakeover(e){if(e&&this.isActiveMerchant()&&Qi.variation("takeover",!0)){const t=this.toJSON();b.extension.fireEvent("takeover",{tabId:e,data:{merchant:t}})}},visit(){const e=Date.now();this.session.set("visit",e)},suppress(){const e=this.session.get("tabId");this.session.suppress(),this.showTakeover(e),this.session.checkSessionTimeout()},getReward(e=rs.DEFAULT){return this.isButtonMerchant()?this.collection.rates.get(e).get(this.id):{amount:0}},getTiers(e=rs.DEFAULT){return"ShopStyle"===this.session.shoppingTrip.get("partner")?e=rs.SHOPSTYLE:this.session.shoppingTrip.get("channel")&&this.collection.tiers.get(this.session.shoppingTrip.get("channel"))&&(e=this.session.shoppingTrip.get("channel")),this.collection.tiers.get(e).fetch(this.id)},getCashBackAmount(e=rs.DEFAULT){return Qs(this.getReward(e))},async activateInBackground(e,t="json"){const r=this.session;let i=e;const s=await b.browser.navigate({tabId:b.browser.NEWTAB,active:!1,pinned:!0}),o=s.id;if("xfas"!==t){const t=await fetch(`${e}&response=json`).catch((e=>{throw e})),n=(await t.json()).ticket[0];if(n?.storeId){i=Hi(n.link[0]["@href"],{visit_id:EBATES.visitId});const t=n.trackingNumber;EBATES.settings.affiliates.match(e,o),EBATES.settings.affiliates.activations.addParameters(o,{trackingTicketNumber:t})}}const a=setTimeout((()=>{r.set("backgroundActivated",!1),r.set("backgroundActivationDisabled",!0),this.updateMerchantForCurrentTab(),self.EBATES.segment.track("Interstitial Failure",{type:"Background Activation Failed",reason:"timed out",store_id:this.get("storeId"),store_name:this.get("storeName"),activation_type:"xfas"!==t?"json":"xfas"})}),3e4);await b.browser.navigate({tabId:o,url:i});const c=this.get("activationInterval")||EBATES.settings.get("activationInterval");let u;r.shoppingTrip.once("start",(()=>{clearTimeout(a),u=setTimeout((()=>{b.browser.isSafari?b.extension.fireEvent("closeWindow",{tabId:o}):n().tabs.remove(o),b.browser.detachEvent(b.browser.TABCHANGED,l)}),Number.isInteger(c)?c:5e3)}));const l=({tabId:e})=>{e===s.id&&(b.browser.detachEvent(b.browser.TABCHANGED,l),clearTimeout(u))};b.browser.attachEvent(b.browser.TABCHANGED,l)},isEligibleForIgnoredStandDown(){const e=EBATES.settings.promos.get("standdown-config");return!!(e?.get("active")&&e.campaigns&&e.campaigns.find((e=>e.stores.get(this.id))))},isEligibleForBackgroundActivation(){if(this.session.get("backgroundActivationDisabled"))return!1;if(this.get("mpl"))return!0;const e=EBATES.settings.promos.get("background-activation");if(e?.get("active")&&e.campaigns){const t=e.campaigns.find((e=>e.stores.get(this.id)));if(t?.get("test"))return!1}return!1},async incrementalityTest(){if(!b.browser.isChrome)return!1;const e=Qi.get("incrementalityTestMerchantsList",{storeIds:[]}),t=this.get("storeId");if(!e.storeIds.includes(t))return!1;return await xo.variation("IE-Test-Expedia")},async getRecommendedStores(){const e=EBATES.settings.promos.findWhere({type:"recommended",active:!0,storeId:this.get("storeId")});if(e){const t=e.id,n=e.get("flagId"),r=e.get("flagValue"),i=Qi.get("recommended");if((!i||Object.prototype.hasOwnProperty.call(i,t)&&i[t])&&(!n||!r||await xo.variation(n)===r))return e.toJSON()}return null},async isEligibleForBackgroundActivationV2(e){if(!Qi.get("bgActivation",!1)||2===this.get("activationCode")||this.session.get("backgroundActivationDisabled"))return"";const t=Qi.get("bgActivationBlacklist",{storeIds:[]}),n=this.get("storeId");if(t.storeIds.includes(n))return"";const r=e?await xo.activate(Ds,{storeId:n}):await xo.variation(Ds);return"A"===r?"json":"B"===r?"xfas":""},async isCaaWithoutActivation(){const e=Qi.variation("caaWithoutActivation",{includedDomains:[]}).includedDomains.includes(this.get("domainName")),t=await xo.inExperiment("BTN220");return e&&t},activate(e){let{sessionAttributes:t,forceBackgroundActivation:n,xfasParams:r,product_url:i,toolbarFeatureId:s,special:o,tabId:a,channel:c=rs.DEFAULT,rabActivation:u,backgroundActivation:l,type:d}=e;const h=this.session;h.get("backgroundActivationDisabled")&&(l=""),t&&h.shoppingTrip.addPendingAttributes(t),h.shoppingTrip.addPendingAttributes({featureType:d,channel:c});let f=ho(e.store_url,EBATES.settings.get("sanitization"));8381===this.id&&(f=ho(f,"SourceCode=[^&]+&?"));const g=this.get("mpl")?As.MPL_STORE:e.eeid,p=this.toJSON();return(e=>{const d=e;e=`${e.replace("&store_url=%deepLinkUrl%","")}&channel=${c}&tb_v=${b.extension.version}`,this.get("mpl")&&(e+=`&mpl_id=${this.get("mpl")}`),o&&(e+=`&special=${o}`),s&&(e+=`&toolbarFeatureId=${s}`);const m=()=>{let t="xfas",n="";if(i?(e=`${e}&product_url=${encodeURIComponent(i)}`,t="product"):e.indexOf("store_url")<0&&f&&this.get("affiliatizerEnabled")&&(e=`${e}&store_url=${encodeURIComponent(f)}`,t="affiliatizer",n=f),h.shoppingTrip.addPendingAttributes({type:t,startURL:n}),p?.tlqsf){const t=p.tlqsf[g]??p.tlqsf["*"];t&&(e=Wi(e,{tlqsf:btoa(t)}))}r&&(e=Wi(e,r)),e.length>=2048&&(e=d),b.browser.navigate({url:e,tabId:a})};if(a&&a!==b.browser.NEWTAB&&f&&(!p.offers_cb&&2!==this.get("activationCode")||p.nonTrackingPattern&&f.search(p.nonTrackingPattern)>=0||this.isEligibleForBackgroundActivation()||n||u||l)){if(n){h.set("activated",!0);const e=this.getReward(c);h.shoppingTrip.addPendingAttributes({reward:e}),h.shoppingTrip.set("reward",e)}this.activateInBackground(e,l).then((()=>{const e="xfas"!==l?"background":"background_xfas";h.shoppingTrip.addPendingAttributes({type:e}),h.set("backgroundActivated",!0),this.updateMerchantForCurrentTab(),"Coupons and Cash Back Available Notification - combo CTA"!==t.source?!["Cart Reminder",Ps,Is].includes(t.source??"")||l?this.updateMerchantForCurrentTab():h.set("notificationHover",!0):h.set("notificationHover",!1)})).catch((()=>{m()}))}else m();return e})((()=>{const e={tb:"yes",sourceName:is,eeid:g||23509,visit_id:EBATES.visitId};switch(parseInt(this.get("activationCode"),10)){case 2:if(this.has("storeLandingURL"))return Wi(p.storeLandingURL,e);case 5:if(this.has("storeLandingURL"))return Wi(p.storeLandingURL,{tb:"yes",visit_id:EBATES.visitId});default:return Wi(p.shoppingURL||ge(k.BASE),{...e,ebtoken:EBATES?.ebToken??""})}})())},async updateMerchantForCurrentTab(){await self.EBATES.merchants.updateMerchantRates(this.id);const e=this.session.toJSON(),t=this.getReward();e.shoppingTrip.reward||(e.shoppingTrip.reward=t);(await n().tabs.query({active:!0})).forEach((n=>{b.extension.fireEvent("updateMerchant",{tabId:n.id,data:{merchant:{...e,reward:t,storeId:this.get("storeId")}}})}))},activateSession(e){let{reward:t,trackingTicketNumber:n,partner:r,interstitialType:i,sessionInterval:s,url:o}=e;const a=this.session,c={partner:r,interstitialType:i,ttn:n||a.shoppingTrip.get("ttn"),source:o?.includes("sourceName=toolbar")?o.match(/[?&]special=([\w-]+)/)?.pop()??"unknown":void 0},u=this.getReward();if(t&&(t.amount||t.range)){const e=eo(u,t);c.reward=t,s&&e>0&&(s=void 0)}else c.reward=u;try{a.start({sessionInterval:s,shoppingTrip:c})}catch(e){const t=a.shoppingTrip.getCurrentState();let n="";"string"==typeof e?n=e:e instanceof Error&&(n=e.message),$i.logger.warn(n,{merchant_id:this.get("storeId"),activation_type:t.type,attribution_source_previous_click:t.source,tracking_ticket:t.ttn})}},getStoreContent(){return(this.storeContent?this.storeContent:new So(this.id)).load()},checkAffiliatizer(e){if("affiliatizer"===this.session.shoppingTrip.get("type")){let t,n,r,i;try{t=new URL(this.session.shoppingTrip.get("startURL")),n=new URL(e),r=t.hostname+t.pathname.replace(/\/+$/,"").toLowerCase(),i=n.hostname+n.pathname.replace(/\/+$/,"").toLowerCase()}catch(e){return}if(t&&n&&r!==i){const e={reason:"url_mismatch",starting_url:r,final_url:i,merchant_id:this.get("storeId")};$i.logger.warn("AffiliatizerStatus",e)}}},processDocumentComplete({url:e,tabId:t}){const n=EBATES.session_competition?.domain,r=EBATES.settings.affiliates.state(t);if(r.activation||r.suppress){if(r.activation)EBATES.loggedIn&&(this.activateSession(r.activation),this.checkAffiliatizer(e));else if(r.suppress){EBATES.session_competition&&(self.EBATES.segment.track("Start Competitor Shopping Trip",{url:e,domain:n}),EBATES.session_competition=null);const t=n&&EBATES.settings.get("standDownDomains").includes(n);if(Qi.variation("standDownByMerchant",!1)&&!t&&this.isEligibleForIgnoredStandDown()){const e=this.session.get("activated")?this.session.get("tabId"):null;this.session.stop(),e&&this.showTakeover(e)}else self.EBATES.segment.track("Stand Down",{store_id:this.get("storeId"),tracking_ticket:this.session.shoppingTrip.get("ttn"),url:r.suppress.url,competitor:n,paidLink:r.suppress.paidLink}),this.session.set({competitor:n}),this.suppress()}EBATES.settings.affiliates.clear(t)}this.session.get("activated")&&t&&this.session.set("tabId",t),n&&EBATES.settings.priceMagic.get("partnerDomains").includes(n)&&(this.session.set("pmDisabled",!0),EBATES.session_competition=null),this.visit()}});class So extends Zi{UPDATE_INTERVAL=108e5;get _id(){return`stores/content/${this.storeId}`}constructor(e){super(),this.storeId=e}get url(){return ge(k.STORE_CONTENT,{storeId:this.storeId})}parse(e){return e?.storeContent?.length?e.storeContent[0]:{}}}function To(e){return Array.isArray?Array.isArray(e):"[object Array]"===Do(e)}function _o(e){return"string"==typeof e}function ko(e){return"number"==typeof e}function Co(e){return!0===e||!1===e||function(e){return Io(e)&&null!==e}(e)&&"[object Boolean]"==Do(e)}function Io(e){return"object"==typeof e}function Po(e){return null!=e}function Mo(e){return!e.trim().length}function Do(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const Ro=Object.prototype.hasOwnProperty;class Lo{constructor(e){this._keys=[],this._keyMap={};let t=0;e.forEach((e=>{let n=Oo(e);this._keys.push(n),this._keyMap[n.id]=n,t+=n.weight})),this._keys.forEach((e=>{e.weight/=t}))}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function Oo(e){let t=null,n=null,r=null,i=1,s=null;if(_o(e)||To(e))r=e,t=Bo(e),n=No(e);else{if(!Ro.call(e,"name"))throw new Error((e=>`Missing ${e} property in key`)("name"));const o=e.name;if(r=o,Ro.call(e,"weight")&&(i=e.weight,i<=0))throw new Error((e=>`Property 'weight' in key '${e}' must be a positive integer`)(o));t=Bo(o),n=No(o),s=e.getFn}return{path:t,id:n,weight:i,src:r,getFn:s}}function Bo(e){return To(e)?e:e.split(".")}function No(e){return To(e)?e.join("."):e}const jo={useExtendedSearch:!1,getFn:function(e,t){let n=[],r=!1;const i=(e,t,s)=>{if(Po(e))if(t[s]){const o=e[t[s]];if(!Po(o))return;if(s===t.length-1&&(_o(o)||ko(o)||Co(o)))n.push(function(e){return null==e?"":function(e){if("string"==typeof e)return e;let t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(e)}(o));else if(To(o)){r=!0;for(let e=0,n=o.length;e<n;e+=1)i(o[e],t,s+1)}else t.length&&i(o,t,s+1)}else n.push(e)};return i(e,_o(t)?t.split("."):t,0),r?n:n[0]},ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var Uo={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,t)=>e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1,includeMatches:!1,findAllMatches:!1,minMatchCharLength:1,location:0,threshold:.6,distance:100,...jo};const Fo=/[^ ]+/g;class $o{constructor({getFn:e=Uo.getFn,fieldNormWeight:t=Uo.fieldNormWeight}={}){this.norm=function(e=1,t=3){const n=new Map,r=Math.pow(10,t);return{get(t){const i=t.match(Fo).length;if(n.has(i))return n.get(i);const s=1/Math.pow(i,.5*e),o=parseFloat(Math.round(s*r)/r);return n.set(i,o),o},clear(){n.clear()}}}(t,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach(((e,t)=>{this._keysMap[e.id]=t}))}create(){!this.isCreated&&this.docs.length&&(this.isCreated=!0,_o(this.docs[0])?this.docs.forEach(((e,t)=>{this._addString(e,t)})):this.docs.forEach(((e,t)=>{this._addObject(e,t)})),this.norm.clear())}add(e){const t=this.size();_o(e)?this._addString(e,t):this._addObject(e,t)}removeAt(e){this.records.splice(e,1);for(let t=e,n=this.size();t<n;t+=1)this.records[t].i-=1}getValueForItemAtKeyId(e,t){return e[this._keysMap[t]]}size(){return this.records.length}_addString(e,t){if(!Po(e)||Mo(e))return;let n={v:e,i:t,n:this.norm.get(e)};this.records.push(n)}_addObject(e,t){let n={i:t,$:{}};this.keys.forEach(((t,r)=>{let i=t.getFn?t.getFn(e):this.getFn(e,t.path);if(Po(i))if(To(i)){let e=[];const t=[{nestedArrIndex:-1,value:i}];for(;t.length;){const{nestedArrIndex:n,value:r}=t.pop();if(Po(r))if(_o(r)&&!Mo(r)){let t={v:r,i:n,n:this.norm.get(r)};e.push(t)}else To(r)&&r.forEach(((e,n)=>{t.push({nestedArrIndex:n,value:e})}))}n.$[r]=e}else if(_o(i)&&!Mo(i)){let e={v:i,n:this.norm.get(i)};n.$[r]=e}})),this.records.push(n)}toJSON(){return{keys:this.keys,records:this.records}}}function qo(e,t,{getFn:n=Uo.getFn,fieldNormWeight:r=Uo.fieldNormWeight}={}){const i=new $o({getFn:n,fieldNormWeight:r});return i.setKeys(e.map(Oo)),i.setSources(t),i.create(),i}function Ho(e,{errors:t=0,currentLocation:n=0,expectedLocation:r=0,distance:i=Uo.distance,ignoreLocation:s=Uo.ignoreLocation}={}){const o=t/e.length;if(s)return o;const a=Math.abs(r-n);return i?o+a/i:a?1:o}const Wo=32;function Go(e,t,n,{location:r=Uo.location,distance:i=Uo.distance,threshold:s=Uo.threshold,findAllMatches:o=Uo.findAllMatches,minMatchCharLength:a=Uo.minMatchCharLength,includeMatches:c=Uo.includeMatches,ignoreLocation:u=Uo.ignoreLocation}={}){if(t.length>Wo)throw new Error(`Pattern length exceeds max of ${Wo}.`);const l=t.length,d=e.length,h=Math.max(0,Math.min(r,d));let f=s,g=h;const p=a>1||c,m=p?Array(d):[];let v;for(;(v=e.indexOf(t,g))>-1;){let e=Ho(t,{currentLocation:v,expectedLocation:h,distance:i,ignoreLocation:u});if(f=Math.min(e,f),g=v+l,p){let e=0;for(;e<l;)m[v+e]=1,e+=1}}g=-1;let y=[],b=1,w=l+d;const A=1<<l-1;for(let r=0;r<l;r+=1){let s=0,a=w;for(;s<a;){Ho(t,{errors:r,currentLocation:h+a,expectedLocation:h,distance:i,ignoreLocation:u})<=f?s=a:w=a,a=Math.floor((w-s)/2+s)}w=a;let c=Math.max(1,h-a+1),v=o?d:Math.min(h+a,d)+l,x=Array(v+2);x[v+1]=(1<<r)-1;for(let s=v;s>=c;s-=1){let o=s-1,a=n[e.charAt(o)];if(p&&(m[o]=+!!a),x[s]=(x[s+1]<<1|1)&a,r&&(x[s]|=(y[s+1]|y[s])<<1|1|y[s+1]),x[s]&A&&(b=Ho(t,{errors:r,currentLocation:o,expectedLocation:h,distance:i,ignoreLocation:u}),b<=f)){if(f=b,g=o,g<=h)break;c=Math.max(1,2*h-g)}}if(Ho(t,{errors:r+1,currentLocation:h,expectedLocation:h,distance:i,ignoreLocation:u})>f)break;y=x}const x={isMatch:g>=0,score:Math.max(.001,b)};if(p){const e=function(e=[],t=Uo.minMatchCharLength){let n=[],r=-1,i=-1,s=0;for(let o=e.length;s<o;s+=1){let o=e[s];o&&-1===r?r=s:o||-1===r||(i=s-1,i-r+1>=t&&n.push([r,i]),r=-1)}return e[s-1]&&s-r>=t&&n.push([r,s-1]),n}(m,a);e.length?c&&(x.indices=e):x.isMatch=!1}return x}function Vo(e){let t={};for(let n=0,r=e.length;n<r;n+=1){const i=e.charAt(n);t[i]=(t[i]||0)|1<<r-n-1}return t}class zo{constructor(e,{location:t=Uo.location,threshold:n=Uo.threshold,distance:r=Uo.distance,includeMatches:i=Uo.includeMatches,findAllMatches:s=Uo.findAllMatches,minMatchCharLength:o=Uo.minMatchCharLength,isCaseSensitive:a=Uo.isCaseSensitive,ignoreLocation:c=Uo.ignoreLocation}={}){if(this.options={location:t,threshold:n,distance:r,includeMatches:i,findAllMatches:s,minMatchCharLength:o,isCaseSensitive:a,ignoreLocation:c},this.pattern=a?e:e.toLowerCase(),this.chunks=[],!this.pattern.length)return;const u=(e,t)=>{this.chunks.push({pattern:e,alphabet:Vo(e),startIndex:t})},l=this.pattern.length;if(l>Wo){let e=0;const t=l%Wo,n=l-t;for(;e<n;)u(this.pattern.substr(e,Wo),e),e+=Wo;if(t){const e=l-Wo;u(this.pattern.substr(e),e)}}else u(this.pattern,0)}searchIn(e){const{isCaseSensitive:t,includeMatches:n}=this.options;if(t||(e=e.toLowerCase()),this.pattern===e){let t={isMatch:!0,score:0};return n&&(t.indices=[[0,e.length-1]]),t}const{location:r,distance:i,threshold:s,findAllMatches:o,minMatchCharLength:a,ignoreLocation:c}=this.options;let u=[],l=0,d=!1;this.chunks.forEach((({pattern:t,alphabet:h,startIndex:f})=>{const{isMatch:g,score:p,indices:m}=Go(e,t,h,{location:r+f,distance:i,threshold:s,findAllMatches:o,minMatchCharLength:a,includeMatches:n,ignoreLocation:c});g&&(d=!0),l+=p,g&&m&&(u=[...u,...m])}));let h={isMatch:d,score:d?l/this.chunks.length:1};return d&&n&&(h.indices=u),h}}class Jo{constructor(e){this.pattern=e}static isMultiMatch(e){return Ko(e,this.multiRegex)}static isSingleMatch(e){return Ko(e,this.singleRegex)}search(){}}function Ko(e,t){const n=e.match(t);return n?n[1]:null}class Yo extends Jo{constructor(e,{location:t=Uo.location,threshold:n=Uo.threshold,distance:r=Uo.distance,includeMatches:i=Uo.includeMatches,findAllMatches:s=Uo.findAllMatches,minMatchCharLength:o=Uo.minMatchCharLength,isCaseSensitive:a=Uo.isCaseSensitive,ignoreLocation:c=Uo.ignoreLocation}={}){super(e),this._bitapSearch=new zo(e,{location:t,threshold:n,distance:r,includeMatches:i,findAllMatches:s,minMatchCharLength:o,isCaseSensitive:a,ignoreLocation:c})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class Xo extends Jo{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let t,n=0;const r=[],i=this.pattern.length;for(;(t=e.indexOf(this.pattern,n))>-1;)n=t+i,r.push([t,n-1]);const s=!!r.length;return{isMatch:s,score:s?0:1,indices:r}}}const Zo=[class extends Jo{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const t=e===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}},Xo,class extends Jo{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const t=e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}},class extends Jo{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const t=!e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}},class extends Jo{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const t=!e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}},class extends Jo{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const t=e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[e.length-this.pattern.length,e.length-1]}}},class extends Jo{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const t=-1===e.indexOf(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}},Yo],Qo=Zo.length,ea=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/;const ta=new Set([Yo.type,Xo.type]);class na{constructor(e,{isCaseSensitive:t=Uo.isCaseSensitive,includeMatches:n=Uo.includeMatches,minMatchCharLength:r=Uo.minMatchCharLength,ignoreLocation:i=Uo.ignoreLocation,findAllMatches:s=Uo.findAllMatches,location:o=Uo.location,threshold:a=Uo.threshold,distance:c=Uo.distance}={}){this.query=null,this.options={isCaseSensitive:t,includeMatches:n,minMatchCharLength:r,findAllMatches:s,ignoreLocation:i,location:o,threshold:a,distance:c},this.pattern=t?e:e.toLowerCase(),this.query=function(e,t={}){return e.split("|").map((e=>{let n=e.trim().split(ea).filter((e=>e&&!!e.trim())),r=[];for(let e=0,i=n.length;e<i;e+=1){const i=n[e];let s=!1,o=-1;for(;!s&&++o<Qo;){const e=Zo[o];let n=e.isMultiMatch(i);n&&(r.push(new e(n,t)),s=!0)}if(!s)for(o=-1;++o<Qo;){const e=Zo[o];let n=e.isSingleMatch(i);if(n){r.push(new e(n,t));break}}}return r}))}(this.pattern,this.options)}static condition(e,t){return t.useExtendedSearch}searchIn(e){const t=this.query;if(!t)return{isMatch:!1,score:1};const{includeMatches:n,isCaseSensitive:r}=this.options;e=r?e:e.toLowerCase();let i=0,s=[],o=0;for(let r=0,a=t.length;r<a;r+=1){const a=t[r];s.length=0,i=0;for(let t=0,r=a.length;t<r;t+=1){const r=a[t],{isMatch:c,indices:u,score:l}=r.search(e);if(!c){o=0,i=0,s.length=0;break}if(i+=1,o+=l,n){const e=r.constructor.type;ta.has(e)?s=[...s,...u]:s.push(u)}}if(i){let e={isMatch:!0,score:o/i};return n&&(e.indices=s),e}}return{isMatch:!1,score:1}}}const ra=[];function ia(e,t){for(let n=0,r=ra.length;n<r;n+=1){let r=ra[n];if(r.condition(e,t))return new r(e,t)}return new zo(e,t)}const sa="$and",oa="$or",aa="$path",ca="$val",ua=e=>!(!e[sa]&&!e[oa]),la=e=>({[sa]:Object.keys(e).map((t=>({[t]:e[t]})))});function da(e,t,{auto:n=!0}={}){const r=e=>{let i=Object.keys(e);const s=(e=>!!e[aa])(e);if(!s&&i.length>1&&!ua(e))return r(la(e));if((e=>!To(e)&&Io(e)&&!ua(e))(e)){const r=s?e[aa]:i[0],o=s?e[ca]:e[r];if(!_o(o))throw new Error((e=>`Invalid value for key ${e}`)(r));const a={keyId:No(r),pattern:o};return n&&(a.searcher=ia(o,t)),a}let o={children:[],operator:i[0]};return i.forEach((t=>{const n=e[t];To(n)&&n.forEach((e=>{o.children.push(r(e))}))})),o};return ua(e)||(e=la(e)),r(e)}function ha(e,t){const n=e.matches;t.matches=[],Po(n)&&n.forEach((e=>{if(!Po(e.indices)||!e.indices.length)return;const{indices:n,value:r}=e;let i={indices:n,value:r};e.key&&(i.key=e.key.src),e.idx>-1&&(i.refIndex=e.idx),t.matches.push(i)}))}function fa(e,t){t.score=e.score}class ga{constructor(e,t={},n){this.options={...Uo,...t},this.options.useExtendedSearch,this._keyStore=new Lo(this.options.keys),this.setCollection(e,n)}setCollection(e,t){if(this._docs=e,t&&!(t instanceof $o))throw new Error("Incorrect 'index' type");this._myIndex=t||qo(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){Po(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const t=[];for(let n=0,r=this._docs.length;n<r;n+=1){const i=this._docs[n];e(i,n)&&(this.removeAt(n),n-=1,r-=1,t.push(i))}return t}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:t=-1}={}){const{includeMatches:n,includeScore:r,shouldSort:i,sortFn:s,ignoreFieldNorm:o}=this.options;let a=_o(e)?_o(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return function(e,{ignoreFieldNorm:t=Uo.ignoreFieldNorm}){e.forEach((e=>{let n=1;e.matches.forEach((({key:e,norm:r,score:i})=>{const s=e?e.weight:null;n*=Math.pow(0===i&&s?Number.EPSILON:i,(s||1)*(t?1:r))})),e.score=n}))}(a,{ignoreFieldNorm:o}),i&&a.sort(s),ko(t)&&t>-1&&(a=a.slice(0,t)),function(e,t,{includeMatches:n=Uo.includeMatches,includeScore:r=Uo.includeScore}={}){const i=[];return n&&i.push(ha),r&&i.push(fa),e.map((e=>{const{idx:n}=e,r={item:t[n],refIndex:n};return i.length&&i.forEach((t=>{t(e,r)})),r}))}(a,this._docs,{includeMatches:n,includeScore:r})}_searchStringList(e){const t=ia(e,this.options),{records:n}=this._myIndex,r=[];return n.forEach((({v:e,i:n,n:i})=>{if(!Po(e))return;const{isMatch:s,score:o,indices:a}=t.searchIn(e);s&&r.push({item:e,idx:n,matches:[{score:o,value:e,norm:i,indices:a}]})})),r}_searchLogical(e){const t=da(e,this.options),n=(e,t,r)=>{if(!e.children){const{keyId:n,searcher:i}=e,s=this._findMatches({key:this._keyStore.get(n),value:this._myIndex.getValueForItemAtKeyId(t,n),searcher:i});return s&&s.length?[{idx:r,item:t,matches:s}]:[]}const i=[];for(let s=0,o=e.children.length;s<o;s+=1){const o=e.children[s],a=n(o,t,r);if(a.length)i.push(...a);else if(e.operator===sa)return[]}return i},r=this._myIndex.records,i={},s=[];return r.forEach((({$:e,i:r})=>{if(Po(e)){let o=n(t,e,r);o.length&&(i[r]||(i[r]={idx:r,item:e,matches:[]},s.push(i[r])),o.forEach((({matches:e})=>{i[r].matches.push(...e)})))}})),s}_searchObjectList(e){const t=ia(e,this.options),{keys:n,records:r}=this._myIndex,i=[];return r.forEach((({$:e,i:r})=>{if(!Po(e))return;let s=[];n.forEach(((n,r)=>{s.push(...this._findMatches({key:n,value:e[r],searcher:t}))})),s.length&&i.push({idx:r,item:e,matches:s})})),i}_findMatches({key:e,value:t,searcher:n}){if(!Po(t))return[];let r=[];if(To(t))t.forEach((({v:t,i,n:s})=>{if(!Po(t))return;const{isMatch:o,score:a,indices:c}=n.searchIn(t);o&&r.push({score:a,key:e,value:t,idx:i,norm:s,indices:c})}));else{const{v:i,n:s}=t,{isMatch:o,score:a,indices:c}=n.searchIn(i);o&&r.push({score:a,key:e,value:i,norm:s,indices:c})}return r}}function pa(e){return"string"==typeof e?{url:e}:{url:e?.url,bgColor:e?.backgroundColor}}ga.version="7.0.0",ga.createIndex=qo,ga.parseIndex=function(e,{getFn:t=Uo.getFn,fieldNormWeight:n=Uo.fieldNormWeight}={}){const{keys:r,records:i}=e,s=new $o({getFn:t,fieldNormWeight:n});return s.setKeys(r),s.setIndexRecords(i),s},ga.config=Uo,ga.parseQuery=da,function(...e){ra.push(...e)}(na);const ma=$s.extend({idAttribute:"matchPattern",initialize(){this.set({topDomain:we(this.get("domainName"))});const e=this.get("matchPattern");if(e&&".*.*"!==e)try{this.match=new RegExp(this.get("matchPattern"),"i")}catch({message:t}){this.match=null,$i.logger.error("RegExpError",{message:t,domainName:this.get("domainName"),matchPattern:e,now:Date.now(),source:"Domains.parse"})}}}),va=Us.Collection.extend({model:ma}),ya=Hs.extend({url:()=>{if(!Qi.variation("feedGenMerchants",!0))return ge(k.STORES)},model:Eo,key:"merchants",initialize(...e){return this.rates=new io,this.tiers=new ao,this.recent=new no,this.customMerchants=new Ys,this.domains=new va,this.lastModifiedTimes=new uo,this.on({remove(e){this.recent.get(e.get("storeId"))&&this.recent.remove(e.get("storeId"))},async sync(){if(Qi.variation("customMerchants",!1)){const e=await this.customMerchants.load();this.add(e,{merge:!0});const t=e.filter((({domainName:e,matchPattern:t})=>e&&t)).map((({domainName:e,matchPattern:t,storeId:n})=>({domainName:e,matchPattern:t,storeId:n})));this.domains.add(t,{merge:!0})}}}),b.browser.isSafari&&this.recent.fetch(),this.once("sync",(async()=>{await this.recent.fetch()})),b.extension.attachEvent("getMerchant",(async({url:e,tabId:t})=>await this.getMerchant({url:e,tabId:t}))),b.extension.attachEvent("activate",(async({tabId:e,data:t})=>{const n=this.get(t.storeId),r=await Ks.getActive();if(n){try{const e=new URL(r.url);t.sessionAttributes=t.sessionAttributes??{},t.sessionAttributes.event_attributes={attribution_source_previous_click_url:e.host+e.pathname,attribution_source_previous_click_domain:e.host,...t.sessionAttributes.event_attributes}}catch{}if(n.session.checkSessionTimeout(),n.activate({tabId:e||r.tabId,...t}),!t.sessionAttributes?.source)throw new Error(`Missing Activation Source: ${JSON.stringify(t)}`)}})),b.extension.attachEvent("getStoreContent",(async({data:e})=>{const t=this.get(e.storeId);if(t?.isActiveButtonMerchant())try{return await t.getStoreContent()}catch{}return null})),b.extension.attachEvent("getTiers",(async({data:e})=>{const t=this.get(e.storeId);return await(t?.getTiers())})),b.extension.attachEvent("getStore",(({data:e})=>this.getStore(e))),b.extension.attachEvent("getStores",(async({data:e})=>this.getStores(e))),b.extension.attachEvent("getStoresByName",(({data:e})=>this.getStoresByName(e.name))),b.extension.attachEvent("updateMerchantSession",(({data:{storeId:e,properties:t}})=>this.updateMerchantSession(e,t))),b.extension.attachEvent("getOffers",(({data:e})=>this.getOffers(e.storeId))),b.extension.attachEvent("getCouponOffers",(({data:e})=>this.getCouponOffers(e.storeId))),b.extension.attachEvent("getCoupons",(({data:e})=>this.getCoupons(e.storeId))),b.extension.attachEvent("merchants.search",(({data:e})=>this.search(e.term))),b.extension.attachEvent("merchants.recent",(async()=>(await this.recent.updateRecent(),this.recent.map((({id:e})=>this.get(e)?.toJSON())).filter(Boolean)))),b.extension.attachEvent("isEligibleForBackgroundActivation",(({data:e})=>{const{storeId:t}=e;return this.get(t)?.isEligibleForBackgroundActivation()})),b.extension.attachEvent("isEligibleForBackgroundActivationV2",(({data:e})=>{const{storeId:t,activateTest:n=!1}=e;return this.get(t)?.isEligibleForBackgroundActivationV2(n)})),Hs.prototype.initialize.apply(this,e)},async getStore(e){const{storeId:t,fetch:n=!1}=e,r=await Ks.getActive();let i=e.url||r.url;if(i=i.replace(/^chrome-extension:\/\/.*\/popup\/popup\.html#/,""),n)try{await this.fetch()}catch{}const s=t?this.get(t):this.match(i,r.tabId);return s?(n&&await this.rates.default.fetch(s.id),{...s.toJSON(),incrementalityTest:await s.incrementalityTest()}):null},async getStores(e){const{storeIds:t,channel:n=rs.DEFAULT}=e;if(!t.length)return[];const r=t.filter((e=>this.get(e)?.get("activationCode")));return this.rates.add(n),await this.rates.get(n).fetch(r),await Promise.all(t.map((async e=>{const t=this.get(e);if(!t)return null;const r=t?.toJSON({channel:n});return{...r,incrementalityTest:await(t?.incrementalityTest())}})))},getStoresByName(e){if(!e)return null;const t=this.filter((t=>{const n=t.get("storeName");return!!n&&(e.length>n.length?-1!==e.indexOf(n):-1!==n.indexOf(e))}));return t&&t.length?t.map((e=>e.toJSON())):null},async getShouldUseExperimentalCoupons(e){if(!Qi.variation("caaAdaptiveSources"))return!1;const t=await xo.inExperiment("BTN220"),n=await(e?.isCaaWithoutActivation()),r=await xo.inExperiment("acs-for-on-platform-extension"),i=Qi.variation("acsOnPlatformAllowed",[]),s=i?.storeIds?.includes(e?.id);return t&&n||r&&s},async getCouponOffers(e){if(!e)return[];const t=(await this.getOffers(e)).filter((e=>e.code)).map((e=>(e.source="OC",e))),n=(0,I.uniq)(t,(({code:e})=>e)),r=this.get(e);let i=n;if(await this.getShouldUseExperimentalCoupons(r)){let e=[];try{e=await r.experimentalCoupons.get()}catch{}const t=n.map((e=>e.code.toUpperCase())),s=(0,I.uniq)(e,(({code:e})=>e)).filter((e=>-1===t.indexOf(e.code.toUpperCase())));i=[...n,...s]}const s=this.get(e),o=s?.get("extensionMaxCouponsUsed")??Qi.variation("caaWithoutActivation",{maxCoupons:15}).maxCoupons??15;return i.length=i.length>o?o:i.length,i},async getCoupons(e){const t=await this.getCouponOffers(e);return[...new Set(t.map((e=>e.code)).filter(Boolean))]},async getOffers(e){if(e){const t=this.findWhere({storeId:e}),n=await(t?.isCaaWithoutActivation());if(t?.isButtonMerchant()||n){try{await t.deals.fetch()}catch{}return t.deals.toJSON()}}return[]},processDocumentComplete({url:e,tabId:t}){if(Fs(e)||!EBATES)return;const n=this.match(e,t);n&&n.processDocumentComplete({url:e,tabId:t})},fetch(e){return Hs.prototype.fetch.call(this,{add:!0,merge:!0,remove:!0,headers:{"X-Platform":ws[rs.DEFAULT]},...e})},merge(e){this.set(e)},async getStoresToUpdate(){let e=0;if(this.length){if(await this.lastModifiedTimes.ifUpdateRequired()){const t=await this.lastModifiedTimes.load(),n=t.filter((({id:t,lastModifiedTime:n})=>{n>e&&(e=n);const r=this.get(t);return!r||r.get("lastModifiedTime")!==n})).map((({id:e})=>e));if(n.length>100)return{storeIds:"all",maxLastModifiedTime:e};{const r=this.reduce(((e,n)=>(t.find((({id:e})=>e===n.id))||e.push(String(n.id)),e)),[]);return{storeIds:n.map((e=>String(e))),maxLastModifiedTime:e,deactivatedStoreIds:r}}}return{}}try{const t=await this.lastModifiedTimes.load();e=(0,I.max)(t,(e=>e.lastModifiedTime))?.lastModifiedTime}catch(e){}return{storeIds:"all",maxLastModifiedTime:e}},async sync(e,...t){if(!Qi.variation("feedGenMerchants",!0))return Hs.prototype.sync.apply(this,[e,...t]);if("read"===e){if(!this.length){const e=await qi.get(this.key);this.set(e);const t=await qi.get(`${this.key}-domains`);this.domains.set(t),this._dataSynced=!0,this.trigger("sync",this)}const{storeIds:e,deactivatedStoreIds:t,maxLastModifiedTime:n}=await this.getStoresToUpdate();if(t?.length&&(this.remove(t),this.domains.remove(this.domains.filter((e=>t.includes(String(e.get("storeId"))))))),e?.length){const t=await zi(ge(C),{data:{name:"all"===e?"button_domain_v1":"button_domain_batch_v1",variables:JSON.stringify({storeIds:e}),...n&&{_:n}},headers:{"X-Platform":ws[rs.DEFAULT]}}),{stores:r,domains:i}=this.parse(t);return"all"===e?(this.set(r),this.domains.reset(i)):(this.set(r,{merge:!0,add:!0,remove:!1}),this.domains.remove(this.domains.filter((t=>e.includes(String(t.get("storeId")))))),this.domains.add(i)),this.syncSettingsDomains(),this._dataSynced=!0,this.trigger("sync",this),await qi.set(`${this.key}-domains`,this.domains.map((({attributes:e})=>e))),await qi.set(this.key,this.map((({attributes:e})=>e))),this}}},match(e,t){let n=null;const r=we(e);if(r){const i=this.domains.where({topDomain:r}).filter((t=>t.match?.test(e)));if(i.length){if(t&&Ks.get(t)?.storeId&&i.length>1){const e=Ks.get(t)?.storeId,r=i.find((t=>t.get("storeId")===e));r&&(n=this.get(r.get("storeId")))}if(n=n||this.get((0,I.max)(i,(e=>e.match.source.length)).get("storeId")),n){if(EBATES.settings.featureFlags.variation("whitelistedCountries",!1)&&n.has("whitelistedCountries")&&EBATES.member.get("country_code")&&!n.get("whitelistedCountries").includes(EBATES.member.get("country_code").toUpperCase()))return null;t&&Ks.has(t)&&(Ks.get(t).storeId=n.get("storeId"))}}else if(t&&EBATES.settings.has("sharedPages")){let r=!1;try{r=EBATES.settings.get("sharedPages").find((t=>new RegExp(t).test(e)))}catch({message:e}){$i.logger.error("RegExpError",{message:e,sharedPages:EBATES.settings.get("sharedPages").join(","),now:Date.now(),source:"settings.sharedPages"})}if(r){const e=Ks.get(t),r=e?.storeId;r&&(n=this.get(r),n&&(e.storeId=r))}}else Ks.has(t)&&(Ks.get(t).storeId=null)}return n?n.session.checkSessionTimeout():Ks.has(t)&&(Ks.get(t).storeId=null),n},async search(e){const t=new ga(this.map((e=>e.pick(["storeId","storeName","domainName"]))),{isCaseSensitive:!1,includeScore:!1,shouldSort:!0,includeMatches:!1,findAllMatches:!1,threshold:.2,keys:["storeName","domainName"]});let n=t.search(e).map((({item:e})=>this.get(e.storeId))).filter((e=>e.isActiveButtonMerchant()));if("X"===await xo.variation("IE-Test-Expedia")){const e=Qi.get("incrementalityTestMerchantsList",{storeIds:[]});n=n.filter((t=>!e.storeIds.includes(t.get("storeId"))))}return n.map((e=>e.toJSON()))},async searchRemote(e){this.removeSearchController?.abort(),this.removeSearchController=new AbortController;const{signal:t}=this.removeSearchController;try{const n=await fetch(ge(k.POPUP_SEARCH).replace("{terms}",encodeURIComponent(e.toLowerCase())),{signal:t});this.removeSearchController=null;const r=await n.json(),i=r.response?.docs?.map((({storeId:e})=>{const t=this.get(e);if(t?.isActiveButtonMerchant())return t.toJSON()})).filter(Boolean);return i||[]}catch(t){return"AbortError"===t.name?[]:await this.search(e)}},parseFeedGenDomains:e=>e.reduce(((e,{storeId:t,domains:n=[]})=>e.concat(n.map((e=>({storeId:t,...e}))))),[]),async syncSettingsDomains(){this.length&&this.setMerchantsSettings()},setMerchantsSettings(){if(!Qi.variation("customMerchants",!1)&&EBATES.settings.domains){const e=EBATES.settings.domains.map((({domainName:e,matchPattern:t,hoverMessage:n,...r})=>r));this.set(e,{merge:!0,add:!0,remove:!1})}},parseFeedGenAPI(e){let t=e.data.stores;const n=this.parseFeedGenDomains(t),r=this.lastModifiedTimes.getData();return t=t.map((({storeId:e,orderConfirmationURLRegex:t=null,orderConfirmationDOMRegex:n=null,domains:i=[],activationCode:s=0,affiliatizerEnabled:o=!1,icbEnabled:a=!1,hoverMessage:c=null,largeLogo:u,squareLogo:l,squareLogoInverse:d,images:h,extensionMaxCouponsUsed:f,...g})=>({storeId:e,activationCode:s,affiliatizerEnabled:o,icbEnabled:a,hoverMessage:c,domainName:i[0]?.domainName,orderConfirmationURLRegex:t,orderConfirmationDOMRegex:n,lastModifiedTime:r?.find((({id:t})=>t===e))?.lastModifiedTime||0,images:{largeLogo:pa(u??h?.largeLogo??l),squareLogo:pa(l),squareLogoInverse:pa(d)},extensionMaxCouponsUsed:f,...g}))),{stores:t,domains:n}},parseApitunerAPI(e){let t=e.domainEntities;return!Qi.variation("customMerchants",!1)&&EBATES.settings.domains&&EBATES.settings.domains.forEach((e=>{const n=t.find((({storeId:t})=>e.storeId===t));n?Object.assign(n,e):t.push(e)})),t=t.map((({orderConfirmation:e,orderConfirmationURLRegex:t=null,orderConfirmationDOMRegex:n=null,images:r,...i})=>({orderConfirmationURLRegex:t,orderConfirmationDOMRegex:n,...i,images:{largeLogo:pa(r?.largeLogo)}}))),this.domains.set(t.map((({storeId:e,matchPattern:t,domainName:n})=>({storeId:e,matchPattern:t,domainName:n})))),t},parse(e){return Qi.variation("feedGenMerchants",!0)?this.parseFeedGenAPI(e):this.parseApitunerAPI(e)},updateMerchantSession(e,t){const{sessionAttributes:n,...r}=t,i=this.get(e);if(i){const e=i.session;r&&e.set(r),n&&e.shoppingTrip.addPendingAttributes(n)}},async updateMerchantRates(e){const t=this.get(e);try{[0,2].includes(t.get("activationCode"))||t.get("activated")||await this.rates.default.fetch(e)}catch(e){}if(this.rates.default.expired){const e=await b.extension.getItem("rewardsExpire"),t=await b.extension.getItem("rewards.nextUpdateTime");$i.logger.warn("RewardsExpired",{expired:e,next:t,now:Date.now(),source:"getMerchant"})}},async getMerchant({url:e,tabId:t}){if(Fs(e)||!EBATES)return null;const n=this.match(e,t);if(n){await this.updateMerchantRates(n.id),EBATES.ebToken&&n.isActiveMerchant()&&this.recent.visit(n);const e=EBATES.settings.userSettings.get("notificationExcludedStores")??[];return{...n.toJSON(),blacklisted:e.includes(n.get("storeId")),incrementalityTest:await n.incrementalityTest(),recommendedStoresPromo:await n.getRecommendedStores(),isCaaWithoutActivation:await n.isCaaWithoutActivation()}}return null},sessionsResetAll(){this.forEach((e=>e.session.reset()))}});var ba=i(9964);const wa=(e,t)=>t.some((t=>e instanceof t));let Aa,xa;const Ea=new WeakMap,Sa=new WeakMap,Ta=new WeakMap;let _a={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Ea.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Pa(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function ka(e){_a=e(_a)}function Ca(e){return(xa||(xa=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(Ma(this),t),Pa(this.request)}:function(...t){return Pa(e.apply(Ma(this),t))}}function Ia(e){return"function"==typeof e?Ca(e):(e instanceof IDBTransaction&&function(e){if(Ea.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));Ea.set(e,t)}(e),wa(e,Aa||(Aa=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,_a):e)}function Pa(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(Pa(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return Ta.set(t,e),t}(e);if(Sa.has(e))return Sa.get(e);const t=Ia(e);return t!==e&&(Sa.set(e,t),Ta.set(t,e)),t}const Ma=e=>Ta.get(e);const Da=["get","getKey","getAll","getAllKeys","count"],Ra=["put","add","delete","clear"],La=new Map;function Oa(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(La.get(t))return La.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=Ra.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Da.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&s.done]))[0]};return La.set(t,s),s}ka((e=>({...e,get:(t,n,r)=>Oa(t,n)||e.get(t,n,r),has:(t,n)=>!!Oa(t,n)||e.has(t,n)})));const Ba=["continue","continuePrimaryKey","advance"],Na={},ja=new WeakMap,Ua=new WeakMap,Fa={get(e,t){if(!Ba.includes(t))return e[t];let n=Na[t];return n||(n=Na[t]=function(...e){ja.set(this,Ua.get(this)[t](...e))}),n}};async function*$a(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;const n=new Proxy(t,Fa);for(Ua.set(n,t),Ta.set(n,Ma(t));t;)yield n,t=await(ja.get(n)||t.continue()),ja.delete(n)}function qa(e,t){return t===Symbol.asyncIterator&&wa(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&wa(e,[IDBIndex,IDBObjectStore])}function Ha(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}ka((e=>({...e,get:(t,n,r)=>qa(t,n)?$a:e.get(t,n,r),has:(t,n)=>qa(t,n)||e.has(t,n)})));var Wa,Ga,Va={exports:{}};function za(){if(Ga)return Wa;Ga=1;var e=1e3,t=60*e,n=60*t,r=24*n,i=7*r,s=365.25*r;function o(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}return Wa=function(a,c){c=c||{};var u=typeof a;if("string"===u&&a.length>0)return function(o){if(o=String(o),!(o.length>100)){var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(o);if(a){var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*s;case"weeks":case"week":case"w":return c*i;case"days":case"day":case"d":return c*r;case"hours":case"hour":case"hrs":case"hr":case"h":return c*n;case"minutes":case"minute":case"mins":case"min":case"m":return c*t;case"seconds":case"second":case"secs":case"sec":case"s":return c*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}}}(a);if("number"===u&&isFinite(a))return c.long?function(i){var s=Math.abs(i);return s>=r?o(i,s,r,"day"):s>=n?o(i,s,n,"hour"):s>=t?o(i,s,t,"minute"):s>=e?o(i,s,e,"second"):i+" ms"}(a):function(i){var s=Math.abs(i);return s>=r?Math.round(i/r)+"d":s>=n?Math.round(i/n)+"h":s>=t?Math.round(i/t)+"m":s>=e?Math.round(i/e)+"s":i+"ms"}(a);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(a))},Wa}var Ja=function(e){function t(e){let r,i,s,o=null;function a(...e){if(!a.enabled)return;const n=a,i=Number(new Date),s=i-(r||i);n.diff=s,n.prev=r,n.curr=i,r=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,i)=>{if("%%"===r)return"%";o++;const s=t.formatters[i];if("function"==typeof s){const t=e[o];r=s.call(n,t),e.splice(o,1),o--}return r})),t.formatArgs.call(n,e),(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(i!==t.namespaces&&(i=t.namespaces,s=t.enabled(e)),s),set:e=>{o=e}}),"function"==typeof t.init&&t.init(a),a}function n(e,n){const r=t(this.namespace+(typeof n>"u"?":":n)+e);return r.log=this.log,r}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(r),...t.skips.map(r).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=za(),t.destroy=function(){},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t};!function(e,t){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(i=r))})),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch{}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch{}return!e&&typeof ba<"u"&&"env"in ba&&(e=ba.env.DEBUG),e},t.useColors=function(){if(typeof window<"u"&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let e;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch{}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0)}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=Ja(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}(Va,Va.exports);const Ka=Ha(Va.exports),Ya=typeof window<"u"?window.chrome||window.browser:typeof chrome<"u"?chrome:void 0;typeof window<"u"&&typeof Ya<"u"&&Ya.runtime;class Xa{}const Za=new class extends Xa{constructor(){super(),this.name="RECLAIM_SDK",this.logger=Ka(this.name),this.logMethods=["log","info","warn","error"],this.logMethods.forEach((e=>{this[e]=(...t)=>this.createLogLevel(e)(...t)}))}createLogLevel(e){return["log","info"].includes(e)?()=>{}:(this.logger[e]=function(){}.bind(),(...t)=>{const n=t[0],r=t[1];this.logger[e]({level:e,message:n,data:r,name:this.name,ts:(new Date).toISOString()})})}},Qa="PluginState";class ec{constructor(){try{this.dbPromise=function(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),a=Pa(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(Pa(o.result),e.oldVersion,e.newVersion,Pa(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}("ReclaimSDK",1,{upgrade(e){e.objectStoreNames.contains(Qa)||e.createObjectStore(Qa,{keyPath:"key"})}})}catch(e){const t=e;Za.error(`StorageWrapper error: ${t.message}`,e)}}async get(e){return this.dbPromise?(await this.dbPromise).get(Qa,e):void 0}async set(e,t){this.dbPromise&&await(await this.dbPromise).put(Qa,{key:e,value:t,lastUpdated:(new Date).toISOString()})}async delete(e){this.dbPromise&&await(await this.dbPromise).delete(Qa,e)}}const tc=/^[v^~<>=]*?(\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+))?(?:-([\da-z\-]+(?:\.[\da-z\-]+)*))?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,nc=e=>{if("string"!=typeof e)throw new TypeError("Invalid argument expected string");const t=e.match(tc);if(!t)throw new Error(`Invalid argument not valid semver ('${e}' received)`);return t.shift(),t},rc=e=>"*"===e||"x"===e||"X"===e,ic=e=>{const t=parseInt(e,10);return isNaN(t)?e:t},sc=(e,t)=>{if(rc(e)||rc(t))return 0;const[n,r]=((e,t)=>typeof e!=typeof t?[String(e),String(t)]:[e,t])(ic(e),ic(t));return n>r?1:n<r?-1:0},oc=(e,t)=>{for(let n=0;n<Math.max(e.length,t.length);n++){const r=sc(e[n]||"0",t[n]||"0");if(0!==r)return r}return 0},ac=(e,t,n)=>{lc(n);const r=((e,t)=>{const n=nc(e),r=nc(t),i=n.pop(),s=r.pop(),o=oc(n,r);return 0!==o?o:i&&s?oc(i.split("."),s.split(".")):i||s?i?-1:1:0})(e,t);return cc[n].includes(r)},cc={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1],"!=":[-1,1]},uc=Object.keys(cc),lc=e=>{if("string"!=typeof e)throw new TypeError("Invalid operator type, expected string but got "+typeof e);if(-1===uc.indexOf(e))throw new Error(`Invalid operator, expected one of ${uc.join("|")}`)},dc=(e,t)=>{if((t=t.replace(/([><=]+)\s+/g,"$1")).includes("||"))return t.split("||").some((t=>dc(e,t)));if(t.includes(" - ")){const[n,r]=t.split(" - ",2);return dc(e,`>=${n} <=${r}`)}if(t.includes(" "))return t.trim().replace(/\s{2,}/g," ").split(" ").every((t=>dc(e,t)));const n=t.match(/^([<>=~^]+)/),r=n?n[1]:"=";if("^"!==r&&"~"!==r)return ac(e,t,r);const[i,s,o,,a]=nc(e),[c,u,l,,d]=nc(t),h=[i,s,o],f=[c,null!=u?u:"x",null!=l?l:"x"];if(d){if(!a)return!1;if(0!==oc(h,f))return!1;if(-1===oc(a.split("."),d.split(".")))return!1}const g=f.findIndex((e=>"0"!==e))+1,p="~"===r?2:g>1?g:1;return 0===oc(h.slice(0,p),f.slice(0,p))&&-1!==oc(h.slice(p),f.slice(p))};var hc=i(7059),fc=i.n(hc);const gc=Us.Model.extend({idAttribute:"created",defaults:{created:null,removed:!1,shown:!1,text:""},initialize(){this.get("created")||this.set("created",Date.now()),this.on("change:unread",(()=>{this.collection.trigger("change")}))},toJSON(e){const t=Us.Model.prototype.toJSON.apply(this,[e]);if("cashback"===this.get("type")){const e=EBATES.merchants.get(this.get("storeId"));e&&(t.store=e.toJSON())}return t}}),pc=Vs.extend({key:"messages",model:gc,initialize(){this.fetch({silent:!0}),this.on({"add remove change reset":function(){const e=this.where({shown:!1}).length;EBATES.badge.update("message",e),this.save()},add:async function(e){Qi.variation("desktopNotifications",!0)&&b.browser.isWebkit&&e.get("desktop")&&await this.checkPermission()&&new mc({...e.toJSON(),id:e.id},this).render()}})},flush(){return this.remove(this.filter((e=>{const t=e.has("created")&&e.get("shown")&&e.get("created")<Date.now()-EBATES.settings.get("messageExpires");return e.get("removed")||t}))),Promise.resolve()},async checkPermission(){try{return await n().permissions.contains({permissions:["notifications"]})}catch{return!1}}});class mc{category="Desktop Notification";notificationId="";constructor(e,t){this.message={...e},this.collection=t,this.attachEvents()}onButtonClicked=async e=>{e===this.notificationId&&(this.click(),this.track("Click Module",{cta_type:this.message.cta}))};onClicked=async e=>{e===this.notificationId&&(this.message.url&&!this.message.cta&&this.click(),this.track("Click Module",{cta_type:"Message"}))};onClosed=e=>{e===this.notificationId&&(this.track("Click Module",{cta_type:"Close"}),!this.message.popup&&this.message.desktop&&this.collection?.remove(this.message),this.detachEvents())};getEventParams(){return{module_type:this.category,entity_name:this.message.entity,store_name:this.getMerchantName()}}getMerchantName(){return this.message.storeId&&EBATES.merchants.has(this.message.storeId)?EBATES.merchants.get(this.message.storeId).get("storeName"):void 0}track(e,t={}){self.EBATES.segment.track(e,{...this.getEventParams(),...t})}async click(){if(!this.message.url)return;const e=Hi(this.message.url,{visit_id:EBATES.visitId});this.track("Visit Page",{preceding_screen_name:this.category,url:e}),b.browser.navigate({url:e,tabId:b.browser.NEWTAB}),await n().notifications.clear(this.notificationId),this.detachEvents()}attachEvents(){n().notifications.onButtonClicked.addListener(this.onButtonClicked),n().notifications.onClicked.addListener(this.onClicked),n().notifications.onClosed.addListener(this.onClosed)}detachEvents(){n().notifications.onButtonClicked.removeListener(this.onButtonClicked),n().notifications.onClicked.removeListener(this.onClicked),n().notifications.onClosed.removeListener(this.onClosed)}async render(){try{const e=this.message,t=await n().notifications.create({type:"basic",title:e.title??b.extension.name,iconUrl:e.image??n().runtime.getURL("/img/icon/icon-128.png"),message:e.text,buttons:e.url&&e.cta?[{title:e.cta}]:null});this.notificationId=t,this.track("View Module")}catch(e){}}}const vc=$s.extend({defaults:{popup:!1,badge:!1,shown:!1,active:!1},campaigns:null,initCampaigns(){this.has("campaigns")&&(this.campaigns||(this.campaigns=new xc(null,this)),this.campaigns.set(this.get("campaigns")))},isActive(){if(EBATES?.member.isExtensionDisabled())return!1;if(this.has("expires")&&this.has("starts")){const e=Date.now(),t=new Date(this.get("starts")).getTime(),n=new Date(this.get("expires")).getTime();return this.set({active:e>=t&&e<n&&this.isCampaignSupported()}),this.get("active")}{const e=this.isCampaignSupported();return e||this.set({active:!1}),e}},initTimeouts(){if(this.has("expires")&&this.has("starts")){this.timeout&&self.clearInterval(this.timeout);const e=Date.now(),t=new Date(this.get("starts")).getTime(),n=new Date(this.get("expires")).getTime();this.set({active:e>=t&&e<n&&this.isCampaignSupported()});const r=e=>(0,I.min)([new Date(e).getTime()-Date.now(),6e5]);let i;e<t?i=r(t):e<n&&(i=r(n)),i&&(this.timeout=self.setInterval((()=>{this.initTimeouts()}),i))}},isCampaignSupported(){let e=!0;return this.get("browser")&&(e=(0,I.contains)(this.get("browser").split(","),b.browser.name)),this.get("version")&&(e=e&&dc(b.extension.version,this.get("version"))),e},activate(){this.get("badge")&&!this.get("shown")&&(EBATES.badge.update("promo",1),EBATES.member.overlays.where({shown:!1}).forEach((e=>e.set({shown:!0}))),EBATES.member.overlays.save()),Qi.variation("desktopNotifications",!0)&&this.get("desktopTitle")&&this.get("desktopMessage")&&!this.get("desktopMessageShown")&&EBATES.member.messages.checkPermission().then((()=>{new mc({type:this.id,title:this.get("desktopTitle"),text:this.get("desktopMessage"),url:ge(this.toJSON().url),image:this.get("icon"),entity:this.id}).render(),this.set({desktopMessageShown:!0})})).catch((()=>{})),this.get("overlay")&&this.get("overlay").template&&!EBATES.member.overlays.get(this.id)&&EBATES.member.overlays.add({id:this.id,view:"CustomOverlayView",persistent:this.get("overlay").persistent,template:this.get("overlay").template})},initialize(){this.isCampaignSupported()?(this.on({"change:campaigns":function(){this.initCampaigns()},"change:starts change:expires":function(){this.initTimeouts()},"change:active":function(e,t){t?this.activate():(EBATES.member.overlays.remove(this.id),EBATES.member.overlays.save(),EBATES.badge.update("promo",0)),"icons"===this.id&&setTimeout((()=>EBATES.icon.load()),500)},"change:shown":function(e,t){t&&EBATES.badge.update("promo",0)}}),this.get("active")&&this.activate(),this.initCampaigns(),this.initTimeouts()):this.set({active:!1})},toJSON(e){return{...$s.prototype.toJSON.apply(this,[e]),...this.collection.savedAttributes.get(this.id)}}}),yc=Hs.extend({model:vc,key:"promos",url:()=>ge(k.SETTINGS_PROMOS),UPDATE_INTERVAL:108e5,parse(e){return e.promos.map((e=>({...e,...this.savedAttributes.get(e.id)})))},fetch(...e){return!1!==Qi.variation("customPromos",!1)&&Hs.prototype.fetch.apply(this,e)},initialize(...e){this.savedAttributes=new Map,qi.get(`${this.key}-attributes`).then(((e=[])=>{this.savedAttributes=new Map(e)}));const t=["shown","desktopMessageShown","interruptShown","serpClosed","disabled","data"];return this.on("change",(e=>{(0,I.intersection)(Object.keys(e.changedAttributes()),t).length>0&&(this.savedAttributes.set(e.id,e.pick(t)),this.saveLocalAttributes())})),b.extension.attachEvent("updatePromo",(({data:e={}})=>{const{id:t,...n}=e;this.get(t)&&(this.get(t).set(n),b.extension.fireEvent("promoUpdated",{tabId:b.browser.ALLTABS,data:this.get(t).toJSON()}))})),b.extension.attachEvent("getCampaignStores",(async({data:e},t)=>{const{id:n,fetch:r=!1,rewards:i=!1}=e,s=(0,I.flatten)(this.map((e=>e.campaigns?.models)).filter(Boolean)).find((e=>e.id===n));if(s){const e=s.get("channel")||rs.DEFAULT;if(r){EBATES.merchants.rates.add(e);try{await s.stores.fetch(),await EBATES.merchants.rates.get(e).fetch(s.stores.pluck("storeId"))}catch(e){t(null)}}t(i?s.stores.toJSON():s.stores.map((e=>({storeId:e.id}))))}else t(null)})),Hs.prototype.initialize.apply(this,[e])},saveLocalAttributes(){for(const e of this.savedAttributes)this.get(e)||this.savedAttributes.delete(e);qi.set(`${this.key}-attributes`,[...this.savedAttributes])},getActive(){return this.find((e=>e.get("active")&&Date.now()>=new Date(e.get("starts")).getTime()&&Date.now()<new Date(e.get("expires")).getTime()))}}),bc=$s.extend({idAttribute:"storeId",toJSON(e){const t=EBATES.merchants.get(this.get("storeId"));if(t?.has("shoppingURL")&&t.isButtonMerchant()){const n=t.toJSON(),r=Hi(n.shoppingURL.replace("&store_url=%deepLinkUrl%",""),{merchantId:n.storeId,domainName:n.domainName,tb:"yes",toolbarId:EBATES.toolbarId,sourceName:is,channel:rs.DEFAULT,toolbarFeatureId:"TOPSTORES",tb_v:b.extension.version,eeid:n.mpl?As.MPL_STORE:"26142",mpl_id:n.mpl});return{...$s.prototype.toJSON.apply(this,[e]),...n,shoppingURL:r}}}}),wc=Hs.extend({model:bc,DEFAULT_UPDATE_INTERVAL:864e5,url(){return`${ge(k.CAMPAIGNS)}?id=${this.id}`},initialize(e,t,...n){return this.id=t.id,this.key=`campaigns/${this.id}`,this.campaign=t,t.get("update")&&(this.UPDATE_INTERVAL=t.get("update"),this.dynamic=!0),this.on("error",(()=>{const e=this.campaign.collection.promo;var t,n;$i.logger.warn("NetworkException",{type:"campaign",url:this.url(),campaign:e?e.toJSON():this.id,localTime:(t="YYYY-MM-DD HH:mm",fc()(n).format(t))})})),Hs.prototype.initialize.apply(this,[e,t,n])},parse(e){const t=e.campaigns?.pop();if(t)return this.details=(0,I.pick)(t,["name","start","expires"]),t.stores},fetch(...e){const t=this.campaign.collection.promo;return this.id&&t&&t.isActive()?Hs.prototype.fetch.apply(this,e):Promise.resolve()},toJSON(e){return Hs.prototype.toJSON.apply(this,[e]).filter(Boolean)}}),Ac=Us.Model.extend({defaults:{popup:!1,hover:!1,update:0},lastUpdateTimestamp:0,initialize(){this.stores=new wc(null,this),this.get("stores")&&this.stores.set(this.get("stores")),this.listenTo(this.collection.promo,"change:active",(e=>{e&&this.get("update")&&(this.get("popup")||this.get("tab")||this.get("hover"))&&(EBATES.merchants.rates.default&&EBATES.merchants.rates.default.reset(),this.stores.fetch())})),this.collection.promo.get("active")&&setTimeout((()=>this.stores.fetch()),3e3),this.collection.promo.set(this.pick((e=>!0===e)))}}),xc=Us.Collection.extend({model:Ac,initialize(e,t){this.promo=t}});function Ec(e,t){let n=0;if(!e)return n;switch(e.display){case"Percentage":n=Math.round(t*e.amount)/100;break;case"Fixed":n=e.amount}return n}function Sc(e,t,n=100){function r(e,t,n){return e.split(/ *&& */).reduce(((e,r)=>function(e,t,n=100){const[r,i,s,o]=/^([<>]=?)(\d+(?:\.\d+)?)(%?)$/.exec(e)||[];if(!r)throw new Error("Invalid input");const a=o?n*parseFloat(s)/100:parseFloat(s);return">"===i?t>a:"<"===i?t<a:">="===i?t>=a:"<="===i&&t<=a}(r,t,n)&&e),!0)}return function(e,t,n){return e.split(/ *\|\| */).reduce(((e,i)=>r(i,t,n)||e),!1)}(e,t,n)}const Tc=/\b(?:clearance|memberships?|pickup|delivery|clearance)\b/,_c=/\bother\b/;let kc;class Cc{api_call="";storeName="";module_type="Price Magic";entity_name="Price Magic Notification";constructor({canonical_url:e,domainName:t,query:n={},storeName:r,isLuxury:i}){this.requestId=_(),this.canonical_url=e,this.domainName=t,this.query=n,this.storeName=r,this.isLuxury=i}get url(){return ge(k.PRICE_MAGIC)}get bulkUrl(){return ge(k.PRICE_MAGIC_BULK)}async fetch(){const e=await this.getPriceMagicTest(),t=Hi(this.url,{...this.query,postfilter:kc.postfilter,user_abSegment:e});this.api_call=t;const n=await zi({url:t,error:(e,n,r)=>{throw this.trackRequestAPI({url:t,status:n}),{response:e,status:n,error:r}}});let r=this.parse(n);await this.fetchRewards(r),r=this.populateURLs(r);let i=await this.populateMerchant(r);i=this.processProducts(i,this.query),i=this.sortProducts(i);const s=this.checkProducts(i);return this.trackRequestAPI({url:t,products:i,product:s}),s}async getPriceMagicTest(){const e="BTN204",t=await xo.getFlag(e);if(t?.in_experiment){const t=await xo.activate(e);if("X"===t)return"segment_x";if("A"===t)return"segment_a"}return""}async fetchBulk(e){let t=0;let n=0,r=[];const i=e.map((({asin:e})=>e)).join(",");if(!i)return[];this.entity_name="Search result micro-activation button";let s=0;const o=await this.getPriceMagicTest();do{const e=Hi(this.bulkUrl,{asins:i,hits:60,offset:n,postfilter:kc.postfilter,user_abSegment:o});this.api_call=e;const a=await zi({url:e,error:(t,n,r)=>{throw this.trackBulkRequestAPI({url:e,status:n}),{response:t,status:n,error:r}}});let c=this.parse(a);if(await this.fetchRewards(c),c=this.populateURLs(c),c=await this.populateMerchant(c),this.trackBulkRequestAPI({url:e,products:c}),r=r.concat(c),n+=60,t=a.hits.total,s++>=5)break}while(t>r.length);return e.map((e=>{let t=r.filter((({asins:t})=>t.includes(e.asin)));t=t.map((t=>this.processProduct({...t},e))),t=this.sortProducts(t);const n=this.checkProducts(t);return{...e,pmProduct:n}}))}parse(e){return e.hits.hits.map((t=>({...t._source,algorithmMatched:t._source.algorithmMatched??e.algorithmMatched??"idenMatch"})))}fetchRewards(e){if(e.length)try{const t=(0,I.unique)(e.map((e=>e.storeId)));return self.EBATES.merchants.rates.get(rs.PRICE_MAGIC).fetch(t)}catch(e){}}populateURLs(e){return e?.map((e=>fe({...e},`https://${k.PRODUCT_CDN}`)))}async populateMerchant(e){const t={channel:rs.PRICE_MAGIC},n=await Promise.all(e.map((async e=>{const n=self.EBATES.merchants.get(e.storeId),r=n?n.toJSON(t):null;return{...e,merchant:{...r,incrementalityTest:await n.incrementalityTest()}}}))),r=n.map((e=>e.merchant?.reward.tiered&&e.merchant?.storeId)),i=[...new Set(r.filter(Boolean))];return await(self.EBATES.merchants.tiers.get(rs.PRICE_MAGIC)?.fetch(i)),i.forEach((e=>{const t=self.EBATES.merchants.tiers.get(rs.PRICE_MAGIC)?.stores.get(e)?.tiers;t&&n.forEach((n=>{n.merchant?.storeId===e&&(n.merchant.tiers=t)}))})),n}processProducts(e,t){return e.map((e=>this.processProduct(e,t)))}processProduct(e,t){const n=e.salePrice;let r=0;if(e.eligibleForCashBack&&e.merchant&&e.merchant.reward){let t=e.merchant.reward,i=null;t.range&&e.merchant.tiers&&Qi.variation("pmTieredCalc")&&(i=e.merchant.tiers.find((({id:t})=>parseInt(t,10)===parseInt(e.categoryId,10))),e.cb_type="tiered"),i&&(e.merchant.reward=t=i.reward),t.range||(r=Ec(t,n)),kc.affiliatizedLinks.find((t=>e.productUrl.indexOf(t)>0))?e.cta_type="aff_link":e.merchant.affiliatizerEnabled?e.cta_type="affiliatizer-yes":e.cta_type="affiliatizer-no"}else e.cta_type="no-cb";const i=t.salePrice;return e.originalPrice=i,e.salePrice=n,e.finalPrice=n-r,e.cashBackAmount=r,e.savingsAmount=i-n+r,e.asin=t.asin,e.isLuxurySource=this.isLuxury,e.merchant&&(e.merchant.storeContent={}),e}sortProducts=e=>Qi.variation("pmScoringEnabled")?this.sortByScores(e):this.sortByPrice(e);sortByPrice=e=>e=(0,I.chain)(e).sortBy((e=>-e.savingsAmount)).sortBy((e=>!e.merchant)).value();sortByScores=e=>(this.setPoints(e),e=(0,I.chain)(e).sortBy((()=>Math.random())).sortBy((e=>e.finalPrice)).sortBy((e=>e.merchant?.pmScore)).sortBy((e=>-(e.points??0))).value());setPoints=e=>{e.forEach((e=>{let t=e.merchant?.pmScore||0;e.savingsAmount<0?t=0:t+=Math.floor(e.savingsAmount),e.points=t}))};processPredictedTiers(e){const t="not found",n="non tier",r={type:t,tier:{id:t,name:t}},i=e.map((e=>{const t=e.merchant;return t?.tiers?function(e,t){if(0===t.length||!("name"in t[0]))return null;const n=e.categoryPathEbates.toLowerCase().split(" > ").reverse(),r=t.map((e=>{const t=e.name.toLowerCase();return{...e,name:t,nameSplit:t.split(/[,&]/).map((e=>e.trim()))}}));for(const e of n)for(const t of r)if(!Tc.test(t.name)&&!_c.test(t.name)&&t.name===e)return{tier:t,type:"Type A"};const i=n.reduce(((e,t)=>e.concat(t.split(/[,&]/).map((e=>e.trim())))),[]);for(const e of i)for(const t of r)if(!Tc.test(t.name)&&!_c.test(t.name)&&t.nameSplit.includes(e))return{tier:t,type:"Type B"};if(r.find((e=>Tc.test(e.name))))return null;const s=r.find((e=>_c.test(e.name)));return s?{tier:s,type:"Type C"}:null}(e,t.tiers)??r:null}));return i.filter(Boolean).length>0?{predicted_tier:i.map((e=>e?.tier?.name??n)).join(","),predicted_tier_id:i.map((e=>e?.tier?.id.toString()??n)).join(","),predicted_tier_type:i.map((e=>e?.type.toString()??n)).join(",")}:{}}trackRequestAPI({url:e,status:t,products:n=[],product:r}){const i=r,s=i?.merchant,o=n.filter((e=>e.merchant&&e.merchant?.storeId!==s?.storeId)),a=o.map((e=>e.merchant)),c=n.map((e=>this.query.salePrice-e.salePrice)).map((e=>e.toFixed(2))).toString(),u=this.processPredictedTiers(n),l={entity_name:this.module_type,rec_stores_scores:n.map((e=>e.points)).filter(Number.isInteger).toString(),rec_stores_savings:n.map((e=>e.savingsAmount.toFixed(2))).toString(),title:this.query.title,brandName:this.query.brandName,asin:this.query.asin,breadcrumb:this.query.breadcrumb,current_product_price:this.query.salePrice,rec_stores_priceDelta_savings:c,rec_stores_cashBack_savings:n.map((e=>e.cashBackAmount)).toString(),winning_store_id:s?.storeId,winning_store_listing_type:i?.thirdPartyMerchantTag,winning_store_name:s?.storeName,suppressed_store_ids:a.map((e=>e?.storeId)).filter(Boolean).toString(),suppressed_store_names:a.map((e=>e?.storeName)).filter(Boolean).toString(),product_condition:this.query.condition,isLuxury:this.isLuxury,...u};this.trackBulkRequestAPI({url:e,status:t,products:n,data:l})}trackBulkRequestAPI({url:e,status:t,products:n=[],data:r={}}){const i={module_type:this.module_type,entity_name:`${this.module_type} ${this.entity_name}`,domain:this.domainName,api_call:e,error:t??null,recs:n.length,algorithmMatched:n.length?n[0].algorithmMatched:null,rec_stores:n.map((e=>e.store)).toString(),rec_store_ids:n.map((e=>e.storeId)).toString(),rec_stores_listing_type:n.map((e=>e.thirdPartyMerchantTag)).toString(),canonical_url:this.canonical_url,product_upc:n.map((e=>e.upcs)).toString(),requestId:this.requestId,...r};self.EBATES.segment.track("Request API",i)}checkProducts(e){if(!e.length)return;let t="";const n=e.find((e=>{if(e.savingsAmount>0){const n=kc.exclusions.find((t=>t.storeId===e.merchant?.storeId));if(n){if(!n.excludedCategories&&!n.includedCategories)return this.excludedEvent("PriceMagic_excluded_rec",e,"exluded store"),!1;if(n.excludedCategories?.includes(e.categoryId)||!n.includedCategories?.includes(e.categoryId))return this.excludedEvent("PriceMagic_excluded_rec",e,"exluded category"),!1}return self.EBATES.settings.userSettings.get("progressiveEducation").PriceMagic&&e.savingsAmount<kc.thresholdAmount?(t="below first-time savings threshold",!0):e.merchant&&0!==e.merchant.activationCode?this.checkThresholdTier(e)||18397===e.merchant.storeId?(e.merchant.incrementalityTest,!0):(this.excludedEvent("PriceMagic_excluded_rec",e,"excluded range"),!1):(this.excludedEvent("PriceMagic_excluded_rec",e,"exluded store"),!1)}return t=0===e.savingsAmount?"same price":e.salePrice>e.originalPrice?"rec more expensive":"excluded store",!0}));if(!t||!n)return n;this.excludedEvent("PriceMagic_hid_bar",n,t)}checkThresholdTier=e=>{if(!kc.tiers)return!0;const t=kc.tiers.find((t=>{const n=!t.algorithmMatched||t.algorithmMatched?.split(",").includes(e.algorithmMatched),r=!t.storeName||t.storeName===this.storeName,i=!t.recommendedStoreIds||t.recommendedStoreIds.includes(e.merchant?.storeId??0);return n&&r&&i}));if(t){const n=t.ranges?.find((t=>(!t.savings||Sc(t.savings,e.savingsAmount,e.originalPrice))&&(!t.price||Sc(t.price,e.finalPrice,e.originalPrice))));return n}return!1};excludedEvent(e,t,n=null){const r={domain:this.domainName,rec_store_name:t.store,rec_store_id:t.storeId,api_call:this.api_call,algorithmMatched:t.algorithmMatched,current_product_price:t.originalPrice?.toFixed(2),savings_amount:t.savingsAmount?.toFixed(2),rec_product_price:t.salePrice?.toFixed(2),category:t.categoryName,product_upc:t.upcs?.toString(),listingId:t.listingId,reason:n};let i="Exclude from Price Magic";return"PriceMagic_hid_bar"===e&&(i="Suppress Module"),this.track(i,r),i}track(e,t={}){self.EBATES.segment.track(e,{module_type:this.module_type,entity_name:this.entity_name,requestId:this.requestId,...t})}}class Ic extends Zi{_id="price-magic-domains";UPDATE_INTERVAL=108e5;constructor(){super()}get url(){return ge(k.SETTINGS_PM)}parse(e){const t=e?e.domains:[];return t.forEach((e=>{e.enabled=e.enabled||!0})),t}}class Pc{key="installedExtensions";extensions=[];constructor(){this.initialize()}set(e){const t=[];for(const[n,r]of Object.entries(e))t.push({installed:!1,...this.extensions.find((e=>e.id===n)),id:n,url:r});Object.assign(this.extensions,t),this.extensions=this.extensions.filter((({id:t})=>e[t])),self.EBATES.setUninstallURL()}initialize(){b.extension.attachEvent("installedExtensions",(()=>this.getInstalledExtensions())),b.extension.attachEvent("saveAndSendInstalledExtensions",(({data:e})=>{const{extensions:t}=e;this.extensions=t,b.extension.setItem("installed_extensions_check",Date.now()),this.save(),this.sendEvents(),self.EBATES.setUninstallURL()})),this.load()}save(){b.extension.setItem(this.key,this.extensions)}async load(){const e=await b.extension.getItem(this.key);e&&Object.assign(this.extensions,e)}sendEvents(){const e=this.getInstalledExtensions();self.EBATES.segment.track("Competitor Applications",{extensions:e.toString()})}getInstalledExtensions(){return this.extensions.filter((({installed:e})=>e)).map((({id:e})=>e))}}class Mc{constructor(e,t){this.type=t,this.matches=new Map,this.data=new Set(e)}findMatch(e){return[...this.data].find((t=>"string"==typeof t?e.indexOf(t)>0:!(t.source.includes("booking\\.com")&&!Qi.variation("customBookingStanddown"))&&t.test(e)))}add(e){e.forEach((e=>this.data.add(e)))}set(e){this.data=new Set(e)}match(e,t){const n=this.findMatch(e);if(n){const r=this.matches.get(t)??[];r.push({url:e,timeStamp:Date.now(),paidLink:n}),this.matches.set(t,r)}return n}clear(e){this.matches.delete(e)}state(e){const t=Date.now()-6e4,n=(this.matches.get(e)??[]).filter((({timeStamp:e})=>e>t));return n.length&&this.matches.set(e,n),n[0]}addParameters(e,t){const n=this.matches.get(e);n?this.matches.set(e,n.map((e=>({...e,...t})))):this.matches.set(e,[{...t,timeStamp:Date.now()}])}}class Dc{suppresses=new Mc([],"suppresses");activations=new Mc([],"activations");constructor(){this.activationRegexs(),b.browser.attachEvent(b.browser.TABCLOSED,(({tabId:e})=>this.clear(e))),b.browser.attachEvent(b.browser.BEFORENAVIGATE,(({url:e,tabId:t})=>{e&&this.match(e,t)})),b.extension.attachEvent("interstitial",(({tabId:e,data:t})=>this.onInterstitial(t,e)))}activationRegexs(){this.activations.set([new RegExp(`^[^?]*${le.get("domain").replace(/\./g,"\\.")}\\/.*(?:createShoppingSession|xfas|mall_ctrl\\.do)`),/\.shopstyle(?:qa)?\.com\/\w+\/(?:loadRetailerProductPage|apiVisitRetailer)/,/\/\/shopping\.yahoo\.com\/rd\?.*?providerId=rkt/])}onInterstitial(e,t){const{trackingTicketNumber:n,partner:r,reward:i}=e;!r||n&&i?this.activations.addParameters(t,e):this.activations.clear(t)}match(e,t){this.activations.match(e,t)||this.suppresses.match(e,t)}state(e=0){return{tabId:e,activation:this.activations.state(e),suppress:this.suppresses.state(e)}}clear(e=0){this.suppresses.clear(e),this.activations.clear(e)}}function Rc(e,t=null){return e.then((e=>e)).catch((()=>t))}const Lc=new class extends Zi{_id="coupons";DEFAULT_UPDATE_INTERVAL=864e5;constructor(){super(),b.extension.attachEvent("coupons.getConfigs",(async({data:e})=>{const{url:t,storeId:n}=e;if(t){return await this.match({url:t,storeId:n})}return null})),b.extension.attachEvent("coupons.hasConfigs",(async({data:e})=>{const{storeId:t}=e;if(t){const e=await this.getConfigs();return!!e?.find((e=>e.storeId===t&&this.validateConfig(e)))}return!1}))}get url(){return ge(k.SETTINGS_COUPONS)}validateConfig(e){const t=e.controls;return(0,I.isObject)(t)&&((0,I.isObject)(e.apply)&&"submit"in e.apply&&(0,I.isString)(e.apply.submit)||(0,I.isArray)(e.apply)&&e.apply.every((e=>"submit"in e&&(0,I.isString)(e.submit))))&&((0,I.isString)(t.promo)||(0,I.isString)(t.promo?.selector))&&((0,I.isString)(t.total)||(0,I.isString)(t.total?.selector))}async getConfigs(){return Qi.get("caa",!0)?Rc(this.load(),[]):[]}async match({url:e,storeId:t}){if(Fs(e))return[];e=e.substring(0,200);return(await this.getConfigs()).filter((n=>(!t||n.storeId===t)&&[].concat(n.url).find((t=>new RegExp(t,"i").test(e)))))}parse(e){const t=e=>{try{return new RegExp(e),!0}catch(e){return!1}};return e?.coupons?.length?(e.coupons.forEach((e=>{const n=[].concat(e.url);e.url=n.map((e=>e.replace(/\.\*$/,"").replace(/^\.\*/,"").replace(/([a-zA-Z\d])\.([a-zA-Z\d])/g,"$1\\.$2"))).filter(t)})),e.coupons.filter((e=>e.url.length>0))):[]}};class Oc{constructor(){const e=le.get("domain").replace(/(?:www)?/,"").replace(/\./g,"\\.");this.config=[{matchPattern:e,reward:{ttn:{selector:"meta[name=trackingTicket]",attribute:"content"},amount:{selector:"meta[name=rewardAmount]",attribute:"content"},display:{selector:"meta[name=rewardType]",attribute:"content"},range:{selector:"meta[name=rewardRange]",attribute:"content"},interstitialType:{selector:"meta[name=interstitialType]",attribute:"content"}}},{matchPattern:"\\.shopstyle(?:qa)?\\.com\\/\\w+\\/(?:loadRetailerProductPage|apiVisitRetailer)",defaults:{display:"Percentage",partner:"ShopStyle",sessionInterval:6048e5},reward:{ttn:{selector:"meta[name=trackingTicketNumber]",attribute:"content"},amount:{selector:"meta[name=rewardAmount]",attribute:"content"},display:{selector:"meta[name=rewardType]",attribute:"content"},range:{selector:"meta[name=rewardRange]",attribute:"content"}}},{matchPattern:"\\/\\/shopping\\.yahoo\\.com\\/rd\\?.*?providerId=rkt",defaults:{display:"Percentage",partner:"Yahoo"},reward:{ttn:{selector:'div[class^="Cashback__TrackingInfo-"]',rx:"#(\\d+)"},amount:{selector:'div[class^="Cashback__CashbackInfo-"]',rx:"(.*?)%"}}}]}get(e){return this.config.find((({matchPattern:t})=>e.search(t)>=0))}}const Bc="similar-stores-exclusions-list";let Nc;async function jc(e){const t=await async function(e){Nc||(Nc=await self.EBATES.feed.similarStoresFeed.loadData());const t=Nc?.find((t=>t.domains.includes(e)));return t||null}(e);if(!t)return null;const n=await async function(e){const t=await self.EBATES.merchants.getStores({storeIds:e});return t.filter(Boolean).filter((e=>e.offers_cb))}(t.similarStores);return{stores:n.filter((e=>e.offers_cb)).slice(0,4),storeDomain:e,eyebrow:t.eyebrow,headline:t.headline,additionalText:t.additionalText}}const Uc=new class{constructor(){b.extension.attachEvent("setSimilarStoreExclusion",(({data:e})=>{this.setStoreExclusion(e.domain)}))}async fetch(e){return jc(e)}async initStoreExclusions(){this.exclusionsList||(this.exclusionsList=await qi.get(Bc)||new Map),this.exclusionsList?.forEach(((e,t)=>{e+18e5<Date.now()&&this.exclusionsList?.delete(t)})),qi.set(Bc,this.exclusionsList)}async hasStoreExclusion(e){return!!e&&(await this.initStoreExclusions(),this.exclusionsList?.has(e))}async setStoreExclusion(e){e&&(await this.initStoreExclusions(),this.exclusionsList?.set(e,Date.now()),qi.set(Bc,this.exclusionsList))}};async function Fc(){const e=await b.extension.getItem("blacklist");if(Array.isArray(e)){const t=await async function(e){if(!e.length)return;await self.EBATES.merchants.ready();const t=[];for(const n of e){const e=we(n),r=EBATES.merchants.domains.where({topDomain:e}).map((e=>e.get("storeId")));t.push(...r)}return t}(e);self.EBATES.settings.userSettings.save({notificationExcludedStores:t}),b.extension.setItem("blacklist")}}const $c=zs.extend({key:"cart_notifications",defaults:{activation:!0,caa:!0,ccch:!0,ccps:!1,bonus:!0}}),qc=zs.extend({key:"settings",defaults:{abandonedProductsReminder:!0,postPurchaseMessage:!0,desktopNotifications:{cashBack:!0},ccHover:0,disabledTieredStores:[],notificationExcludedStores:[],rabExcludedStores:[],reportingEnabled:!0,postInstallPopup:!1,loggingDisabled:!1,boostSerpBannerLastVisit:0,progressiveEducation:{ReminderHover:!0,ConfirmHover:!0,UpToCB:!0,CouponMagic:!0,SERPinjections:!0,SERPinjectionsClickable:!0,PriceMagic:!0,PriceMagicButton:!0,PriceMagicSearch:!0,RAB:!0,RABinactive:!0,RafProductPagePopover:!0,BackgroundActivation:!0}},initialize(){this.once("sync",(()=>{Fc()})),this.on({sync:function(){const e={...this.defaults.progressiveEducation,...this.get("progressiveEducation")};this.save({progressiveEducation:e}),this.has("installedTimestamp")||this.save({installedTimestamp:Date.now()})},"change:isDoNotShareActive":()=>{const e=_();b.extension.setItem("uiid",e),self.EBATES.segment.anonymousId=e},"change:logging change:isDoNotShareActive change:anonymousLogging":()=>this.toggleLogging()}),b.extension.attachEvent("getBrowserNotificationPermission",(({data:e})=>this.requestPermission(e))),b.extension.attachEvent("blacklist-update",(({data:e})=>this.blacklistUpdate(e))),Qi.on("change:dataDogLogging",(()=>this.toggleLogging())),Qi.on("change:segmentLogging",(()=>this.toggleLogging())),Qi.on("change:fillr",(()=>this.toggleLogging())),b.extension.attachEvent("updateProgressiveEducation",(({data:e})=>this.updateProgressiveEducation(e)))},updateProgressiveEducation(e){e&&this.save({progressiveEducation:{...this.get("progressiveEducation"),...e}})},blacklistUpdate({storeId:e,exclude:t,property:n}){if(!e||"boolean"!=typeof t||void 0===!n||!["notificationExcludedStores","rabExcludedStores"].includes(n))return;const r=this.get(n)??[],i=new Set(r);t?i.add(e):i.delete(e),this.save({[n]:Array.from(i)})},toggleLogging(){const e=self.EBATES.member.isExtensionDisabled(),t=self.EBATES.member.id?!0===self.EBATES.member.get("isDoNotShareActive"):this.get("isDoNotShareActive"),n=Qi.variation("dataDogLogging",!0),r=Qi.variation("segmentLogging",!0),i="opt_out"===this.get("logging")||"pending"===this.get("logging")||e,s="opt_out"===this.get("anonymousLogging")||"pending"===this.get("anonymousLogging")||e,o=i||t;self.EBATES.segment.loggingDisabled=o||!r,self.EBATES.holistic.loggingDisabled=o,this.set("loggingDisabled",o),$i.logger.setHandler(!n||s||t?"silent":"http")},resetProgressiveEducation(){this.set("progressiveEducation",this.defaults.progressiveEducation)},async requestPermission(){EBATES.contentRunner.page?.injectContentScripts(),b.extension.fireEvent("permission-request-backdrop",{data:"show",tabId:b.browser.CURRENTTAB});try{const e=await n().permissions.request({permissions:["notifications"]});b.extension.fireEvent("permission-request-backdrop",{data:"hide"}),e?(this.save({notificationsEnabled:"granted"}),new mc({type:"permission",title:"Desktop notifications are now on!",text:"We'll let you know whenever Cash Back is placed in your account.",url:ge(le.get("WEB_REWARDS")),cta:"See Cash Back Activity",desktop:!0,entity:"Opt-in"}).render()):this.save({notificationsSuspended:Date.now(),notificationsEnabled:"rejected"})}catch(e){}}}),Hc=Ws.extend({url:()=>le.get("SETTINGS_URL"),key:"config-settings",checkoutNotifications:new $c,priceMagic:new class{properties={affiliatizedLinks:[".popshops.com/","c.affil.walmart.com/"],thresholdAmount:5,excludedDomains:[],partnerDomains:[],exclusions:[],messages:[]};domains=new Ic;constructor(){b.extension.attachEvent("getSimilarMultipleProducts",(async({data:e})=>{const{products:t,canonical_url:n,domainName:r,storeName:i}=e;kc=this.properties;const s=new Cc({canonical_url:n,domainName:r,storeName:i});try{const e=await s.fetchBulk(t);return{url:s.bulkUrl,products:e,requestId:s.requestId}}catch(e){const{response:t}=e;let n="",r=null;try{n=await t.text(),r=JSON.parse(n)}catch(e){}return{url:s.bulkUrl,...r?.apiHeader?{message:"Request failed",details:r.apiHeader.message}:{message:"API error",xhr:n}}}})),b.extension.attachEvent("getSimilarProducts",(async({data:e})=>{const{query:t,canonical_url:n,domainName:r,isLuxury:i}=e,s=t.storeName;kc=this.properties,t.term&&!t.title&&(t.title=t.term,delete t.term);const o=new Cc({canonical_url:n,domainName:r,query:t,storeName:s,isLuxury:i});try{const t=await o.fetch();return t?{url:o.url,product:t,error:!1,requestId:o.requestId}:{url:o.url,error:!0,message:"0 results found",status:0,details:e.term}}catch(e){const{response:t}=e;let n="",r=null;try{n=await t.text(),r=JSON.parse(n)}catch(e){}return{url:o.url,...r?.apiHeader?{message:"Request failed",details:r.apiHeader.message}:{message:"API error",xhr:n}}}})),b.extension.attachEvent("saveVisitedProduct",(async({data:e})=>{if(Qi.variation("pmSaveProducts",!1)){const t=await qi.get("visited-products")||[];this.cleanUpProducts(t);const n=e.product,r=t.findIndex((({product:e})=>n.sku&&e.sku?e.sku===n.sku:n.upc&&e.upc?e.upc===n.upc:e.title===n.title));r>-1&&t.splice(r,1),t.unshift(e),qi.set("visited-products",t.slice(0,1e3))}}))}set(e){Object.assign(this.properties,e)}get(e){return e?this.properties[e]:this.properties}toJSON(){return this.properties}cleanUpProducts(e){const t=Date.now()-7776e6;for(let n=e.length-1;n>=0;n--){e[n].ts<=t&&e.splice(n,1)}}},userSettings:new qc,similarStores:Uc,reclaim:new class{constructor(){this.storage=new ec,Ya?.runtime.onMessage.addListener(this.addListeners.bind(this))}addListeners(e,t,n){switch(e.name){case"reclaimGetPluginState":{Za.log("GET_PLUGIN_STATE_MESSAGE_EVENT",e);const{key:t}=e.state||{};if(!t)return n(null),!0;this.storage.get(t).then((e=>{Za.log("Stored state for "+t,e),n(e)}));break}case"reclaimSavePluginState":{Za.log("SAVE_PLUGIN_STATE_MESSAGE_EVENT",e);const t=e.state?.key,r=e.state?.value;if(!t||!r)break;this.storage.get(t).then((e=>{const i={...e?.value,...r};this.storage?.set(t,i).then((()=>{Za.log(`Updated storage state for ${t}`,i),n(i)}))}));break}case"reclaimCheckCookie":{const{key:t,value:r}=e.state||{};if(!t||!r)break;Ya?.cookies.getAll({name:t,domain:r}).then((e=>{const t=!!e?.length;if(t){const t=e[0];Ya?.cookies.remove({name:t.name,url:`https://${t.domain}`,storeId:t.storeId}).then((e=>{Za.log("Cookie Removed",e)}))}n(t)}));break}}return!0}},serp:[],iscb:[],UPDATE_INTERVAL:108e5,ERROR_UPDATE_INTERVAL:3e5,defaults:{activityUpdateInterval:108e5,activationInterval:1e4,serpEnabled:!0,competitorDomains:["shopathome.com","shopstyle.com","dealmoon.com","mrrebates.com","retailmenot.com","dealsplus.com","jet.com","capitaloneshopping.com","honey.io","joinhoney.com"],standDownDomains:[],contentBlackList:[],travelStores:[],interruptBlackList:[],sharedPages:[],groupon:{},deskNotificationReqFreq:2592e6,messageExpires:12096e5,reportingUpdateInterval:108e5,rewardsExpire:864e5,pendingDeletionTemplate:`<h2>Your Account Deletion is Pending</h2>\n\t\t<p>You requested an account deletion. You can check the status of your request by clicking below. You may also wish to remove Rakuten from your browser extensions.</p>\n\t\t<a href="#" data-href=${ge(le.get("SHELL_PAGE"))} class="btn">Check Deletion Status</a>`,confirmationTimeout:{default:5e3,background:7e3,deal:1e4,threshold:500}},parseResponse(e){if(!e)return;this.checkoutNotifications.set(e.checkoutNotifications),this.affiliates.suppresses.set(e.paidLinks),e.paidLinkPatterns&&this.affiliates.suppresses.add((0,I.map)(e.paidLinkPatterns,(e=>new RegExp(e))));const t=e.betterChoices||e.priceMagic;t&&this.priceMagic.set((0,I.omit)(t,"domains")),e.installed_extensions&&this.installedExtensions&&(this.installedExtensions.set(e.installed_extensions),this.installedExtensions.save()),this.serp=e.serp,this.iscb=e.iscb,this.domains=(0,I.map)(e.domains,(function(e){return e.track_events=!0,e})),e.promos&&!1===Qi.variation("customPromos",!1)&&this.promos.set(this.promos.parse({promos:[...e.promos,...e.campaigns]})),this.set((0,I.omit)(e,"paidLinks","serp","domains","optout","promos","campaigns","betterChoices","priceMagic","checkoutNotifications","installed_extensions"))},parse(e){this.parseResponse(e),this.trigger("sync-data",e),EBATES.merchants.syncSettingsDomains()},initialize(...e){return this.promos=new yc,this.affiliates=new Dc,this.interstitialConfig=new Oc,this.coupons=Lc,this.featureFlags=Qi,Qi.on("change:customPromos",(e=>e&&this.promos.fetch())),b.browser.isChrome&&(this.installedExtensions=new Pc),this.on({"change:activityUpdateInterval":function(e,t){EBATES.member.activity?.setUpUpdate(t)}}),b.extension.attachEvent("settings",(({data:e},t)=>{e&&(this.userSettings.save(e),b.extension.fireEvent("updateSettings",{tabId:b.browser.ALLTABS,data:e})),EBATES.merchants.ready().then((()=>{t(this.toJSON())}))})),Ws.prototype.initialize.apply(this,e)},load(){return Promise.all([this.featureFlags.sync(),this.promos.fetch(),this.userSettings.fetch()]).catch((e=>{}))},toJSON(...e){const t=this.userSettings.toJSON(),n=self.EBATES.member.get("tcpp")?.length&&self.EBATES.member.get("tcpp")[0];return Qi.variation("progressiveEducation",!0)||(t.progressiveEducation={}),(0,I.extend)(t,zs.prototype.toJSON.apply(this,e),{checkoutNotifications:this.checkoutNotifications.toJSON(),serp:this.serp,priceMagic:this.priceMagic.toJSON(),promos:this.promos.toJSON(),user_id:self.EBATES.member.id,ebToken:self.EBATES.ebToken,iscb:this.iscb,extensionDisabled:self.EBATES.member.isExtensionDisabled(),tcpp:n,featureFlags:Qi.toJSON(),isOffline:0===self.EBATES.merchants.length,toolbarId:self.EBATES.toolbarId,isFeedPreviewMode:!!self.EBATES.feed.previewToken,region:le.region,config:le.getAll(),visitId:self.EBATES.visitId})}}),Wc={get neutral(){return ae.get("buttonTitles.neutral")},get activated(){return ae.get("buttonTitles.activated")},get available(){return ae.get("buttonTitles.available")}};let Gc=null;const Vc=32,zc=32,Jc=3.3,Kc=5,Yc=11,Xc=8.75;class Zc{cacheImagesloading=!1;cachedAnimation=new Map;Images=new Map;animationIndex=Kc;loopIndex=0;constructor(){this.context=this.getContext(),this.load(),self.setInterval((()=>this.load()),108e5),b.browser.attachEvent(b.browser.DOCUMENTCOMPLETE,this.handlePage.bind(this)),b.browser.attachEvent(b.browser.TABCHANGED,this.handlePage.bind(this)),b.extension.attachEvent("merchant.state:change",this.handlePage.bind(this))}getContext(){return"undefined"!=typeof OffscreenCanvas?new OffscreenCanvas(Vc,zc).getContext("2d"):function(e,t){const n=document.createElement("canvas");return n.setAttribute("width",`${e}`),n.setAttribute("height",`${t}`),document.body.appendChild(n),n}(Vc,zc).getContext("2d")}async cachePromoImage(e){if(self.EBATES){const t=self.EBATES.settings.promos.get("icons");if(t&&t.get("active")&&t.get(e))return this.fetchImage(t.get(e))}return Promise.reject()}async fetchImage(e){const t=await fetch(e);if(!t.ok)throw new Error(t.statusText);const n=await t.blob();return createImageBitmap(n)}async cacheImage(e){try{return await this.cachePromoImage(e)}catch{return this.fetchImage(e)}}reloadCachedImages(){return this.cacheImagesloading?new Promise((e=>{self.setTimeout((()=>this.reloadCachedImages().then(e)),100)})):(this.cacheImagesloading=!0,Promise.all([this.cacheImage("/img/rakuten/icon-32.png"),this.cacheImage("/img/rakuten/icon-32-activated.png"),this.cacheImage("/img/rakuten/icon-32-notactivated.png")]).then((([e,t,n])=>{this.cachedAnimation=new Map,this.Images.set("neutral",e),this.Images.set("activated",t),this.Images.set("available",n)})).catch((()=>{self.setTimeout((()=>{this.reloadCachedImages()}),6e4)})).then((()=>{this.cacheImagesloading=!1})))}animate(e,t){if(!this.context)return;let n=this.cachedAnimation.get(e);if(n||(n=new Map,this.cachedAnimation.set(e,n)),!n.get(t)){this.context.clearRect(0,0,Vc,zc),"neutral"!==e&&(this.context.setLineDash([0]),"activated"===e?(this.context.lineWidth=2,this.context.strokeStyle="#4990e2",this.context.fillStyle="#FFF"):"available"===e&&(this.context.lineWidth=2,this.context.fillStyle="#ee5051",this.context.strokeStyle="#ee5051"),this.context.roundRect(16-t*Jc/2,16-t*Jc/2,t*Jc,t*Jc,{upperLeft:4,upperRight:4,lowerLeft:4,lowerRight:4},!0));try{this.context.drawImage(this.Images.get(e),0,0,Vc,zc),n.set(t,this.context.getImageData(0,0,Vc,zc))}catch(e){}}return{imageData:{32:n.get(t)}}}next({type:e,count:t}){if(++this.animationIndex>=Yc&&(this.animationIndex=Kc,this.loopIndex++),t&&this.loopIndex>t&&this.animationIndex>=Xc)return this.loopIndex=0,this.stop(e);Qc(this.animate(e,this.animationIndex)),eu(Wc[e])}play({type:e,count:t=0}){this.stop(),eu(Wc[e]),Gc=self.setInterval((()=>this.next({type:e,count:t})),100)}stop(e){Gc&&(self.clearInterval(Gc),Gc=null),this.animationIndex=Kc,this.loopIndex=0,e&&(Qc(this.animate(e,Xc)),eu(Wc[e]))}async load(){return await this.reloadCachedImages(),this.stop("neutral")}async handlePage(e){if(!self.EBATES||self.EBATES.member.isExtensionDisabled())return void this.stop("neutral");if(e.name===b.browser.DOCUMENTCOMPLETE&&!e.active)return;const t=await Ks.getActive(),n=e.url||t.url,r=e.tabId||t.tabId;if(n?.startsWith("http")&&!Fs(n)){const e=self.EBATES.merchants.match(n,r);if(await(e?.isEligibleForIconAnimation())){const t=e.session;if(t.get("activated"))return void(t.get("notificationHover")?this.play({type:"activated",count:2}):this.stop("activated"));if(!self.EBATES.settings.affiliates.state(r).suppress)return this.play({type:"available",count:4})}}this.stop("neutral")}}async function Qc(e){if(e)try{const t=n().action?n().action:n().browserAction;await t.setIcon(e)}catch(e){}}function eu(e){return b.ui.button.setTitle(e)}async function tu(e){try{const t=await zi(ge(k.URL_SHORTENER),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","Client-Agent":"button"},body:JSON.stringify({url:e})});return t?.data?.url_path??null}catch{return null}}OffscreenCanvasRenderingContext2D.prototype.roundRect=function(e,t,n,r,i,s,o){const a={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0};void 0===o&&(o=!0),"object"==typeof i&&Object.keys(i).forEach((e=>{Object.prototype.hasOwnProperty.call(a,e)&&(a[e]=i[e])})),this.beginPath(),this.moveTo(e+a.upperLeft,t),this.lineTo(e+n-a.upperRight,t),this.quadraticCurveTo(e+n,t,e+n,t+a.upperRight),this.lineTo(e+n,t+r-a.lowerRight),this.quadraticCurveTo(e+n,t+r,e+n-a.lowerRight,t+r),this.lineTo(e+a.lowerLeft,t+r),this.quadraticCurveTo(e,t+r,e,t+r-a.lowerLeft),this.lineTo(e,t+a.upperLeft),this.quadraticCurveTo(e,t,e+a.upperLeft,t),this.closePath(),o&&this.stroke(),s&&this.fill()};let nu=Us.Model.extend({defaults:{badgeColor:"#EF5A4E",shown:!1}});const ru=Vs.extend({key:"overlays",model:nu,initialize(){this.fetch().then((()=>{let e=this.get("smart-cards");e&&e.set({shown:!0})})),this.on("add remove change:shown",(()=>{let e=this.where({shown:!1}).length;EBATES.badge.update("overlay",e)}))}});function iu(e){return e.toLowerCase().trim()}function su(e){return/[^a-zA-Z0-9 ]/.test(e)?e.replace(/[^a-zA-Z0-9 ]/g,"").replace(/\s+/g,"").trim():e}let ou=Us.Collection.extend({}),au=Us.Model.extend({idAttribute:"offerId",activate(e){return new Promise(((t,n)=>{zi(Hi(ge(k.MEMBER_ISCB_LINKED),{offerId:this.id,cardId:e,store_id:this.get("store")?this.get("store").id:null}),{method:"POST"}).then((()=>{this.set({linkedCardIds:(0,I.union)(this.get("linkedCardIds"),[e]),cardIds:(0,I.without)(this.get("cardIds"),e)}),t()}),(()=>{n()}))}))},toJSON(){let e=e=>{let t=this.collection.cardDictionary.get(e);return t?t.toJSON():null},t=this.get("store")?this.get("store").id:null,n=t?EBATES.merchants.get(t):null;return(0,I.extend)(Us.Model.prototype.toJSON.apply(this,arguments),{merchant:n?n.toJSON():null,cards:(0,I.map)(this.get("cardIds"),e),linkedCards:(0,I.map)(this.get("linkedCardIds"),e),description:this.get("description")?this.get("description").replace(/^Earn Cash Back/,""):""})}});const cu=Hs.extend({key:"stores/isc",dynamic:!1,model:au,cardDictionary:new ou,url:()=>ge(k.MEMBER_ISCB),UPDATE_INTERVAL:108e5,initialize(){return b.extension.attachEvent("ISC-activate",(async(e,t)=>{t(await this.activateOffer(e.data))})),Hs.prototype.initialize.apply(this)},async getOffers({name:e}){if(!EBATES.loggedIn||!EBATES.member.has("accessLevel"))return null;await this.fetch();try{let t=this.find((t=>function(e,t,n){const r=iu(e.name),i=iu(t);if(su(r)===su(i))return!0;{const r=n||self.EBATES.merchants?.get(e.id)?.get("storeNamePattern");if(r&&new RegExp(`^${r}$`,"i").test(t))return!0}return!1}(t.get("store"),e)));return t?.toJSON()}catch(e){}},async activateOffer({offerId:e,cardId:t}){const n=this.get(e);if(n)try{return await n.activate(t),{offer:n.toJSON(),cardId:t}}catch(e){return{error:"Oops. We weren't able to enable this card for In-Store Cash Back. Please try again later",cardId:t}}},parse(e){return this.cardDictionary.reset(e.cardDictionary),(0,I.filter)(e.offers,(e=>!e.dateLinked))}});function uu(e){return Number.isFinite(e)?Math.round(100*e)/100:0}const lu=new class extends Zi{_id="notification-domains";UPDATE_INTERVAL=216e5;constructor(){super()}get url(){return ge(k.SETTINGS_NOTIFICATION_DOMAINS)}};class du extends Zi{_id="abandoned-products";UPDATE_INTERVAL=18e5;latestApiCall="";products={filtered:[],suppressed:[]};reminder=new hu;get url(){const e=24*Qi.variation("cartAbandonmentInterval",14)*60*60*1e3,t=new Date(Date.now()-e).toISOString(),n=Hi(ge(k.ABANDONED_PRODUCTS),{from_timestamp:t,get_full_product:!0,remove_qualifications:!0});return this.latestApiCall=n,n}constructor(){super(),this.on("sync",(()=>{Qi.variation("myCartTab")&&!self.EBATES.settings.userSettings.get("myCartTab")&&this.getData()?.length&&self.EBATES.settings.userSettings.save({myCartTab:!0})})),b.extension.attachEvent("hasAbandonedProducts",(async()=>{try{const e=await this.load();return e?.length>0}catch{return!1}})),b.extension.attachEvent("getAllAbandonedProducts",(async()=>{try{const e=await this.load();return await this.updateMerchants(e),this.sortByTimestamp(e)}catch{return[]}}))}sortByTimestamp(e=[]){return e.sort(((e,t)=>t.abandonedTimestamp-e.abandonedTimestamp))}async updateMerchants(e){if(e&&Array.isArray(e)){const t=(0,I.uniq)(e.map((e=>e.merchant.storeId)));await self.EBATES.merchants.rates.default.fetch((0,I.uniq)(t)),e.forEach((e=>{const t=self.EBATES.merchants.get(Number(e.merchant.storeId))?.toJSON();e.merchant=(0,I.pick)(t,"storeId","storeName","reward","affiliatizerEnabled","offers_cb","images")}))}}async getCache(){return await this.readCache(),this.getData()??[]}parse(e){return e.data.map((e=>{const t=e.product_data;if(!t)return null;const n=e.product_data_at_abandonment.fillr_product_data,r=e.product_data_at_abandonment.rakuten_product_data,i=Number(e.store_id);let s=self.EBATES.merchants.get(i);if(!s||!s.isButtonMerchant())return null;s=s.toJSON();const o=r?.cash_back_rate_during_abandonment?r?.cash_back_rate_during_abandonment[0]?.reward:null,a=parseFloat(t.list_price),c=parseFloat(t.sale_price);return{id:e.product_id,title:t.title,brandName:t.brand_name,listPrice:a,salePrice:c,discount:uu(a-c),category_ids:r.category_ids,category_id:r.category_id,imageUrl:(l=t.image_url,Wi(l,{_ex:"152x152"})||(u=r.image_url,0===u?.search(/^https:\/\//)?u:"")),productUrl:n.product_url,abandonedTimestamp:new Date(e.assumed_abandoned_timestamp).getTime(),eligibleForCashBack:t.eligible_for_cash_back,previous_ca_tracking_ticket:e.shopping_trip_id,merchant:(0,I.pick)(s,"storeId","storeName","reward","affiliatizerEnabled","offers_cb","images"),isSuppressed:!1,...o&&{previousReward:{amount:o.display_amount,display:o.display_type}}};var u,l})).filter(Boolean)}}class hu{_id="abandoned-products-reminder";domains=[];eligibleDomains=[];cache={};maxDailyShowingCount=5;timeoutAfterDisplay=1800;periodAfterAbandonment=3600;constructor(){qi.get(this._id).then((e=>{e&&(this.cache=e),this.cleanUpDiscardedProducts()})),b.extension.attachEvent("getReminderProduct",(async()=>{if(!Qi.variation("cartAbandonment")||!self.EBATES.member.id)return{};if(this.maxDailyShowingCount=Qi.variation("cartAbandonmentToastMaxDailyShowingCount",this.maxDailyShowingCount),this.timeoutAfterDisplay=Qi.variation("cartAbandonmentToastTimeoutAfterDisplay",this.timeoutAfterDisplay),this.periodAfterAbandonment=Qi.variation("cartAbandonmentToastPeriodAfterAbandonment",this.periodAfterAbandonment),await this.isEligibleForShow()){const e=await this.getProducts(),{showingCounters:t}=this.cache||await qi.get(this._id)||{};return{product:e[0],showingCounters:t}}return{}})),b.extension.attachEvent("getProductsPostPurchase",(async()=>{if(!Qi.variation("cartAbandonment")||!self.EBATES.member.id)return[];try{let e=await self.EBATES.member.abandonedProducts.load();return await self.EBATES.member.abandonedProducts.updateMerchants(e),self.EBATES.member.abandonedProducts.sortByTimestamp(e),await this.cleanUpDiscardedProducts(),e=await this.filterDiscardedProducts(e),e}catch{return[]}})),b.extension.attachEvent("discardProduct",(async({data:e})=>{let{discardedProducts:t}=this.cache||await qi.get(this._id)||{};t=t||{},t[e.productId]||(t[e.productId]={timestamp:Date.now()}),this.saveCache({discardedProducts:t})})),b.extension.attachEvent("updateShowingInfo",(async({data:e})=>{let{showingCount:t,lastShowingTimestamp:n,showingCounters:r}=this.cache||await qi.get(this._id)||{};t=fc()().format("DD/MM/YYYY")!==fc()(n).format("DD/MM/YYYY")?1:(t||0)+1,r=r||{};const i=r[e.type]||0;r[e.type]=(i+1)%3,this.saveCache({showingCount:t,showingCounters:r,lastShowingTimestamp:Date.now()})}))}saveCache(e){this.cache={...this.cache,...e},qi.set(this._id,this.cache)}clearCache(){this.cache={},qi.set(this._id,this.cache)}async cleanUpDiscardedProducts(){const e=24*Qi.variation("cartAbandonmentInterval",14)*60*60*1e3;let{discardedProducts:t}=this.cache||await qi.get(this._id)||{};t=t||{};let n=!1;for(const r in t)t[r].timestamp<Date.now()-e&&(delete t[r],n=!0);n&&this.saveCache({discardedProducts:t})}async getProducts(){const e=await self.EBATES.member.abandonedProducts.getCache().catch((()=>{}))||[],t=(0,I.uniq)(e,(e=>e.merchant.storeId)).map((e=>e.merchant.storeId));await self.EBATES.merchants.rates.default.fetch(t);const n=await self.EBATES.member.abandonedProducts.load().catch((()=>{}))||[];if(Array.isArray(e)&&Array.isArray(n)){const t=this.getProductsWithSavings(e,n);await this.cleanUpDiscardedProducts();let r=t.filter((({merchant:e,eligibleForCashBack:t})=>e.offers_cb&&t));return r=await this.filterDiscardedProducts(r),r=this.filterByPeriod(r,1e3*this.periodAfterAbandonment),r.sort(((e,t)=>e.savingsAmount>t.savingsAmount?-1:1)),r}return[]}calcSavingsAmount(e){const t=e.merchant.reward,n=!t||t.range&&t.amount?0:Ec(t,e.salePrice);e.cashBackAmount=uu(n);const r=t?Ec(t,e.salePrice):0;e.cashBackAmountTiered=uu(r);let i=0;return e.oldPrice&&(i=parseFloat(e.oldPrice)-parseFloat(e.salePrice)||0),e.priceSavings=uu(i),e.savingsAmount=uu(e.cashBackAmount+e.priceSavings),e}async filterDiscardedProducts(e){const{discardedProducts:t}=this.cache||await qi.get(this._id)||{};return e.filter((({id:e})=>!t?.[e]))}filterByPeriod(e,t){const n=Date.now()-t;return e.filter((({abandonedTimestamp:e})=>e<n))}getProductsWithSavings(e,t){return t.map((t=>{const n={...t};let r=!1;t.salePrice<t.listPrice&&(n.oldPrice=t.listPrice,r=!0);const i=e.find((({id:e})=>e===t.id));if(i){const e=self.EBATES.merchants.get(t.merchant.storeId)?.getReward();if(e&&n.previousReward&&eo(e,n.previousReward)>0&&(r=!0),t.merchant.reward=e,t.salePrice<i.salePrice){i.salePrice-t.salePrice>t.listPrice-t.salePrice&&(n.oldPrice=i.salePrice,r=!0)}}return r?this.calcSavingsAmount(n):null})).filter(Boolean)}async isEligibleForShow(){const{showingCount:e=0,lastShowingTimestamp:t=0}=this.cache||await qi.get(this._id)||{};if(Date.now()-t<1e3*this.timeoutAfterDisplay)return!1;const n=fc()().format("DD/MM/YYYY");return!(fc()(t).format("DD/MM/YYYY")===n&&e>=this.maxDailyShowingCount)}async isEligibleDomain(e){const t=we(e);if(!t)return!1;let n=[];try{n=await lu.load()}catch{}if(n.some((e=>we(e)===t))){if((await self.EBATES.settings.priceMagic.domains.load()).find((({domainName:e})=>e===t)))return!1;const e=self.EBATES.merchants.domains.findWhere({topDomain:t});return!e||!self.EBATES.merchants.get(e.get("storeId"))?.isButtonMerchant()}return!1}}function fu(e,t){return e.indexOf("[link]")>=0?e.replace("[link]",t):`${e} ${t}`}const gu=ae.get("taf.defaultMessage"),pu=Gs.extend({timeout:108e5,defaults:{referBonusAmount:le.get("DEFAULT_REFER_BONUS_AMOUNT"),referImageToolbar:"/toolbar/images/taf_toolbar@2x.png",referSocialMessage:"",redeemThresholdAmount:le.get("DEFAULT_REDEEM_THRESHOLD_AMOUNT")},url:()=>ge(k.MEMBER_TAF),initialize(...e){return b.extension.attachEvent("getTafSettings",(async({data:e={}},t)=>{const{force:n=!1}=e;EbatesPromise.then((async()=>{try{await this.fetch({force:n})}finally{t(this.toJSON())}}))})),Gs.prototype.initialize.apply(this,e)},toJSON(...e){const t=Gs.prototype.toJSON.apply(this,e);return t.referPageHeader=`Get ${t.referBonusAmount}`,t.referImageToolbar=t.referImageToolbar2x,t},async getTwitterMessage(e,t,n){if(n){const{reward:r,storeName:i}=n;if(t===ks&&Qi.variation("rafStoreShare",!0)&&!r.rakplusTargeted){const t=Qs({...r,range:!0}).toLowerCase();return ae.get("taf.twitter.postPurchase",{cashBack:t,storeName:i,link:e})}}await this.fetch();let r=gu;const i=this.get("referSocialMessage");return i&&i.indexOf("|")>=0?r=i.split("|")[1]:i&&(r=i),fu(r,e)},async getEmailMessage(e,t,n){if(n){const{reward:r,storeName:i}=n;if(t===ks&&Qi.variation("rafStoreShare",!0)&&!r.rakplusTargeted){const t={...r,range:!0},n=ae.get("taf.email.postPurchase.subject",{storeName:i}),s=Qs(t).toLowerCase();return{subject:n,message:ae.get("taf.email.postPurchase.message",{cashBack:s,storeName:i,link:e})}}}await this.fetch();let r=ae.get("taf.defaultSubject"),i=gu;const s=this.get("referEmailMessage");if(s?.indexOf("|")>=0){const e=s.split("|");r=e.shift(),i=e.join("\n")}return i=fu(i,e),{subject:r,message:i}}}),mu="BLOCKED",vu=Ws.extend({key:"geogating",dynamic:!1,UPDATE_INTERVAL:108e5,defaults:{gatingStatus:"UNRESTRICTED"},url:()=>ge(k.MEMBER_GEOGATING),async initialize(...e){return await this.readCache({silent:!0,cache:!0}),this.isBlocked()&&this.switchToBlockedState(),this.on({"change:gatingStatus":async e=>{const t=e.get("gatingStatus");e.previous("gatingStatus")===mu&&t!==mu?(EBATES.settings.userSettings.toggleLogging(),EBATES.segment.track("Change Gating Status",{country_code:e.get("countryCode"),gating_status:e.get("gatingStatus")}),EBATES.settings.userSettings.save({gatingStatusBadge:!0}),await this.switchToNormalState()):e.previous("gatingStatus")!==mu&&t===mu&&(EBATES.segment.track("Change Gating Status",{country_code:e.get("countryCode"),gating_status:e.get("gatingStatus")}),EBATES.settings.userSettings.save({gatingStatusBadge:!0})),t===mu&&this.switchToBlockedState(),EBATES.badge.update()}}),Ws.prototype.initialize.apply(this,e)},switchToBlockedState(){b.ui.button.setPopup(),b.ui.button.attachEvent(b.ui.button.CLICK,this.openGatingWebpageUrl),EBATES.settings.userSettings.toggleLogging()},async switchToNormalState(){b.ui.button.detachEvent(b.ui.button.CLICK,this.openGatingWebpageUrl),await EBATES.validateUserToken()&&b.ui.button.setPopup({url:"./popup.html"})},isBlocked(){return this.get("gatingStatus")===mu},isEnabled:()=>Qi.variation("geogating",!1),parse:e=>e.data,openGatingWebpageUrl(){const e=Hi(EBATES.member.geogating.get("gatingWebpageUrl")||ge(k.BASE),{visit_id:EBATES.visitId});EBATES.settings.userSettings.get("gatingStatusBadge")&&(EBATES.settings.userSettings.save({gatingStatusBadge:!1}),EBATES.badge.update()),EBATES.segment.track("Visit Page",{preceding_screen_name:"Icon",url:e},void 0,{force:!0}),b.browser.navigate(e)}});const yu=new class extends Zi{_id="tracking-tickets";get url(){return ge(k.MEMBER_TICKETS)}parse(e){return(0,I.flatten)(e.tickets)}},bu={USA:"USD",GBR:"GBP"},wu={precision:2,currency:"USD",pending:0,total_amount:null,display_values:{pending:0,confirmed:0}};class Au extends vo{attributes={...wu};constructor(){super("member-balance-account-summary"),this.readCache()}getData(){return this.attributes}parse(e){const{pendingAmount:t,paidAmount:n}=e,r=be(t)&&be(n)?t+n:null;return{precision:2,currency:e.payableAmountCurrencyCode,pending:e.pendingAmount,total_amount:r,display_values:{pending:e.pendingAmount,confirmed:e.payableNowAmount}}}set(e){const t=this.parse(e);return this.attributes={...t},this.save(this.attributes)}async readCache(){const e=await this.load();e&&0!==Object.keys(e).length&&Object.assign(this.attributes,e)}clear(){this.attributes={...wu},this.clearCache()}}class xu extends Zi{_id="member-balance";prevTotalAmount=null;UPDATE_INTERVAL=9e5;isBookkeeperAPIEnabled=!1;balanceAccountSummary=new Au;constructor(){super(),this.on("beforeRequest",(()=>{this.prevTotalAmount=this.getData()?.total_amount??null})),this.on("sync",(()=>{this.updateMessages()})),this.readCache()}get url(){return ge(le.get("MEMBER_BALANCE"))}get headers(){return{accept:"application/json","Client-Agent":"button"}}async checkBookkeeperAPIEnabled(){const e=await xo.get(Ls);!this.isBookkeeperAPIEnabled&&e&&this.balanceAccountSummary.clear(),this.isBookkeeperAPIEnabled=e}async load(e={}){return await this.checkBookkeeperAPIEnabled(),this.isBookkeeperAPIEnabled?super.load(e):(await this.balanceAccountSummary.readCache(),this.balanceAccountSummary.getData())}async set(e){await this.checkBookkeeperAPIEnabled(),this.isBookkeeperAPIEnabled||(this.prevTotalAmount=this.balanceAccountSummary.getData().total_amount,await this.balanceAccountSummary.set(e),this.updateMessages())}getData(){return this.isBookkeeperAPIEnabled?super.getData():this.balanceAccountSummary.getData()}async updateMessages(){if(!("USA"===le.region?Qi.get("pendingAmount",!0):this.isBookkeeperAPIEnabled)||null===this.prevTotalAmount)return;const e=this.getData()?.total_amount;if(be(e)&&e>this.prevTotalAmount){const e=(await yu.load()).find((e=>!!parseFloat(e.memberReward?.amount??"")));e?.storeId&&!EBATES.member.messages.find((t=>t.get("memberReward")&&t.get("memberReward").amount===e.memberReward?.amount))&&(EBATES.merchants?.length?this.addMessage(e):setTimeout((()=>this.addMessage(e)),2e3))}}parse(e){const t=le.region,n=e.data,r=n?.journals?.find((e=>e?.currency===bu[t??"USA"]));if(!r)return{...wu};const{precision:i=2,currency:s,pending:o,total_amount:a,display_values:c}=r;return{precision:i,currency:s,pending:o/Math.pow(10,i),total_amount:a/Math.pow(10,i),display_values:c?{pending:parseFloat(c.pending),confirmed:parseFloat(c.confirmed)}:wu.display_values}}addMessage(e){const{storeId:t,memberReward:n}=e??{},r=EBATES.merchants.get(t),i=r?.get("storeName");if(i){const e=le.get("currency"),r=function(e,t){return Zs().formatMoney(e,t).replace(/\.0+$/,"")}(n.amount,e);EBATES.member.messages.add({memberReward:n,storeId:t,desktop:!!EBATES.settings.userSettings.get("desktopNotifications").cashBack,popup:!0,title:ae.get("messages.title",{rewardAmount:r}),text:ae.get("messages.text",{rewardAmount:r,storeName:i}),type:"cashback",url:ge(le.get("WEB_REWARDS")),cta:ae.get("messages.cta"),entity:"Cash Back Added"})}}clear(){this.clearCache(),this.balanceAccountSummary.clear()}}const Eu=new class extends Zi{_id="milestones";UPDATE_INTERVAL=864e5;constructor(){super(),b.extension.attachEvent("getActiveBoost",(async({data:e})=>{if(!self.EBATES.member.id)return;const{storeId:t}=e;return this.getActiveMilestone(t)})),this.readCache()}get url(){return ge(k.MILESTONES_URL)}get headers(){return{"Client-Agent":"button"}}parse({data:e}){return e.milestones.map((e=>{const t=e.reward_details?.qualification_rules,n=t?.reduce(((e,t)=>{const n=t.milestone_pr_terms_rules?.find((({rule:e})=>e.startsWith("Good until ")));return n&&(e=n.rule.split("Good until ").pop()),e}),null);let r=null;if(n){const e=fc()(n.replace("at ","").replace(/([AP]M)/," $1").replace("PT.","-0700"),"MM/DD/YYYY __ HH:mm A ZZ");e.isValid()&&(r=e.valueOf())}return{...e,termsLink:t?.find((e=>e?.milestone_pr_terms_button_cta))?.milestone_pr_terms_button_cta,termsText:t?.find((e=>e?.milestone_pr_terms_button_text))?.milestone_pr_terms_button_text,reward:parseFloat(e.reward_details?.milestone_pr_value?.match(/(?:\+)(\d+(?:\.\d+)?)(?:%)/g)?.[0]??"0"),expires:r}}))}fetchDataOnSignIn(){if(self.EBATES.member.id)return new Promise((e=>{setTimeout((async()=>{const t=Qi.variation("signupButtonMilestones",{ids:[]}).ids??[],n=Qi.variation("activeButtonMilestones",{ids:[]}).ids??[];t.some((e=>n?.includes(e)))&&await this.load(),e()}),3500)}))}async findAsync(e,t){const n=e.map(t);return e[(await Promise.all(n)).findIndex((e=>e))]}async getActiveMilestone(e=null){const t=Qi.variation("activeButtonMilestones",{ids:[]}).ids??[],n=Qi.variation("signupButtonMilestones",{ids:[]}).ids??[];if(await this.findAsync(t,(async e=>!n.length&&!n.includes(e)&&await xo.variation(`button-milestone-${e}`,!0))))try{await this.load()}catch{}const r=this.getData()??[];return await this.findAsync(r,(async r=>{if(!r.incentive_id||!r.expires||r.expires<Date.now()||!r.reward||"PENDING"!==r.milestone_status)return;if(!t.includes(r.incentive_id))return;if(!n.includes(r.incentive_id)&&!await xo.variation(`button-milestone-${r.incentive_id}`))return;const i=Qi.variation(`milestone${r.incentive_id}ExcludedStores`,{storeIds:[]}).storeIds??[];if(!e||!i.includes(e)){if(e){const t=EBATES.merchants.get({storeId:e})?.getReward();if(!t||"Fixed"===t.display)return;const n=function(e=""){const t=/(\b\d{1,2}(?:\.\d{1,2})?\b)%/.exec(e);return t?parseFloat(t[1]):1}(t.previous);if(t.amount<n+r.reward)return}return r}}))}};const Su=new class extends Zi{_id="eds";get url(){return ge(k.EDS)}parse(e){return e._source}constructor(){super(),b.extension.attachEvent("account-eds",(async()=>Qi.variation("eds",!0)?await this.load():{}))}},Tu=po.extend({key:"deals/top",url:()=>ge(k.DEALS),comparator(e){let t=EBATES.member.favorites.get(e.get("storeId"));return t?(e.set({section:"favorite"}),EBATES.member.favorites.indexOf(EBATES.member.favorites.get(e.get("storeId")))):(t=EBATES.member.purchased.get(e.get("storeId")),t?(e.set({section:"purchased"}),EBATES.member.favorites.length+EBATES.member.purchased.indexOf(t)):(t=EBATES.member.visited.get(e.get("storeId")),t?(e.set({section:"visited"}),EBATES.member.favorites.length+EBATES.member.purchased.length+EBATES.member.visited.indexOf(t)):(e.unset("section"),EBATES.member.favorites.length+EBATES.member.purchased.length+EBATES.member.visited.length+e.collection.indexOf(e))))},fetch(...e){return Promise.all([EBATES.member.favorites.fetch(),EBATES.member.get("accessLevel")>0?EBATES.member.purchased.fetch():null,EBATES.member.visited.fetch()]).catch((()=>{})).then((()=>po.prototype.fetch.apply(this,e)))}}),_u=Us.Model.extend({idAttribute:"storeId"}),ku=fo.extend({key:"stores/favorites",model:_u,url:()=>ge(k.MEMBER_FAVORITES),parse:e=>(0,I.chain)(e.favorites).map((e=>(e.id&&!e.storeId&&(e.storeId=e.id),delete e.id,e))).flatten().value()}),Cu=fo.extend({key:"stores/visited",model:_u,url:()=>ge(k.MEMBER_VISITED),parse:e=>(0,I.chain)(e.stores).map((e=>(e.id&&!e.storeId&&(e.storeId=e.id),delete e.id,e))).flatten().value()}),Iu=fo.extend({key:"stores/purchased",model:_u,url:()=>ge(k.MEMBER_PURCHASED),parse:e=>e.stores}),Pu=Ws.extend({key:"activity",ERROR_UPDATE_INTERVAL:36e5,UPDATE_INTERVAL:108e5,url:()=>ge(k.MEMBER_ACTIVITY),active:()=>Qi.variation("memberActivityUpdates",!0),setUpUpdate(e){(0,I.isNumber)(e)&&e>=6e4&&(this.UPDATE_INTERVAL=e,EBATES.ebToken&&(b.extension.setItem(`${this.key}.nextUpdateTime`,Date.now()+e),this.fetch()))},parse:e=>e.member,sync(...e){return this.active()?Ws.prototype.sync.apply(this,e):Promise.resolve()}}),Mu=Ws.extend({url:()=>ge(k.MEMBER_DETAILS),key:"member",defaults:{rakutenMode:!0},async initialize(e){this.overlays=new ru,this.favorites=new ku,this.visited=new Cu,this.purchased=new Iu,this.topDeals=new Tu,this.balance=new xu,this.geogating=new vu,this.messages=new pc,this.activity=new Pu,this.iscb=new cu,this.tafSettings=new pu,this.abandonedProducts=new du,this.milestones=Eu,this.eds=Su,this.trackingTickets=yu,await this.readCache({cache:!0,silent:!0}),this.identify(),this.get("id")!==e.id&&(this.clearCache(),this.clear(),this.balance.clear()),EBATES.badge.update(),this.on({change:function(e,t){t.unset&&(this.nextUpdateTime=0),(this.hasChanged("id")||this.hasChanged("userStatus"))&&(this.identify(),this.milestones.fetchDataOnSignIn()),this.hasChanged("id")&&this.previous("id")&&(Promise.all([this.activity.fetch({reset:!0,silent:!0}),this.geogating.isEnabled()&&this.geogating.fetch({reset:!0}),this.balance.load({reset:!0})]).catch((()=>{})),this.iscb.stop(),this.favorites.stop(),this.visited.stop(),this.purchased.stop(),this.messages.reset(),EBATES.settings.userSettings.unset("tcppId"),EBATES.settings.userSettings.save(),this.abandonedProducts.clearCache(),yu.clearCache(),Su.clearCache(),EBATES.experiments.clearCache()),EBATES.badge.update()},"change:targetSet":function(e){e.previous("targetSet")&&this.activity.clearCache()},"change:accessLevel":function(e,t){void 0===t?(this.activity.stop(),this.clearCache()):this.activity.fetch({silent:!0}),this.saveCache()},error:function(e,t){[401,403].includes(t.status)&&EBATES.onTokenExpired()},"change:gdprCertificationStatus change:isHardDeleteRequested":e=>{if(EBATES)if(EBATES.settings.userSettings.toggleLogging(),EBATES.badge.update(),EBATES.member.isExtensionDisabled())EBATES.merchants.stop(),EBATES.merchants.reset();else{const t=Object.keys(e.previousAttributes());(t.includes("gdprCertificationStatus")||t.includes("isHardDeleteRequested"))&&EBATES.merchants.fetch()}},"change:isDoNotShareActive":()=>{EBATES&&EBATES.settings.userSettings.toggleLogging()}}),this.listenTo(this.activity,{sync:async e=>{this.set({...e.toJSON(),country_code:await ce(le.get("domain"),"country_code")}),this.saveCache()},"change:lastOrderDate":async e=>{e.previous("lastOrderDate")&&(this.nextUpdateTime=0,this.fetch())}}),b.extension.attachEvent("account",(async({data:e})=>(await self.EbatesPromise,EBATES?.ebToken?e?(this.set(e),this.toJSON()):this.getAccount():null))),b.extension.attachEvent("member.updateEEAMode",(({data:e})=>this.updateEEAMode(e))),b.extension.attachEvent("member.updateTCPP",(({data:e})=>this.updateTCPP(e))),b.extension.attachEvent("member.dismissTCPP",(()=>{EBATES.settings.userSettings.save({tcppDisplayed:Date.now()})})),b.extension.attachEvent("share",(({data:e})=>this.share(e))),b.extension.attachEvent("topDeals",(async({data:e})=>this.getTopDeals(e))),b.extension.attachEvent("createReferralLink",(({data:e})=>this.createReferralLink(e?.siteUrl))),b.extension.attachEvent("createShareLink",(({data:e})=>{const{merchant:t,productTitle:n,productUrl:r}=e;return this.createShareLink(t,n,r)})),b.extension.attachEvent("urlShortener",(async({data:e})=>await tu(e?.url)??e?.url)),b.extension.attachEvent("messages",(async({data:e})=>{if(e?.created){const{created:t,...n}=e,r=this.messages.find((e=>e.get("created")===t));r&&r.set(n)}else await this.messages.flush();return this.messages.toJSON()})),b.extension.attachEvent("overlays",(({data:e})=>(e?.id&&(this.overlays.set(e),this.overlays.save()),this.overlays.toJSON())))},async getTopDeals(e){await this.topDeals.fetch();const t=this.topDeals.toJSON().map((async(t,n)=>{if(t){const r=EBATES.merchants.get(t.storeId).toJSON();if(r?.offers_cb&&r.shoppingURL&&r.activationCode>0&&"X"!==await EBATES.merchants.get(t.storeId).incrementalityTest()&&t.storeId!==e.storeId)return t.coupon_rank=n,t}}));return(await Promise.all(t)).filter(Boolean)},identify(){if(!this.id)return;const e=this.get("shortURLToken"),t=this.get("userStatus"),n=EBATES.settings.installedExtensions?.getInstalledExtensions().toString()||"";self.EBATES.segment.userId=this.id,self.EBATES.segment.identify(this.id,{referral_token:e,user_status:t,installed_extensions:n}),self.EBATES.holistic.setMember({guid:this.id,anonymous_id:self.EBATES.anonymousId}),self.EBATES.experiments.setMember({memberGuid:this.id,anonymousId:self.EBATES.toolbarId.toString()})},async syncBalanceWithAccountSummary(){const e=await xo.get(Ls),t=this.get("accountSummary")??await b.extension.getItem("account");if(!e&&t){const e=(0,I.reduce)(t,((e,t,n)=>(e[n]=Number.isFinite(parseFloat(t))?parseFloat(t):t,e)),{});await this.balance.set(e),this.unset("accountSummary"),b.extension.setItem("account")}},async fetch(e,...t){if(!EBATES.ebToken)throw new Error("User is not logged in");this.has("accessLevel")&&(await Ws.prototype.fetch.apply(this,[e,...t]),await Promise.all([this.geogating.isEnabled()?this.geogating.fetch(e):null,this.balance.load(e)])),await this.syncBalanceWithAccountSummary()},parse(e,t){if(t?.headers){const n=t.headers.get("ResponseLevel");n&&(e.accessLevel=parseInt(n,10),this.getCache().then((t=>{t.data=e,this.setCache(t)})))}return(0,I.defaults)(e,{gdprCertificationStatus:"",targetSet:"",personalizationSet:"",tcpp:null,isAmexUser:void 0})},toJSON(...e){return{...Ws.prototype.toJSON.apply(this,e),ebToken:EBATES.ebToken,balance:this.balance.getData(),tafSettings:this.tafSettings.toJSON(),geogating:this.geogating?.toJSON(),isEEAMode:this.isEEAMode(),isPendingDeletion:this.isPendingDeletion(),isExtensionDisabled:this.isExtensionDisabled()}},updateEEAMode(e){return zi(ge(k.MEMBER_UDPATE_ATTRIBUTE),{method:"POST",contentType:"application/json",dataType:"json",body:JSON.stringify({updateType:"gdpr-certification",updateKey:"eeaResidentStatus",updateValue:e})}).then((()=>{const t="true"===e?"certified-yes":"certified-no";this.set({gdprCertificationStatus:t}),this.saveCache()}))},isEEAMode(){return!!Qi.variation("gdpr",!0)&&["certified-yes","not-certified"].includes(this.get("gdprCertificationStatus"))},isPendingDeletion(){return!0===this.get("isHardDeleteRequested")},isGatingStatusBlocked(){return this.geogating?.isBlocked()&&this.geogating.isEnabled()},isTcppBlocking(){const e=this.get("tcpp");return e?.length&&(e[0].blocking||Qi.variation("tcppBlocking",!1))&&e[0].tcppId!==EBATES.settings.userSettings.get("tcppId")},isExtensionDisabled(){return this.isEEAMode()||this.isPendingDeletion()||this.isGatingStatusBlocked()||this.isTcppBlocking()},updateTCPP(e,t=0){e&&(this.unset("tcpp"),this.saveCache(),EBATES.settings.userSettings.save({tcppId:e.tcppId}),zi(ge(k.MEMBER_UDPATE_TCPP),{method:"POST",contentType:"application/json",body:JSON.stringify({tcppId:e.tcppId,tcppTypeId:e.type_id,acceptedDate:(new Date).toISOString(),deviceInfo:"button"})}).catch((n=>{400!==n.status&&t<10&&setTimeout((()=>this.updateTCPP(e,t+1)),3e5)})))},getDomain:()=>le.get("domain"),getRefId(){const e=this.get("shortUrl");return e.split("/")?.pop()},createShareLink(e,t,n){const{siteUrl:r,storeId:i}=e,s=ge(`${k.BASE}/${r}_${i}-xfas`),o=this.getRefId();return Hi(s,{eeid:As.SHARE_RAF_PRODUCT_PAGE,ref_id:o,product_title:t,product_url:n})},async createReferralLink(e){const t=this.get("shortUrl"),n=this.getRefId(),r=Qi.variation("rafStoreShare",!0);return e&&n&&r?ge(`${k.BASE}/store/${e}?ref_id=${n}`):t},getCashBackDetails:e=>({store_name:e.storeName,store_id:e.storeId,...lo(e.reward)}),async share({method:e,source:t,merchant:n,productTitle:r=null,productUrl:i=null,screen:s}){const o={Email:As.SHARE_EMAIL,Copy:As.SHARE_COPY,Facebook:As.SHARE_FACEBOOK,Twitter:As.SHARE_TWITTER},a=this.get("shortURLToken");let c=o[e];t===ks?c=As.SHARE_POST_PURCHASE_NOTIFICATION:t===Cs&&(c=As.SHARE_RAF_PRODUCT_PAGE);const u=Hi(await this.createReferralLink(n?.siteUrl),{eeid:c}),l=n?this.getCashBackDetails(n):null,d=(this.get("hasReferral")?"has":"never")+" referred";self.EBATES.segment.track("Start Refer A Friend",{share_method:e,eeid:c,source:t,referral_token:a,type:d,...l}),self.EBATES.holistic.track({event:es.ReferAFriendStarted,data:{eeid:c.toString(),method:e,source:t,referrer_type:d}});const h=Qi.variation("rafStoreShare",!0);let f=u;if(t===Cs){const e=await this.createShareLink(n,r,i);f=await tu(e)??u}if(t===ks&&h){const e=await this.createShareLink(n);f=await tu(e)??e}if("Copy"===e)return f;if("Facebook"===e){return me({url:Hi("https://www.facebook.com/dialog/share?",{display:b.browser.isSafari?"page":"popup",app_id:le.get("FACEBOOK_APP_ID"),href:f,redirect_uri:ge("/toolbar/taf/success.htm")}),width:601,height:345,screen:s}),f}if("Twitter"===e){return me({url:Hi("https://twitter.com/intent/tweet?",{text:await this.tafSettings.getTwitterMessage(f,t,n,r)}),width:550,height:400,screen:s}),f}if("Email"===e){const{subject:e,message:i}=await this.tafSettings.getEmailMessage(f,t,n,r),s=`mailto:?subject=${encodeURIComponent(e)}&body=${encodeURIComponent(i)}`;return b.browser.navigate(s),f}throw new Error("Unknown share method")},async getAccount(){try{await this.fetch()}catch(e){}return this.toJSON()}});if(ve){const e=n().runtime.getURL("");self.document={readyState:"completed",getElementsByTagName:()=>[],addEventListener:()=>{},location:{referrer:e,hostname:le.get("domain"),href:e}},self.window={addEventListener:()=>{},TextEncoder:self.TextEncoder,fetch:self.fetch,location:{hostname:le.get("domain"),href:e}},performance.timing={navigationStart:new Date};class t{constructor(){this.method=null,this.url=null,this.status=500,this.listeners={}}open(e,t){this.method=e,this.url=t}addEventListener(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}removeEventListener(e,t){const n=this.listeners[e];if(n){const r=n.filter((e=>e!==t));r&&r.length?this.listeners[e]=r:delete this.listeners[e]}}send(e){let t=e;"object"==typeof e&&(t=JSON.stringify(e)),fetch(this.url,{method:this.method,body:t}).then((e=>{this.status=e.status,Object.keys(this.listeners).forEach((t=>{this.listeners[t].forEach((t=>t(e)))}))})).catch((()=>{}))}}self.XMLHttpRequest=t}const Du={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let Ru;const Lu=new Uint8Array(16);function Ou(){if(!Ru&&(Ru="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Ru))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ru(Lu)}const Bu=[];for(let e=0;e<256;++e)Bu.push((e+256).toString(16).slice(1));function Nu(e,t=0){return Bu[e[t+0]]+Bu[e[t+1]]+Bu[e[t+2]]+Bu[e[t+3]]+"-"+Bu[e[t+4]]+Bu[e[t+5]]+"-"+Bu[e[t+6]]+Bu[e[t+7]]+"-"+Bu[e[t+8]]+Bu[e[t+9]]+"-"+Bu[e[t+10]]+Bu[e[t+11]]+Bu[e[t+12]]+Bu[e[t+13]]+Bu[e[t+14]]+Bu[e[t+15]]}const ju=function(e,t,n){if(Du.randomUUID&&!t&&!e)return Du.randomUUID();const r=(e=e||{}).random||(e.rng||Ou)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return Nu(r)};var Uu=i(41169),Fu=i.n(Uu),$u=i(65905),qu=i.n($u),Hu=i(85030),Wu=i.n(Hu);const Gu="webextensionsAnalytics",Vu=()=>{};class zu{anonymousId="";userId="";defaultContext={};defaultProperties={};storage={sessionId:null,sessionTimestamp:null,queue:[]};flushed=!1;timer=null;constructor(e,{host:t="https://api.segment.io",timeout:n=0,flushAt:r=20,flushInterval:i=1e4,context:s={},properties:o={},enable:a}={}){this.writeKey=e;this.host=t.replace(/\/$/,""),this.timeout=n,this.flushAt=Math.max(r,1),this.flushInterval=i,this.defaultContext=s,this.defaultProperties=o,this.enable="boolean"!=typeof a||a,this.init()}async init(){await this.getStorage(),this.storage.sessionTimestamp&&Date.now()>this.storage.sessionTimestamp+18e5&&this.endSession(),Wu().alarms&&Wu().alarms.onAlarm.addListener((e=>{e.name===`${Gu}.sessionTimeout`&&this.endSession()}))}set(e){Object.assign(this.defaultProperties,e)}setKey(e){this.writeKey=e}setHost(e){this.host=e}setEnable(e){this.enable=e}async getStorage(){const e=await Wu().storage.local.get(Gu);if(e&&e[Gu]&&Object.keys(e[Gu]).length){const{queue:t,...n}=e[Gu];Object.assign(this.storage,n),Array.isArray(t)&&(this.storage.queue=t)}}setStorage(){const e={...this.storage};e.queue=e.queue.map((({...e})=>(delete e.callback,e))),Wu().storage.local.set({[Gu]:{...e}})}startSesssion(e){this.storage.sessionId=e,this.setStorage()}endSession(){this.storage.sessionId&&(Wu().alarms&&Wu().alarms.clear(`${Gu}.sessionTimeout`),clearInterval(this.sessionTimeout),this.storage.sessionTimestamp=null,this.storage.sessionId=null,this.setStorage())}validateSession(){const e=(new Date).getTime();if(clearInterval(this.sessionTimeout),!this.storage.sessionId)try{this.startSesssion(e)}catch(e){}this.storage.sessionId&&(Wu().alarms?Wu().alarms.create(`${Gu}.sessionTimeout`,{delayInMinutes:30}):(this.sessionTimeout=setInterval((()=>this.endSession()),18e5),this.storage.sessionTimestamp=e,this.setStorage()))}reset(){this.flush(),this.userId="",this.anonymousId="",this.defaultProperties={},this.storage.sessionId=null,this.storage.sessionTimestamp=null,this.setStorage()}identify(e,t={},n=Vu){this.userId=e;const r={type:"identify",userId:e,anonymousId:this.anonymousId,traits:t};return this.enqueue(r,n),this}track(e,t,n){t=Object.assign({},t,this.defaultProperties);const r={type:"track",userId:this.userId,anonymousId:this.anonymousId,event:e,properties:t};return this.enqueue(r,n),this}enqueue(e,t=Vu){if(this.enable&&this.writeKey){if((e=Object.assign({},e)).context=Object.assign({library:{name:"analytics-webextensions",version:"1.2.0"}},this.defaultContext,e.context),e.timestamp||(e.timestamp=new Date),e.messageId||(e.messageId=`node-${Fu()(JSON.stringify(e))}-${ju()}`),e.anonymousId&&!qu()(e.anonymousId)&&(e.anonymousId=JSON.stringify(e.anonymousId)),e.userId&&!qu()(e.userId)&&(e.userId=JSON.stringify(e.userId)),this.storage.sessionId&&(e.integrations={Amplitude:{session_id:this.storage.sessionId}},e.properties&&(e.properties.session_id=this.storage.sessionId)),this.storage.queue.push({message:e,callback:t}),this.setStorage(),!this.flushed)return this.flushed=!0,void this.flush();this.storage.queue.length>=this.flushAt&&this.flush(),this.flushInterval&&!this.timer&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))}else setTimeout(t,0)}flush(){if(!this.enable||!this.writeKey)return Promise.resolve();if(this.timer&&(clearTimeout(this.timer),this.timer=null),!this.storage.queue.length)return Promise.resolve();const e=this.storage.queue.splice(0,this.flushAt),t=e.map((e=>e.callback)),n={batch:e.map((e=>e.message)),timestamp:new Date,sentAt:new Date},r=e=>(t.forEach((t=>"function"==typeof t&&t(e))),n);var i;const s={method:"POST",headers:{Authorization:`Basic ${i=`${this.writeKey}:`,"function"==typeof btoa?btoa(i):Buffer.from(i).toString("base64")}`,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(n)};if(this.timeout&&Number.isFinite(this.timeout)&&this.timeout>0){const e=new AbortController;s.signal=e.signal,setTimeout((()=>e.abort()),this.timeout)}return fetch(`${this.host}/v1/batch`,s).then((()=>r())).catch((e=>{if(e.response){const t=new Error(e.response.statusText);return r(t)}return r(e)})).finally((()=>this.setStorage()))}}class Ju{loggingDisabled=!1;constructor({key:e,host:t}){e&&t&&(this.segmentAnalytics=new zu(e,{host:t,context:{library:{name:"Toolbar"}},properties:{browser:b.browser.name,browser_agent:navigator.userAgent,app_version:de.version,application_type:"Toolbar",application_subtype:"Toolbar",client:"toolbar",tenant:"ebates.com",platform:"Toolbar"}})),b.extension.attachEvent("segment.track",(({data:e})=>this.track(e.event,e.parameters))),b.extension.attachEvent("segment.anonymousId",(()=>this.segmentAnalytics?.anonymousId))}set anonymousId(e){this.segmentAnalytics&&(this.segmentAnalytics.anonymousId=e)}set userId(e){this.segmentAnalytics&&(this.segmentAnalytics.userId=e)}set(e){this.segmentAnalytics?.set(e)}async identify(e,t){if(this.loggingDisabled||!this.segmentAnalytics)return;const n=JSON.stringify({userId:e,...t}),r=await async function(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t),r=Array.from(new Uint8Array(n)).map((e=>e.toString(16).padStart(2,"0"))).join("");return r}(n);r!==await b.extension.getItem("segment-signature")?(b.extension.setItem("segment-signature",r),this.segmentAnalytics.identify(e,t)):this.segmentAnalytics.userId=e}track(e,t,n,r={}){if((!this.loggingDisabled||["Install Application"].includes(e)||r.force)&&this.segmentAnalytics)return["Install Application","Update Application"].includes(e)||this.segmentAnalytics.validateSession(),this.segmentAnalytics.track(e,t,n)}}$i.init({clientToken:le.get("DATADOG_TOKEN"),datacenter:"us",forwardErrorsToLogs:!1,sessionSampleRate:100}),$i.setGlobalContextProperty("service","rr-button"),le.on("change",(e=>$i.setGlobalContextProperty("region",e))),ye("error",(e=>{e.message?.startsWith("Uncaught EvalError")||$i.logger.error(e.message,{colno:e.colno,error:e.error,filename:e.filename,lineno:e.lineno})})),ye("unhandledrejection",(e=>{const t=e.reason;"Network error"!==t.message&&t?.message&&$i.logger.warn(t.message,t)})),b.extension.attachEvent("datadogTrack",(({data:{type:e,name:t,data:n}})=>{$i.logger[e]?.(t,n)}));class Ku{constructor(){b.extension.attachEvent("GrouponDealsCollection",(({data:e})=>this.search(e)))}async search({query:e,location:t,limit:n}){try{if(!e||!t)return null;const r={query:e,limit:n||100,show:"id,dealUrl,announcementTitle,title,options,merchant,grid4ImageUrl",other_deals:!0,locale:"en_US",offset:0,metadata:!1,client_id:"0c9926ce2479a25adec0c9b3c1e6327c73946fe7",tsToken:"US_AFF_0_200014_200067_0",secure_assets:!1,lng:t.lng,lat:t.lat},i=await fetch(`https://api.groupon.com/v2/deals/search?${new URLSearchParams(r)}`),s=await i.json();return this.parse(s)}catch(e){return null}}parse(e){const t=self.EBATES.settings.get("groupon").exclusions||[],n=e.deals.filter((e=>e.title.indexOf("Cash Back")<0));return(0,I.map)(n,(e=>(0,I.extend)({locations:(0,I.flatten)((0,I.map)(e.options,(e=>(0,I.map)(e.redemptionLocations,(e=>t.includes(e.uuid)?null:(0,I.pick)(e,"streetAddress1","city","state","postalCode","phoneNumber"))).filter(Boolean))))},(0,I.pick)(e,"id","dealUrl","announcementTitle","title","grid4ImageUrl","options"),(0,I.pick)(e.merchant,"name","websiteUrl"))))}}const Yu=new Map;function Xu(e){self.EBATES.segment.track("CAA",e)}function Zu(e){const t=Yu.get(e);t&&(clearTimeout(t.timeoutId),Yu.delete(e),b.browser.detachEvent(b.browser.TABCLOSED,Qu))}function Qu({tabId:e}){const t=Yu.get(e);t&&(Xu({coupon_auto_apply_status:"Terminated",...t.event,duration:Date.now()-t.startTime}),Zu(e))}class el{constructor(){b.extension.attachEvent("log.caa",(({data:e,tabId:t})=>{const{action:n,event:r}=e,{coupon_auto_apply_status:i,...s}=r,o=Yu.get(t);if(r.duration_ms=o?.startTime?Date.now()-o.startTime:0,Xu(r),"start"===n){const e=s.available_coupons?s.available_coupons.split(", ").length:0;if(e>0){const n=setTimeout((()=>function({tabId:e}){const t=Yu.get(e);t&&(Xu({coupon_auto_apply_status:"Timeout",...t.event,duration:Date.now()-t.startTime}),Zu(e))}({tabId:t})),30*e*1e3),r=Date.now();Yu.set(t,{event:s,timeoutId:n,startTime:r}),b.browser.attachEvent(b.browser.TABCLOSED,Qu)}}else["success","error","cancel"].includes(n)&&Zu(t)}))}}class tl{injectImmediately=!1;constructor({settings:e,merchant:t,url:n,tabId:r}){this.settings=e,this.merchant=t,this.url=n,this.tabId=r}}class nl extends tl{name=cs;isActive(){return Fs(this.url)}async init(){}getParameters(){return{}}}class rl extends tl{name=os;grouponSettings={};async init(){this.grouponSettings=this.settings.groupon??{},this.grouponViewKey=Object.keys(this.grouponSettings).find((e=>{const t=this.grouponSettings[e];return!!(t.enable&&t.rx&&new RegExp(t.rx).test(this.url))}))}isActive(){return Qi.variation("grouponInjections",!0)&&this.grouponViewKey}getParameters(){return{grouponViewKey:this.grouponViewKey,config:this.grouponSettings[this.grouponViewKey]}}}class il extends tl{name=as;async init(){return!0}isActive(){return Qi.variation("businessCard",!0)&&!!Os&&new RegExp(Os).test(this.url)}getParameters(){return{}}}class sl extends tl{name=us;config=null;async init(){const e=this.settings.iscb;if(e)for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const n=e[t];if(new RegExp(n.url).test(this.url))return n.category||(n.category=`ISCB ${t.replace(/-/g," ")}`,n.entity_name=t.replace(/-/g," ")),void(this.config=n)}}isActive(){return Qi.variation("iscb",!0)&&!!this.config}getParameters(){return{config:this.config}}}class ol extends tl{name=ss;async init(){this.merchant?.caaProgress&&(this.injectImmediately=!0)}isActive(){return!!this.merchant}getParameters(){return{merchant:this.merchant}}}class al extends tl{abandonedReminderActive=!1;name=ls;async init(){if(!Qi.variation("pmEnabled",!0))return;const e=new URL(this.url).host;if(!(this.merchant&&(this.merchant.offers_cb||2===this.merchant.activationCode&&this.merchant.notificationHover||this.merchant.pmDisabled||this.merchant.suppressed&&this.merchant.competitor&&this.settings.standDownDomains?.includes(this.merchant.competitor)))){const t=this.settings.priceMagic,n=await self.EBATES.settings.priceMagic.domains.load();t.excludedDomains.find((t=>e.search(t)>=0))||(this.config=n.find((({domainName:t})=>e.search(t)>=0))),Qi.variation("cartAbandonmentToast",!1)&&self.EBATES.settings.userSettings.get("abandonedProductsReminder")&&await self.EBATES.member.abandonedProducts.reminder.isEligibleDomain(e)&&(this.abandonedReminderActive=!0)}}isActive(){return!!this.config||this.abandonedReminderActive}getParameters(){return{config:this.config,abandonedReminderActive:this.abandonedReminderActive}}}class cl extends tl{name=ds;async init(){this.config=self.EBATES.settings.interstitialConfig.get(this.url)}isActive(){return!!this.config}getParameters(){return{config:this.config}}}const ul=new class extends Zi{_id="products";DEFAULT_UPDATE_INTERVAL=864e5;get url(){return ge(k.SETTINGS_PRODUCTS)}getConfigs(){return Rc(this.load(),[])}parse(e){return e?.stores??[]}};class ll extends tl{name=hs;async init(){if(!Qi.variation("productPageTracker",!0))return;const e=await ul.getConfigs();this.config=e.find((e=>e.url&&new RegExp(e.url).test(this.url)))}isActive(){return!!this.config}getParameters(){return{merchant:this.merchant,config:this.config}}}const dl=new class extends Zi{_id="serp";DEFAULT_UPDATE_INTERVAL=216e5;get url(){return ge(k.SETTINGS_SERP)}parse(e){return e?.serp}};class hl extends tl{name=fs;async init(){const e=Qi.variation("customSerp",!1)?await dl.load():this.settings.serp,t=new URL(this.url).host;this.config=e.find((({domain:e})=>t.includes(e)))}isActive(){return Qi.variation("serp",!0)&&!!this.config}getParameters(){return{config:this.config}}}class fl extends tl{name=gs;getPromo(e){const t=this.settings;if(t.promos){const n=(0,I.findWhere)(t.promos,{id:e,active:!0});if(n)return n}}async init(){this.promo=this.getPromo("taxes")}isActive(){return this.promo?.urls?.find((e=>this.url.search(e)>=0))}getParameters(){return{taxes_promo:this.promo}}}class gl extends tl{name=ps;timestamp=null;isActive(){return Fs(this.url)&&self.EBATES.settings.installedExtensions&&(!this.timestamp||this.timestamp+864e5<=Date.now())}async init(){this.timestamp=await b.extension.getItem("installed_extensions_check")}getParameters(){return{extensions:self.EBATES.settings.installedExtensions.extensions}}}class pl extends tl{name=ms;caaConfigs=[];async init(){this.caaConfigs=await Lc.match({url:this.url,storeId:this.merchant?.storeId})}isActive(){return this.caaConfigs.length>0}getParameters(){return{caaConfigs:this.caaConfigs,merchant:this.merchant}}}class ml extends tl{name=vs;async init(){const e=Qi.variation("similarStores",!1),t=(n=this.url,new URL(n).hostname.replace(/^www\./,""));var n;if(!t||!e)return;if(await Uc.hasStoreExclusion(t))return;if(!await xo.variation("BTN200"))return;if(e.includedDomains.includes(t)&&!this.merchant?.offers_cb&&(2!==this.merchant?.activationCode||!this.merchant.notificationHover)&&(!this.merchant?.recommendedStoresPromo||!this.merchant.notificationHover)){const e=await Uc.fetch(t);e?.stores&&e.stores.length>0&&(this.config=e)}}isActive(){return!!this.config}getParameters(){return{config:this.config}}}class vl extends tl{name=ys;active=!1;async init(){const e=EBATES.settings.userSettings.get("tcppDisplayed"),t=self.EBATES.member.isTcppBlocking();this.active=this.merchant&&t&&(!e||Date.now()-e>864e5)}isActive(){return this.active}getParameters(){return{active:this.active}}}class yl extends tl{name=bs;active=!1;async init(){if(this.merchant?.offers_cb)return;const e=Qi.get("promoNotification",{enable:!1});if(!e||!e.enable)return;if(this.testKey=await this.checkExperiments(),!this.testKey)return;const t=new URL(this.url).origin,n=await Rc(lu.load(),[]);if(!await this.isEligibleDomain(n,t))return;const r=EBATES.feed.timelines.get(Ss);if(!r)return;const i=await r.getActiveDomains(),s=await r.getVisitedDomains();this.domainIds=(0,I.without)(i,...s)}isActive(){return!!this.domainIds?.length}getParameters(){return{domainIds:this.domainIds,testKey:this.testKey}}async isEligibleDomain(e,t){return e.some((e=>t.includes(e)))}async checkExperiments(){const e=Qi.variation("activeButtonMilestones",{ids:[]}).ids??[];for(const t of e){if(await xo.variation(`button-milestone-${t}`))return`button-milestone-${t}`}const t=Qi.get("promoNotificationTestValue",Ms);if(await xo.get(t))return t}}class bl extends(M()){scriptsExecutionStatus=new Map;constructor({settings:t,merchant:n,url:r,tabId:i,abortController:s}){super(),this.settings=t,this.merchant=n,this.url=r,this.tabId=i,this.contentFeatures=Object.values(e).map((e=>new e(this))),this.abortController=s}get isBlacklisted(){return Array.isArray(this.settings.contentBlackList)&&this.settings.contentBlackList.some((e=>{const t=e&&new RegExp(e);return t&&t.test(this.url)}))}async injectContentScripts(e=!1){return!this.isBlacklisted&&!this.abortController.signal.aborted&&(await Ks.executeScript({tabId:this.tabId,files:["./js/commons.js","./js/content.js"],signal:this.abortController.signal,injectImmediately:e}),!0)}async process(){if(self.EBATES.member.isTcppBlocking()){const e=this.contentFeatures.find((({name:e})=>e===ys));return e?.init(),void(e?.isActive()&&(await this.injectContentScripts(),await this.execute({settings:this.settings,features:{[ys]:!0}})))}await Promise.allSettled(this.contentFeatures.map((e=>e.init())));const e=this.contentFeatures.filter((e=>e.isActive()));if(e.length){const t=e.some((e=>e.injectImmediately));if(!await this.injectContentScripts(t)||this.abortController.signal.aborted)return;const n={};for(const t of e)n[t.name]=t.getParameters();await this.execute({settings:this.settings,features:n})}}async execute(e){await b.extension.fireEvent("execute",{tabId:this.tabId,data:e})}}class wl{page=null;abortControllers=new Map;initAbortController(e){const t=new AbortController;return this.abortControllers.set(e,t),t}deleteAbortController(e){this.abortControllers.delete(e)}abortProcess(e){const t=this.abortControllers.get(e);t?.abort(),this.deleteAbortController(e)}invalidateMerchants=(0,I.throttle)((async function(){if(Qi.variation("feedGenMerchants",!0))try{await self.EBATES.merchants.fetch()}catch(e){}}),1e3);async processPage({url:e,tabId:t}){if(self.EBATES.member.isExtensionDisabled()&&!self.EBATES.member.isTcppBlocking()||!we(e))return;const n=self.EBATES.settings.toJSON();"A"!==await xo.get(Rs)&&(n.rabExcludedStores=[]),this.abortControllers.has(t)&&this.abortProcess(t);const r=this.initAbortController(t);await this.invalidateMerchants();const i=await self.EBATES.merchants.getMerchant({url:e,tabId:t});this.page=new bl({settings:n,url:e,tabId:t,merchant:i,abortController:r}),await this.page.process(),this.deleteAbortController(t)}}const Al=2592e6;function xl(e,t){return!!t&&(!e||(t.storesIn&&t.storesIn.includes(e)||!t.storesIn?.length&&t.storesNotIn&&!t.storesNotIn.includes(e)))}const El=9e5;class Sl extends Zi{constructor({slugName:e,fieldSet:t="events",duration:n}){super(),this._id=e,this.fieldSet=t,n?this.duration=n:(this.duration=El,self.EbatesPromise.then((()=>{this.duration=Qi.variation("feedTimelineUpdateInterval",El),Qi.on("change:feedTimelineUpdateInterval",(e=>{this.duration=e}))})))}get url(){return Hi(`${le.get("feed_api")}/feedapi/v3/timeline`,{slugName:this._id,duration:Math.floor(this.duration/1e3),fieldSet:this.fieldSet})}get headers(){const e=self.EBATES?.feed?.previewToken;return{Authorization:`ebtoken ${self.EBATES?.ebToken}`,"Client-Agent":ws[rs.DEFAULT].toLowerCase(),"X-Platform":ws[rs.DEFAULT],"X-Anonymous-ID":self.EBATES?.toolbarId?.toString()??"","X-Web-Host":"",...e&&{"X-Preview-Token":e}}}set duration(e){Number.isFinite(e)&&e>1e3&&(this.UPDATE_INTERVAL=e)}get duration(){return this.UPDATE_INTERVAL}isDomainActive(e,t){const{events:n}=this.getData(),r=Math.floor(Date.now()/1e3),i=n.filter((({event:n})=>n.domainId===e&&xl(t,n))).sort(((e,t)=>e.timestamp-t.timestamp));return i.reduce(((e,{event:t,timestamp:n})=>(n<=r&&(["running","start"].includes(t.action)?e=!0:"expire"===t.action&&(e=!1)),e)),!1)}async getUniqueDomainIds(e){const{events:t}=await this.load();return[...new Set(t.filter((({event:t})=>xl(e,t))).map((({event:e})=>e.domainId)))]}async getActiveDomains(e){try{return(await this.getUniqueDomainIds(e)).filter((t=>this.isDomainActive(t,e)))}catch{return[]}}async hasActiveDomains(e){try{return(await this.getUniqueDomainIds(e)).some((t=>this.isDomainActive(t,e)))}catch{return!1}}async visitDomains(e){const t=Date.now(),n=await qi.get(`${this._id}/visited`)??{},r=new Map(Object.entries(n));e.forEach((e=>r.set(e,t))),r.forEach(((e,n)=>{e+this.duration<t&&r.delete(n)}));const i=Object.fromEntries(r);return qi.set(`${this._id}/visited`,i)}async getVisitedDomains(e=0){const t=await qi.get(`${this._id}/visited`)??{},n=Date.now(),r=[],i=e>0?Math.min(Al,e):Al;return Object.entries(t).forEach((([e,t])=>{t+i<n?delete r[e]:r.push(e)})),qi.set(`${this._id}/visited`,t),r}parse(e){return e.data?.viewer?.timeline}}const Tl={url:"https://preview-www.rakuten.com/",domain:"preview-www.rakuten.com",name:"previewToken"};class _l{#e="button/feed/badge";timelines=new Map;constructor(e){this.timelines=e,b.extension.attachEvent("feedBadge:visitDomains",(async()=>{const{url:e,tabId:n}=await Ks.getActive(),r=await this.getActiveDomains(e,n),i=await qi.get(this.#e)||[];await qi.set(this.#e,r.concat(i).splice(0,1e3)),t({url:e,tabId:n})}));const t=async({url:e,tabId:t})=>{if(self.EBATES){if(!self.EBATES.member.isExtensionDisabled()&&self.EBATES.feed.enabled){const n=await this.getActiveDomains(e,t);if(n.length){const e=await qi.get(this.#e)||[],t=(0,I.without)(n,...e);return void self.EBATES.badge.update("feed",t.length)}}self.EBATES.badge.update("feed",0)}};b.browser.attachEvent(b.browser.DOCUMENTCOMPLETE,t),b.browser.attachEvent(b.browser.TABCHANGED,t)}async getActiveDomains(e,t){const n=self.EBATES.merchants.match(e,t);return(n?.isActiveButtonMerchant()&&"X"!==await(n?.incrementalityTest())?await(this.timelines.get(xs)?.getActiveDomains(n.id.toString())):await(this.timelines.get(Es)?.getActiveDomains()))??[]}reset(){qi.delete(this.#e)}}class kl extends Zi{UPDATE_INTERVAL=216e5;get url(){return Hi(`${le.get("feed_api")}/feedapi/v1/feed`,{slugName:this._id})}get enabled(){return Qi.variation("feed",!0)}get headers(){return{Authorization:`ebtoken ${self.EBATES?.ebToken}`,"Client-Agent":ws[rs.DEFAULT].toLowerCase(),"X-Platform":ws[rs.DEFAULT],"X-Anonymous-ID":self.EBATES?.toolbarId.toString()}}}class Cl extends kl{_id=Ts;constructor(){super(),b.extension.attachEvent("feed:serp-ad-fetch",(async()=>{if(!this.enabled)return null;try{return await this.load()}catch{}return null}))}parse(e){const t=e?.data?.viewer?.feed,n=t?.topics?.edges?.[0].node?.items?.edges;return n.length?this.getActiveSerpBanners(n):null}getActiveSerpBanners(e){if(!e)return null;const t=[];for(const n of e){const e=n.node?.itemData;if("serp-banner"===e?.type_text&&"true"===e?.active_text){const e=this.formatNode(n.node);e&&t.push(e)}}return t}formatNode({itemData:e,payloads:t}){const n=e.keywords_text.split(",").map((e=>e.trim())),r=t[0]?.payload;let i={"insert-before":".g:first"};try{i=JSON.parse(e.insertconfig_text)}catch{}return{id:e.id,type:e.type_text,browser:e.browser_text,flagId:e.flagId_text,flagValue:e.flagvalue_text,config:{keywords:n,insertConfig:i,storeId:r.store_id,logo:e.logo_imageurl,title:e.title_text,description:e.description_text,image:e.media_imageurl,xfasParams:e.xfasparams_text,ctaUrl:e.ctaurl_text,ctaText:e.ctatext_text}}}}class Il extends kl{_id=_s;async loadData(){if(!this.enabled)return null;try{return await this.load()}catch{}return null}parse(e){const t=e?.data?.viewer?.feed,n=t?.topics?.edges?.[0].node?.items?.edges,r=[];for(const e of n){const t=this.formatNode(e.node);t&&r.push(t)}return r}formatNode({itemData:e}){let t=[],n=[];try{t=e.domains_text.split(",").map((e=>e.trim())),n=e.similarstoreids_text.split(",").map((e=>parseInt(e.trim(),10)))}catch{return null}return{domains:t,similarStores:n,eyebrow:e.eyebrow_text,headline:e.headline_text,additionalText:e.additionalstores_text}}}class Pl{previewToken=null;timelines=new Map([[Es,new Sl({slugName:Es})],[xs,new Sl({slugName:xs})],[Ss,new Sl({slugName:Ss,duration:36e5})]]);constructor(){this.feedBadge=new _l(this.timelines),this.serpFeed=new Cl,this.similarStoresFeed=new Il,b.extension.attachEvent("feed:fetch",(async({data:e})=>{if(!this.enabled)return null;return await this.fetch(e)})),b.extension.attachEvent("feed:exitPreviewMode",(async()=>{await n().cookies.remove({url:Tl.url,name:Tl.name}),b.extension.fireEvent("feed:closePreviewMode",{tabId:b.browser.ALLTABS})})),b.extension.attachEvent("timeline:visitDomains",(async({data:{timeline:e,domainIds:t}})=>{this.timelines.get(e)?.visitDomains(t)})),n().cookies.onChanged.addListener((({cookie:e,removed:t})=>{e.domain===Tl.domain&&e.name===Tl.name&&(this.previewToken=t?null:e.value)})),this.getPreviewToken().then((e=>this.previewToken=e))}get enabled(){return Qi.variation("feed",!0)}async getPreviewToken(){const e=await n().cookies.get({url:Tl.url,name:Tl.name});return e?.value||null}parse(e){const t=e?.data?.viewer?.feed;return t?.topics?.edges?.length>0?{pages:[t],pageParams:[null]}:null}async fetch({slugName:e,timelineSlugName:t,storeId:n}){const r=self.EBATES.settings.featureFlags,i=r.variation("feedPreview",!0);if((i&&!this.previewToken||!i)&&t&&r.variation("feed",!0)&&r.variation("feedTimeline",!0)){this.timelines.has(t)||this.timelines.set(t,new Sl({slugName:t}));if(!await(this.timelines.get(t)?.hasActiveDomains(n?.toString())))return null}const s=await zi(`${le.get("feed_api")}/feedapi/v1/feed`,{data:{slugName:e,size:"",cursor:""},headers:{Authorization:`ebtoken ${self.EBATES?.ebToken}`,"Client-Agent":ws[rs.DEFAULT].toLowerCase(),"X-Platform":ws[rs.DEFAULT],"X-Anonymous-ID":self.EBATES?.toolbarId,"X-Web-Host":"",...this.previewToken&&{"X-Preview-Token":this.previewToken}}});return this.parse(s)}}var Ml=i(21812),Dl=i(80614);const Rl="holistic.installation_id";class Ll{loggingDisabled=!1;constructor({region:e}){b.extension.attachEvent("holistic.track",(({url:e,data:{event:t,data:n,...r}})=>{this.track({event:t,url:e,data:n,...r})})),this.messagingSDK=new Dl.MessagingSDK;const t=this.getPlatform();b.extension.getItem(Rl).then((e=>{e||(e=_(),b.extension.setItem(Rl,e)),this.installation_id=e})),this.messagingSDK.init({hostApp:{name:`rr-button-${t}`,version:de.version,type:Dl.AppType.Extension},networkConfig:{USA:{messageGatewayBaseURL:le.get("rakuten_api","USA"),batchSize:10,lingerDuration:1e4},GBR:{messageGatewayBaseURL:le.get("rakuten_api","GBR"),batchSize:10,lingerDuration:1e4}},regionId:e,invalidMessagesHandler:(e=[])=>{0}})}async track({event:e,url:t,data:n,clientContext:r}){if(this.loggingDisabled&&![es.ApplicationInstalled].includes(e))return;if(!Qi.variation("holistic"))return;const i=this.getPage(t??(await Ks.getActive()).url);return this.messagingSDK.send({type:ts[e].type,schema_id:ts[e].schema_id,visit_id:self.EBATES.visitId,installation_id:this.installation_id,data:n,page:i,clientContext:r})}getPlatform(){return b.browser.isFirefox?"firefox":b.browser.isEdge?"edge":b.browser.isSafariMobile?"safari-mobile":b.browser.isSafari?"safari":"chrome"}getPage(e){if(e.length)try{const{host:t,pathname:n,searchParams:r}=new URL((0,Ml.J)(e));return{host:t,path:n,url:`${t}${n}`,type:"extension",query_params:Object.fromEntries(r)}}catch{return}}setMember(e){this.messagingSDK.setMember(e)}}function Ol(){const e={};async function t(e){const t=await async function(e){return(0,(await i.e(404).then(i.bind(i,3075))).gzip)(e)}(JSON.stringify(e));return zi(ge(k.CAPTURE_ORDER),{method:"POST",headers:{"Content-Type":"application/json","Content-Encoding":"gzip"},body:t})}b.extension.attachEvent("CaptureOrderPage",(({url:n,tabId:r,data:i})=>{if(e[r]&&e[r]===n)return;const s=self.EBATES.member.isExtensionDisabled(),{logging:o}=self.EBATES.settings.toJSON(),a=Qi.variation("commerceCapture",!0);if("opt_out"===o||"pending"===o||s||!a)return;e[r]=n;const{storeName:c,storeId:u,shoppingTrip:l,isCaaWithoutActivation:d}=i.merchant;(l?.ttn||self.EBATES.settings.promos.get("commercecapture-incrementality")?.campaigns?.find((({stores:e})=>e.get(u)))||d)&&t({tenant_id:le.get("CC_TENANT_ID"),source_name:"toolbar",store_name:c,store_id:u,shopping_trip_id:l.ttn,rr_member_id:self.EBATES.member.id,content_source:n,content_type:"order confirmation",content_format:"html",client_type:b.browser.name.toLowerCase(),client_version:de.version,content:i.content,load_time:i.load_time,javascript_error:i.javascript_error})}));const n=({url:t,tabId:n})=>{e[n]&&t!==e[n]&&delete e[n]};b.browser.attachEvent(b.browser.DOCUMENTCOMPLETE,n),b.browser.attachEvent(b.browser.TABCLOSED,n)}function Bl(){const e=new Map,t=`//${le.get("domain").replace(/\./g,"\\.")}/.*?(\\d+)-xfas(?:\\?.*sourceName=[\\w-]*)?`,r=new RegExp(t),i=t=>{e.has(t)&&(e.get(t).timeout&&self.clearTimeout(e.get(t).timeout),e.delete(t))};function s({tab:e,reason:t}){if(!e)return;const n=e.storeId,r=self.EBATES.merchants.get(n),i=r?.session.shoppingTrip.getCurrentState(),s={store_id:n,redirect_chain:e.urls.toString(),reason:t,...i?{activation_type:i.type,attribution_source_previous_click:i.source,tracking_ticket:i.ttn}:{}};self.EBATES.segment.track("Interstitial Failure",s),$i.logger.warn("InterstitialStatus",s),self.EBATES.settings.affiliates.clear(e.tabId)}function o(t,n){s({tab:e.get(t),reason:n}),i(t)}b.browser.attachEvent(b.browser.TABCLOSED,(({tabId:e})=>{o(e,"closed tab")}));b.browser.attachEvent(b.browser.NAVIGATIONCOMMITTED,(({tabId:t,url:n})=>{const o=(e=>{const t=r.exec(e);if(t&&t[1]&&self.EBATES){const n=self.EBATES.merchants.get(parseInt(t[1],10));if(n)return{storeId:n.id,location_flag:n.session.shoppingTrip.get("source")||t[2]||"",urls:[e]}}return null})(n);if(o){const n=self.setTimeout((()=>{s({tab:e.get(t),reason:"timed out"})}),3e4);e.set(t,{...o,tabId:t,timeout:n})}else if(e.has(t)){const r=self.EBATES.merchants.match(n,t);if(r&&r.id===e.get(t).storeId)i(t);else{e.get(t).urls.push(n)}}})),n().webNavigation.onCommitted.addListener((e=>{const{tabId:t,transitionType:n,transitionQualifiers:r}=e;"reload"===n?o(t,"reload tab"):r?.includes("forward_back")&&o(t,"forward_back")}))}const Nl="np-domains-last-visit";let jl,Ul;async function Fl(e){const t=await Rc(async function(e){return new URL(e).host.replace(/^www\./,"")}(e),null);if(t&&b.browser.isChrome&&Qi.get("trackNP")&&self.EBATES){if(!Ul){const e=(await i.e(814).then(i.t.bind(i,67814,23))).default||[];Ul=new Set(e.map((([e])=>e)))}if(t&&Ul.has(t)){if(jl||(jl=await qi.get(Nl)||new Map),jl.forEach(((e,t)=>{e+18e5<Date.now()&&jl.delete(t)})),!jl.has(t)){self.EBATES.segment.track("Visit NP Page",{host:t});const e=`https://${t}`;self.EBATES.holistic.track({event:es.WebsiteVisited,data:{website_visit_id:_()},url:e})}jl.set(t,Date.now()),qi.set(Nl,jl)}}}class $l extends P.EventEmitter{session_competition=null;experiments=xo;constructor({ebToken:e,toolbarId:t,visitId:r,anonymousId:i,region:s}){let o;if(super(),this.ebToken=e,this.toolbarId=t,this.visitId=r,this.anonymousId=i,this.region=s,this.experiments.setMember({memberGuid:null,anonymousId:this.toolbarId.toString()}),this.segment=new Ju({key:le.get("SEGMENT_KEY"),host:le.get("SEGMENT_HOST")}),this.segment.anonymousId=this.anonymousId,this.segment.set({toolbarid:this.toolbarId}),this.holistic=new Ll({region:s}),this.holistic.setMember({anonymous_id:this.anonymousId}),this.contentRunner=new wl,Bl(),Ol(),this.badge=new Bs,this.merchants=new ya,e){const t=pe(e);o=t?.mId}this.member=new Mu({id:o}),this.settings=new Hc,this.icon=new Zc,this.grouponDealsCollection=new Ku,this.logCoupons=new el,this.feed=new Pl,this.on("change:ebToken",((e,t)=>{t||this.setPopup()})),b.extension.attachEvent("acceptedTcpp",(()=>{b.extension.fireEvent("hideTcpp",{tabId:b.browser.ALLTABS})})),b.extension.attachEvent("openOptionsPage",(()=>{b.ui.settings.open()})),n().alarms.onAlarm.addListener((e=>{"Ping"===e.name&&self.EBATES.ping()})),n().alarms.get("Ping").then((e=>{e||n().alarms.create("Ping",{periodInMinutes:60})})),b.browser.attachEvent(b.browser.DOCUMENTCOMPLETE,(({url:e})=>this.handleDocumentComplete(e))),b.browser.attachEvent(b.browser.NAVIGATIONCOMMITTED,(e=>{this.merchants.processDocumentComplete(e),this.contentRunner.processPage(e)})),b.extension.attachEvent("xfas",(e=>this.handleXfas(e)))}get ebToken(){return this._ebToken}set ebToken(e){if(this._ebToken!==e){const t=this._ebToken;this._ebToken=e,this.emit("change:ebToken",e,t),b.extension.setItem("ebToken",e)}}get loggedIn(){return!!this.ebToken}async init(){await this.validateUserToken(),this.setPopup();try{await this.settings.load(),await this.settings.fetch()}catch(e){}this.merchants.rates.init(),this.merchants.fetch().then((()=>{b.extension.fireEvent("merchant.state:change")})).catch((()=>{})),this.settings.userSettings.toggleLogging(),this.setUninstallURL()}async validateUserToken(){const e=await ce(le.get("domain"),"euid");return await this.verifyToken(e),this.ebToken}setPopup(){this.ebToken?this.member.isGatingStatusBlocked()||(b.ui.button.detachEvent(b.ui.button.CLICK,this.buttonOnClicked),b.ui.button.setPopup({url:"./popup.html"})):(b.ui.button.setPopup(),b.ui.button.detachEvent(b.ui.button.CLICK,this.buttonOnClicked),b.ui.button.attachEvent(b.ui.button.CLICK,this.buttonOnClicked))}buttonOnClicked(e){self.EBATES.login(e)}setDomain(e){const t="^([a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,}$",n="^https?:\\/\\/([a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,}$";for(const[r,i]of Object.entries(e))if("domain"===r){if(!new RegExp(t).test(i))throw new Error(`Invalid url for property ${r}. Does not match with RegExp "${t}"`)}else{if(!new RegExp(n).test(i))throw new Error(`Invalid url for property ${r}. Does not match with RegExp "${n}"`)}for(const[t,n]of Object.entries(e))b.extension.setItem(t,n),k[t]&&(k[t]=n);this.settings.affiliates.activationRegexs()}async handleXfas(e){let{shoppingURL:t,storeURL:n,wid:r,sessionAttributes:i,campaignId:s,tabId:o,eeid:a,channel:c}=e.data;const u=Wi(t,{response:"json",store_url:n,sourceName:r||is,tracking_campaign_id:s,channel:c||rs.DEFAULT,eeid:a||23509,tb_v:b.extension.version,ebtoken:this.ebToken??"",visit_id:this.visitId});if(o===b.browser.NEWTAB){o=(await b.browser.navigate({url:"about:blank",tabId:b.browser.NEWTAB})).id}else o=e.tabId;this.settings.affiliates.match(u,o);const l=await fetch(u),d=(await l.json()).ticket[0];if(d?.storeId){const e=d.trackingNumber;this.settings.affiliates.activations.addParameters(o,{trackingTicketNumber:e});this.merchants.get(d.storeId).session.shoppingTrip.addPendingAttributes({type:"silent",...i}),await b.browser.navigate({tabId:o,url:d.link[0]["@href"].replace(/wid=.*?&/,`wid=${r}&`)})}}async handleDocumentComplete(e){if(!e)return;const t=we(e)??"",n=ge(k.BASE);e.startsWith(n)&&await this.validateUserToken(),this.settings.get("competitorDomains").includes(t)&&t!==this.session_competition?.domain&&(this.session_competition={url:e,domain:t},this.segment.track("Visit Competitor Page",{url:e,domain:t})),Fl(e)}async ping(){const e=await b.extension.getItem("ga_usage"),t=new Date(parseInt(e||0,10)),r=new Date;r.toDateString()!==t.toDateString()&&(b.extension.setItem("ga_usage",r.getTime().toString()),async function(){const e=self.EBATES,{isOnToolbar:t}=await(n().action?.getUserSettings())??{},r=await n().permissions.contains({permissions:["notifications"]})?"yes":"no",{installDate:i,installationSource:s,installSessionId:o}=await b.extension.getItem(["installDate","installationSource","installSessionId"]),a=await b.extension.getItem("browser_info"),c=a?{dark_mode:a.darkMode,screen_size:a.screenSize,browser_size:a.browserSize}:null;e.segment.track("Heartbeat Application",{anon_id:e.anonymousId,browser_info:{...a,pinned:t,desktop_notification_optin:r},install_info:{source:s,install_desktop_session_id:o},member_info:{isAmexUser:e.member.get("isAmexUser")}}),e.holistic.track({event:es.ApplicationDetected,data:{pinned:t,application_subtype:"Toolbar",desktop_notification_optin:r,application_installed_at_millis:i,installation_source:s,installation_session_id:o,toolbar_id:e.toolbarId,browser_info:c}})}())}onTokenExpired(){this.member.unset("accessLevel")}async verifyToken(e){const t=pe(e);if(!e||!t)return;const n=pe(this.ebToken);if((t.mId!==n?.mId||t.llt!==n?.llt)&&(!n?.llt||!n.mId||t.llt||t.mId!==n.mId)&&(this.ebToken=e,this.member.clearCache(),this.member.set("accessLevel",1,{silent:!0}),this.member.saveCache(),t.mId!==n?.mId)){$i.logger.info("login",t);try{await this.member.fetch({reset:!0})}catch(e){}}}setUninstallURL(){new Promise(((e,t)=>{n().management?.getSelf?n().management.getSelf().then((n=>{"normal"===n.installType?e():t()})):e()})).then((()=>{if(n().runtime.setUninstallURL){const e=EBATES.settings.installedExtensions?.getInstalledExtensions().toString(),t=Hi(ge(k.WEB_UNINSTALL),{ext:e});n().runtime.setUninstallURL(t)}})).catch((()=>{}))}set(e,t){b.extension.setItem(e,t)}login({data:e={},name:t}){let n=b.browser.NEWTAB,r="";const i="getLogonForm"===e.name,s="GBR"===le.region,o=e.merchant?.storeId,a="Login"===e.type;i||s?(r=ge(k.WEB_LOGON_FORM),s&&o&&a&&(r=Wi(e.merchant.shoppingURL,{tb:"yes",sourceName:is,eeid:23509,visit_id:this.visitId}),n=e.tabId??b.browser.CURRENTTAB)):(r=ge(k.WEB_LOGIN),o&&(r+=`&merchant_id=${e.merchant.storeId}`,n=e.tabId??b.browser.CURRENTTAB)),this.segment.track("Visit Page",{preceding_screen_name:e.preceding_screen_name||"ButtonClick"===t?"Icon":"Hover",url:r,type:e.type}),e.source&&(r+=`&special=${e.source}`),b.browser.navigate({url:r,tabId:n})}}self.EbatesPromise=async function(){const e=await b.extension.getItem(["domain","api","member_api","staticCDN","productCDN"]);for(const[t,n]of Object.entries(e))b.extension.setItem(t,n),k[t]&&(k[t]=n);const t=await b.extension.getItem(["toolbarId","installVersion","installDate","currentVersion","uiid","visitId","region","ebToken"]);let{uiid:r,region:i,ebToken:s}=t;r||(r=_(),b.extension.setItem("uiid",r));let o,a,c=0;const u=t.visitId??(()=>{const e=_();return b.extension.setItem("visitId",e),e})();let l=!1,d=!1;t.toolbarId?(t.currentVersion!==b.extension.version&&(b.extension.setItem("currentVersion",b.extension.version),d=!0,i||(i=await le.migrateRegionStorage())),c=t.toolbarId,o=t.installVersion||"4.0.0.0",a=t.installDate):(l=!0,i||(i=await le.detectRegion()),c=Math.floor(1e9*Math.random()),o=b.extension.version,a=Date.now(),b.extension.setItem("toolbarId",c),b.extension.setItem("installDate",a),b.extension.setItem("installVersion",o),b.extension.setItem("currentVersion",o),b.extension.setItem("notification-explanation",0)),le.setRegion(i),Qi.init(),self.EBATES=new $l({ebToken:s,toolbarId:c,visitId:u,anonymousId:r,region:i}),await self.EBATES.init(),a&&self.EBATES.segment.set({app_install_ts:a}),d&&self.EBATES.segment.track("Update Application"),$i.setGlobalContextProperty("button",{toolbarId:c,version:b.extension.version,installVersion:o});const h=le.get("domain");return n().cookies.set({domain:h,url:ge(k.BASE),name:"toolbarId",value:c.toString()}),n().cookies.set({domain:h,url:ge(k.BASE),name:"toolbarRegion",value:i}),l&&(await ns(),self.EBATES.ping()),self.EBATES}(),b.extension.attachEvent("login",(e=>self.EBATES.login(e))),b.extension.attachEvent("encodeImageURI",(async function({data:e,url:t}){const n=Qi.variation("encodeImageDomains")?.domains,r=we(t)||"";if(n&&n.includes(r)){const t=e=>fetch(e).then((e=>e.blob())).then((e=>new Promise(((t,n)=>{const r=new FileReader;r.onloadend=()=>t(r.result),r.onerror=n,r.readAsDataURL(e)}))));try{const n=await t(e);return 0!==n.indexOf("data:text/plain;base64")?n:null}catch{return null}}return e})),b.extension.attachEvent("getProductCatalogDetails",(async function({data:e}){const{merchant:t,detail:n}=e;return async function({merchant:e,detail:t}){const n=ge(k.PRODUCT_METADATA,{storeId:e.storeId}),r=[];for(const e of["sku","model","mpn","productID"])t[e]?.[0]&&r.push(t[e]?.[0]);let i;try{i=await zi(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({store_id:String(e.storeId),product_ids:r,product_url:t.url[0]||t.canonical[0]})})}catch{}const s=i?.data?.[0];return s?function({listing_id:e,brand_name:t,category_id:n,category_ids:r,category_name:i,category_name_path:s,image_url:o,is_refurbished:a,list_price:c,sale_price:u,product_url:l,store_id:d,store_name:h,group_id:f,shipping_cost:g,...p}){return{listingId:e,brandName:t,categoryId:n,categoryIds:r,categoryName:i,categoryNamePath:s,imageUrl:`https://product-image.ebates.com${o}`,isRefurbished:a,listPrice:c,salePrice:u,productUrl:l,storeId:d,storeName:h,groupId:f,shippingCost:g,...p}}(s):null}({merchant:t,detail:n})}));const ql=new Map;b.extension.attachEvent("getContent",(async({data:e})=>{const{file:t}=e;if(ql.has(t))return ql.get(t);{const e=await fetch(t);let r=await e.text();return r=r.replace(/chrome-extension:\/\/__MSG_%40@extension_id__\//g,n().runtime.getURL("")),ql.set(t,r),r}})),b.extension.attachEvent("getSessionID",(async()=>{try{return await ce(le.get("domain"),"JSESSIONID")}catch(e){return""}})),b.extension.attachEvent("getMerchantSession",(async({data:e})=>{const t=await self.EbatesPromise;await t.merchants.ready();const n=t.merchants.get(e.storeId);if(n){const e=n.session.toJSON(),t=n.getReward();return{...e,...n.processCode(t),reward:t}}return{}})),b.extension.attachEvent("matchDomain",(async({data:{url:e}})=>{const t=await self.EbatesPromise;await t.merchants.ready();const n=await Ks.getActive(),r=t.merchants.match(e,n.tabId);return r?{storeId:r.id}:null})),b.extension.attachEvent("ISC",(async({data:e})=>{const t=await self.EbatesPromise;return await t.member.iscb.getOffers(e)}))})(),source={}})();